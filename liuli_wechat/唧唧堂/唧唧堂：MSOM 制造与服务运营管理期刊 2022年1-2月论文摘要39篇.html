<!DOCTYPE html>
<html class="
">
  <head>
            <meta name="wechat-enable-text-zoom-em" content="true">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<link rel="shortcut icon" type="image/x-icon" href="//res.wx.qq.com/a/wx_fed/assets/res/NTI4MWU5.ico" reportloaderror>
<link rel="mask-icon" href="//res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg" color="#4C4C4C" reportloaderror>
<link rel="apple-touch-icon-precomposed" href="//res.wx.qq.com/a/wx_fed/assets/res/OTE0YTAw.png" reportloaderror>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<script  nonce="1738606354" reportloaderror>try{document.getElementsByTagName('html').item(0).style.webkitTextSizeAdjust=JSON.parse(window.__wxWebEnv.getEnv()).fontScale+'%'}catch(e){}</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
  window.logs = { pagetime: {} };
  window.logs.pagetime['html_begin'] = (+new Date());
  window.LANG = "zh_CN"; // 页面语言 zh_CN en_US
</script>

    <script type="text/javascript" nonce="1738606354" reportloaderror>
/**
 * 于2022-02-21重构vite
 * 仅保留原有moon.js中上报相关的部分
 * @author baakqiu
 * @date 2022-02-21
 */

var WX_BJ_REPORT = window.WX_BJ_REPORT || {};
(function(_) {
  if (_.BadJs) {
    return;
  }
  //onerror上报名 
  var BADJS_WIN_ERR = 'BadjsWindowError';
  var extend = function(source, destination) {
    for (var property in destination) {
      source[property] = destination[property]
    }
    return source
  }
  /*
    出错上报字段:mid name key  msg  stack file col line uin
    mid 模块名
    name 监控名
    key 特征值
    msg 额外信息
  */
  _.BadJs = {
    uin: 0,
    mid: "",
    view: "wap",
    _cache: {}, //上报_cache 同一mid name key 只会上报一次
    _info: {}, // 打点记录 会写入msg帮助定位
    _hookCallback: null,
    ignorePath: true,
    throw: function(e, extData) {
      this.onError(e, extData);
      throw e;
    },
    //接收异常并上报处理 如果有额外信息可以放在第二个参数_data中
    // _data 只能覆盖上报协议的字段mid （name,key 不建议通过data覆盖） msg  stack file col line uin
    onError: function(e, extData) {
      try {
        //标记已执行的throw
        if (e.BADJS_EXCUTED == true) {
          return;
        }
        e.BADJS_EXCUTED = true;
        var data = errToData(e);
        data.uin = this.uin;
        data.mid = this.mid;
        data.view = this.view;
        data.cmdb_module = 'mmbizwap';
        //data.msg = msg || data.msg;
        if (!!extData) {
          data = extend(data, extData);
        }
        //如果cid存在 将cid合并到key
        if (data.cid) {
          data.key = "[" + data.cid + "]:" + data.key;
        }
        
        if (data._info) {
          if (Object.prototype.toString.call(data._info) == "[object Object]") {
            data.msg += " || info:" + JSON.stringify(data._info);
          } else if (Object.prototype.toString.call(data._info) == "[object String]") {
            data.msg += " || info:" + data._info;
          } else {
            data.msg += " || info:" + data._info;
          }
        }
        if (typeof this._hookCallback == "function") {
          if (this._hookCallback(data) === false) {
            return
          }
        }
        this._send(data);
        return _.BadJs;
      } catch (e) {
        console.error(e);
      }
    },
    winErr: function(event) {
      if (event.error && event.error.BADJS_EXCUTED) {
        return;
      }
      if (event.type === 'unhandledrejection') {
        _.BadJs.onError(createError(event.type, event.reason, "", "", "", event.reason));
      }else{
        _.BadJs.onError(createError(BADJS_WIN_ERR, event.message, event.filename, event.lineno, event.colno, event.error));
      }
    },
    init: function(uin, mid, view) {
      this.uin = uin || this.uin;
      this.mid = mid || this.mid;
      this.view = view || this.view;
      return _.BadJs;
    },
    //钩子函数
    hook: function(fn) {
      this._hookCallback = fn;
      return _.BadJs;
    },
    _send: function(data) {
      //hack uin mid
      if (!data.mid) {
        if (typeof window.PAGE_MID !== 'undefined' && window.PAGE_MID) {
          data.mid = window.PAGE_MID;
        } else {
          return;
        }
      }
      if (!data.uin) {
        data.uin = window.user_uin || 0;
      }
      // 发送要去重 
      var flag = [data.mid, data.name, data.key].join("|");
      if (this._cache && this._cache[flag]) {
        return
      } else {
        this._cache && (this._cache[flag] = true);
        this._xhr(data);
      }
      return _.BadJs;
    },
    _xhr: function(data) {
      //console.log(data);
      var xmlobj;
      if (window.ActiveXObject) {
        try {
          xmlobj = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
          try {
            xmlobj = new ActiveXObject("Microsoft.XMLHTTP");
          } catch (E) {
            xmlobj = false;
          }
        }
      } else if (window.XMLHttpRequest) {
        xmlobj = new XMLHttpRequest();
      }
      var param = "";
      for (var key in data) {
        if (key && data[key]) {
          param += [key, "=", encodeURIComponent(data[key]), "&"].join("");
        }
      }
      if (xmlobj && typeof xmlobj.open == "function") {
        xmlobj.open("POST", "https://badjs.weixinbridge.com/report", true);
        xmlobj.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
        xmlobj.onreadystatechange = function(status) {};
        xmlobj.send(param.slice(0, -1));
      } else {
        var img = new Image();
        img.src = "https://badjs.weixinbridge.com/report?" + param;
      }
    },
    // key是特征值 默认上报msg就是key，也可以主动传msg包含更多上报信息 
    report: function(name, key, data) {
      this.onError(createError(name, key), data);
      return this;
    },
    // 打点标记
    mark: function(info) {
      this._info = extend(this._info, info);
    },
    nocache: function() {
      this._cache = false;
      return _.BadJs;
    }
  }
  function createError(name, msg, url, line, col, error) {
    return {
      name: name || "",
      message: msg || "",
      file: url || "",
      line: line || "",
      col: col || "",
      stack: (error && error.stack) || "",
    }
  }
  //将异常错误转换成上报协议支持的字段
  /*
  * 先取e对象上的file line col等字段
  * 再解析e.statck
  * name 错误大类 默认取badjs_try_err|badjs_win_err
  * key  错误标识 e.message
  * msg  错误信息 e.message
  * stack 错误堆栈 e.stack
  * file 错误发生的文件
  * line 行
  * col 列
  * client_version
  */
  function errToData(e) {
    var _stack = parseStack(e);
    return {
      name: e.name,
      key: e.message,
      msg: e.message,
      stack: _stack.info,
      file: _stack.file,
      line: _stack.line,
      col: _stack.col,
      client_version: "",
      _info: e._info
    }
  }
  function parseStack(e) {
    e._info = e._info || ""; // 当前错误的额外信息 最终上报到info
    var stack = e.stack || "";
    var _stack = {
      info: stack,
      file: e.file || "",
      line: e.line || "",
      col: e.col || "",
    };
    if (_stack.file == "") {
      // 提取file line col
      var stackArr = stack.split(/\bat\b/);
      if (stackArr && stackArr[1]) {
        var match = /(https?:\/\/[^\n]+)\:(\d+)\:(\d+)/.exec(stackArr[1]);
        if (match) {
          //若stack提取的file line col跟e中的属性不一致，以stack为准 但在e._info中记录原始数据
          if (match[1] && match[1] != _stack.file) {
            _stack.file && (e._info += " [file: " + _stack.file + " ]");
            _stack.file = match[1];
          }
          if (match[2] && match[2] != _stack.line) {
            _stack.line && (e._info += " [line: " + _stack.line + " ]");
            _stack.line = match[2];
          }
          if (match[3] && match[3] != _stack.col) {
            _stack.col && (e._info += " [col: " + _stack.col + " ]");
            _stack.col = match[3];
          }
        }
      }
    }
    //替换堆栈中的文件路径 combojs太长
    if (_stack && _stack.file && _stack.file.length > 0) {
      _stack.info = _stack.info.replace(new RegExp(_stack.file.split("?")[0], "gi"), "__FILE__")
    }
    //堆栈路径只保存文件名
    if (_.BadJs.ignorePath) {
      _stack.info = _stack.info.replace(/http(s)?\:[^:\n]*\//ig, "").replace(/\n/gi, "");
    }
    return _stack;
  }
  //兜底方法
  window.addEventListener && window.addEventListener('error', _.BadJs.winErr);
  window.addEventListener && window.addEventListener('unhandledrejection', _.BadJs.winErr);
  return _.BadJs;
})(WX_BJ_REPORT);
window.WX_BJ_REPORT = WX_BJ_REPORT;
/**
 * 兼容wap项目的简单CMD管理
 * 所有wap项目必须包含此文件才可以执行成功
 * 暴露在全局的变量仍然以seajs为命名空间，跟web项目保持一致
 * 支持的API是seajs.use，以及require define
 * @author raphealguo
 * @date 20140326
 */
function __moonf__() {
  if (window.__moonhasinit) return;
  window.__moonhasinit = true;
  window.__moonclientlog = []; // moon中存到客户端日志里面的内容，最终写入到客户端的地点在fereport.js
  if (typeof JSON != "object") { //针对IE7的hack
    window.JSON = {
      stringify: function() { return ""; },
      parse: function() { return {}; }
    };
  }
  var moon_init = function() {
    // 前端的@cunjinli
    (function() {
      // @cunjinli 重写alert函数, moonsafe监控
      var _alert = window.alert;
      window.__alertList = [];
      window.alert = function(msg) {
        _alert(msg);
        window.__alertList.push(msg);
      };
    })();
    /**
     * moonsafe @cunjinli 加在这里
     */
    (function() {
      // if (window.__nonce_str) {
      //   var __old_createElement = document.createElement;
      //   document.createElement = function(tagName) {
      //     var node = __old_createElement.apply(this, arguments);
      //     if (typeof tagName == 'object') {
      //       tagName = tagName.toString();
      //     }
      //     if (typeof tagName == 'string' && tagName.toLowerCase() == 'script') {
      //       node.setAttribute("nonce", window.__nonce_str);
      //     }
      //     return node;
      //   }
      // }
      if (window.addEventListener && window.__DEBUGINFO && Math.random() < 0.01) {
        window.addEventListener("load", function() {
          var node = document.createElement('script');
          node.src = __DEBUGINFO.safe_js;
          node.type = 'text/javascript';
          node.async = true;
          var head = document.head || (document.getElementsByTagName("head")[0]);
          head.appendChild(node);
        });
      }
    })();
    /**
     * mooncatch
     * 对各种异步回调都使用try catch错误上报
     * @radeonwu raphealguo
     */
    (function() {
      var inWx = (/MicroMessenger/i).test(navigator.userAgent);
      var inMp = (/MPAPP/i).test(navigator.userAgent);
      var _idkey = 121261; //上报的idkey 添加默认上报值
      var _startKey; //开始的key
      var _limit; //上报的key的长度
      var _badjsId;
      var _reportOpt; //上报的额外信息
      var _extInfo; //附加的预留字段，如网络采样率采样率network_rate， 总体上报率rate
      var MOON_LISTENER_ERROR_KEY_OFFSET = 2; //addEventListener上报时的偏移量为2
      var MOON_AJAX_NETWORK_OFFSET = 4; //network错误时的上报偏移量为4，这里在ajax.js中上报，这里需要加入采样率
      var MOON_ASYNC_ERROR_KEY_OFFSET = 9; //setTimeout和setInterval上报时的偏移量为9
      var MOON_LOCALSTORAGE_ERROR_KEY_OFFSET = 10; //localstorage.setItem失败时的偏移量为10
      window.__initCatch = function(opt) {
        _idkey = opt.idkey;
        _startKey = opt.startKey || 0;
        _limit = opt.limit;
        _badjsId = opt.badjsId;
        _reportOpt = opt.reportOpt || "";
        _extInfo = opt.extInfo || {};
        _extInfo.rate = _extInfo.rate || 0.5;
      }
      //暴露的上报函数，供core.js和ajax.js上报错误使用，array = [{offset:MOON_JSAPI_KEY_OFFSET, log:"ready", e:e}]
      window.__moon_report = function(array, rate_opt) {
        var isAcrossOrigin = false;
        var href = '';
        try {
          href = top.location.href;
        } catch (e) {
          isAcrossOrigin = true;
        }
        var rate = 0.5;
        if (!!_extInfo && !!_extInfo.rate) {
          rate = _extInfo.rate;
        }
        if (!!rate_opt && (typeof rate_opt == 'number')) {
          rate = rate_opt;
        }
        if (
          (!(/mp\.weixin\.qq\.com/).test(location.href) && !(/payapp\.weixin\.qq\.com/).test(location.href)) ||
          Math.random() > rate ||
          !(inWx || inMp) ||
          (top != window && !isAcrossOrigin && !(/mp\.weixin\.qq\.com/).test(href))
        ) {
          //return ;
        }
        if (isObject(array))
          array = [array];
        if (!isArray(array) || _idkey == '')
          return;
        var data = "";
        var log = []; //存放array中每个对象关联的log
        var key = []; //存放array中每个上报的key
        var val = []; //存放array中每个上报的value
        var idkey = [];
        //如果这里没有opt.limit，直接上报到startKey
        if (typeof _limit != "number") {
          _limit = Infinity;
        }
        for (var i = 0; i < array.length; i++) {
          var item = array[i] || {};
          if (item.offset > _limit) continue; //上报的偏移量超过limit
          if (typeof item.offset != "number") continue;
          if (item.offset == MOON_AJAX_NETWORK_OFFSET && !!_extInfo && !!_extInfo.network_rate && Math.random() >= _extInfo.network_rate) {
            continue;
          }
          //log[i] = item.log || "";
          var k = _limit == Infinity ? _startKey : (_startKey + item.offset);
          log[i] = (("[moon]" + _idkey + "_" + k + ";") + item.log + ";" + getErrorMessage(item.e || {})) || "";
          key[i] = k;
          val[i] = 1;
        }
        for (var j = 0; j < key.length; j++) {
          idkey[j] = _idkey + "_" + key[j] + "_" + val[j];
          data = data + "&log" + j + "=" + log[j];
        }
        if (idkey.length > 0) {
          // sendReport("idkey=" + idkey.join(";") + "&lc=" + log.length + data);
          sendReport("POST", location.protocol + '//mp.weixin.qq.com/mp/jsmonitor?', "idkey=" + idkey.join(";") + "&r=" + Math.random() + "&lc=" + log.length + data);
          // 把图文消息的错误上报一份到badjs，只支持get请求
          // 这里由于量比较大，把badjs的内层怼爆了，这里加多一个采样，并且去掉用户的信息
          var rate = 1;
          if (_extInfo && _extInfo.badjs_rate) { // 初始化时的badjs采样率
            rate = _extInfo.badjs_rate;
          }
          if (Math.random() < rate) {
            data = data.replace(/uin\:(.)*\|biz\:(.)*\|mid\:(.)*\|idx\:(.)*\|sn\:(.)*\|/, '');
            if(!!_badjsId){
              var _img = new Image();
              var _src = 'https://badjs.weixinbridge.com/badjs?id=' + _badjsId + '&level=4&from=' + encodeURIComponent(location.host) + '&msg=' + encodeURIComponent(data);
              _img.src = _src.slice(0, 1024);
            }
            // badjs同时报一份到新监控 
            if (typeof WX_BJ_REPORT != "undefined" && WX_BJ_REPORT.BadJs) {
              for (var i = 0; i < array.length; i++) {
                var item = array[i] || {};
                if (item.e) {
                  WX_BJ_REPORT.BadJs.onError(item.e,{_info:item.log});
                } else {
                  var name = /[^:;]*/.exec(item.log)[0];
                  WX_BJ_REPORT.BadJs.report(name, item.log, { mid: "mmbizwap:Monitor" });
                }
              }
            }
          } else {
            //虽然采样没有执行 但实际是有被BadJs.onError，置位一下
            for (var i = 0; i < array.length; i++) {
              var item = array[i] || {};
              if (item.e) {
                item.e.BADJS_EXCUTED = true;
              }
            }
          }
        }
      }
      function isArray(obj) { //判断输入是否为数组
        return Object.prototype.toString.call(obj) === '[object Array]';
      }
      function isObject(obj) { //判断输入是否为对象
        return Object.prototype.toString.call(obj) === '[object Object]';
      }
      function getErrorMessage(e) {
        var stack = e.stack + ' ' + e.toString() || ""; //错误堆栈信息
        try {
          //先取出res域名
          if (!window.testenv_reshost) {
            stack = stack.replace(/http(s)?:\/\/res\.wx\.qq\.com/g, "");
          } else {
            var host = 'http(s)?://' + window.testenv_reshost;
            var reg = new RegExp(host, 'g');
            stack = stack.replace(reg, "");
          }
          //提取最后一个.js前边的
          var reg = /\/([^.]+)\/js\/(\S+?)\.js(\,|:)?/g;
          while (reg.test(stack)) {
            // stack = stack.replace(reg, "3"); 解决$问题
            stack = stack.replace(reg, function(a, b, c, d, e, f) {
              return c + d
            });
          }
        } catch (e) {
          stack = e.stack ? e.stack : "" //错误堆栈信息
        }
        var ret = [];
        for (o in _reportOpt) {
          if (_reportOpt.hasOwnProperty(o)) {
            ret.push(o + ":" + _reportOpt[o]);
          }
        }
        ret.push("STK:" + stack.replace(/\n/g, ""));
        return ret.join("|");
      }
      function sendReport(type, url, data) { //post方法用于提交数据
        if (!/^mp\.weixin\.qq\.com$/.test(location.hostname)) { //非MP域名使用 img方式上报
          var tmp = [];
          data = data.replace(location.href, (location.origin || "") + (location.pathname || "")).replace("#wechat_redirect", "").replace("#rd", "").split("&");
          for (var i = 0, il = data.length; i < il; i++) {
            var a = data[i].split("=");
            if (!!a[0] && !!a[1]) {
              tmp.push(a[0] + "=" + encodeURIComponent(a[1]));
            }
          }
          var _img = new window.Image();
          _img.src = (url + tmp.join("&")).substr(0, 1024);
          return;
        }
        var xmlobj; //定义XMLHttpRequest对象  
        if (window.ActiveXObject) { //如果当前浏览器支持Active Xobject，则创建ActiveXObject对象    
          try {
            xmlobj = new ActiveXObject("Msxml2.XMLHTTP");
          } catch (e) {
            try {
              xmlobj = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (E) {
              xmlobj = false;
            }
          }
        } else if (window.XMLHttpRequest) { //如果当前浏览器支持XMLHttpRequest，则创建XMLHttpRequest对象  
          xmlobj = new XMLHttpRequest();
        }
        if (!xmlobj) return;
        //xmlobj.open("POST", location.protocol + "//mp.weixin.qq.com/mp/jsmonitor?", true);         
        xmlobj.open(type, url, true);
        xmlobj.setRequestHeader("cache-control", "no-cache");
        xmlobj.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8"); //设置请求头信息              
        xmlobj.setRequestHeader("X-Requested-With", "XMLHttpRequest");
        xmlobj.send(data); //发送数据  
      }
      function catTimeout(foo) {
        return function(cb, timeout) {
          if (typeof cb === 'string') {
            try {
              cb = new Function(cb);
            } catch (err) {
              throw err;
            }
          }
          var args = [].slice.call(arguments, 2);
          var _cb = cb;
          cb = function() {
            try {
              return _cb.apply(this, (args.length && args) || arguments);
            } catch (error) {
              if (error.stack && console && console.error) { //chrome有bug，特定情况下看不到throw的error，这里console.error下，防止给调试留坑
                console.error("[TryCatch]" + error.stack);
              }
              if (!!_idkey && !!window.__moon_report) { //没有初始化_key，直接throw error
                //sendReport(error);
                window.__moon_report([{ offset: MOON_ASYNC_ERROR_KEY_OFFSET, log: "timeout_error;host:" + location.host, e: error }]);
                //breakOnError(timeoutkey);
              }
              throw error;
            }
          }
          return foo(cb, timeout);
        };
      };
      window.setTimeout = catTimeout(window.setTimeout);
      window.setInterval = catTimeout(window.setInterval);
      if (Math.random() < 0.01 && !!window.Document && !!window.HTMLElement) {
        var cb_map = {};
        var moon_lid = 0;
        function catAddListener(foo) {
          return function(type, cb, useCapture) {
            if (typeof useCapture === "undefined") {
              var useCapture = false;
            }
            var that = this;
            var _cb = cb || function() {};
            cb = function() {
              try {
                //arguments[0].currentTarget.setAttribute("data-moon_lid") = moon_lid;
                //_cb.moon_lid = moon_lid;
                return _cb.apply(that, arguments);
              } catch (error) {
                if (error.stack && console && console.error) { //chrome有bug，特定情况下看不到throw的error，这里console.error下，防止给调试留坑
                  console.error("[TryCatch]" + error.stack);
                }
                if (!!_idkey && !!window.__moon_report) { //没有初始化_key，直接throw error
                  window.__moon_report([{ offset: MOON_LISTENER_ERROR_KEY_OFFSET, log: "listener_error;type:" + type + ";host:" + location.host, e: error }]);
                  //breakOnError(timeoutkey);
                }
                throw error;
              }
            }
            _cb.moon_lid = moon_lid;
            cb_map[moon_lid] = cb;
            moon_lid++;
            return foo.call(that, type, cb, useCapture);
          }
        }
        function catRemoveListener(foo) {
          return function(type, cb, useCapture) {
            if (typeof useCapture === "undefined") {
              var useCapture = false;
            }
            var that = this;
            cb = cb_map[cb.moon_lid];
            return foo.call(that, type, cb, useCapture);
          }
        }
        Document.prototype.addEventListener = catAddListener(Document.prototype.addEventListener);
        Document.prototype.removeEventListener = catRemoveListener(Document.prototype.removeEventListener);
        HTMLElement.prototype.addEventListener = catAddListener(HTMLElement.prototype.addEventListener);
        HTMLElement.prototype.removeEventListener = catRemoveListener(HTMLElement.prototype.removeEventListener);
      }
      //alert("setItem begin");
      //window.localStorage.setItem = function(){a=c;}//故意
      var ua = window.navigator.userAgent;
      if ((/ip(hone|ad|od)/i.test(ua) || /android/i.test(ua)) && !/windows phone/i.test(ua) && !!window.localStorage && !!window.localStorage.setItem) {
        var _setItem = window.localStorage.setItem;
        var count = 0;
        window.localStorage.setItem = function(k, v) {
          if (count >= 10) { //一直失败 不要再继续试了，可能类似safari无痕模式 不允许写入了
            return;
          }
          try {
            _setItem.call(window.localStorage, k, v);
          } catch (error) {
            //alert(error);
            if (error.stack && console && console.error) { //chrome有bug，特定情况下看不到throw的error，这里console.error下，防止给调试留坑
              console.error("[TryCatch]" + error.stack);
            }
            window.__moon_report([{ offset: MOON_LOCALSTORAGE_ERROR_KEY_OFFSET, log: "localstorage_error;" + error.toString(), e: error }]);
            count++;
            if (count >= 3 && !!window.moon && window.moon.clear) {
              // 可能爆满 清理一下localstorage
              moon.clear();
            }
          }
        }
        //alert("setItem end");
      }
    })();
    // 后面的@cunjinli
  };
  moon_init();
  //由于moon异步化，所以有些逻辑需要moon加载完之后才执行的 放到全局callback函数__moon_initcallback里边
  (!!window.__moon_initcallback) && (window.__moon_initcallback());
}
// 为适应inline逻辑，有map时才主动自执行 @zhikaimai
// if (typeof window.moon_map == 'object') {
//     __moonf__();
// }
__moonf__();

if (!!window.addEventListener){
  window.addEventListener("load",function(){
    var MOON_SCRIPT_ERROR_KEY_OFFSET = 1; //script上报时的偏移量为1
    var ns = document.querySelectorAll("[reportloaderror]");
    for(var ni=0,nl=ns.length;ni<nl;ni++)
      ns[ni].onerror=function(ev){
        window.__moon_report([{ offset: MOON_SCRIPT_ERROR_KEY_OFFSET, log: "load_script_error:" + ev.target.src, e: new Error('LoadResError') }], 1);
        window.WX_BJ_REPORT.BadJs.report("load_script_error", ev.target.src, { mid: "mmbizwap:Monitor" });
      };
  });
}
</script>

    <script type="text/javascript" nonce="1738606354" reportloaderror>
  var testRdmUrl = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/common/avatar_default5e2e9e.svg';
  // 如果是资源是mp域名，则是rdm环境
  if (testRdmUrl.indexOf('mp.weixin.qq.com') > 0) {
    window.__allowLoadResFromMp = true; // 允许从mp.weixin.qq.com加载js资源
    window.__loadAllResFromMp = true; // 所有js资源都从mp域名加载

    // 给底色加个原谅绿
    // document.documentElement.style.boxShadow = 'inset 0 0 15px green';
  }
</script>


    

  
  <meta name="description" content="唧唧堂论文导读，读懂各领域最新最热最经典论文！" />
  <meta name="author" content="" />

  
  <meta property="og:title" content="唧唧堂：MSOM 制造与服务运营管理期刊 2022年1-2月论文摘要39篇" />
  <meta property="og:url" content="http://mp.weixin.qq.com/s?__biz=MjM5Mzg0NDkyMA==&amp;mid=2652258570&amp;idx=3&amp;sn=983433c51ef56b5df1cfbc3d4834c3cf&amp;chksm=bd723add8a05b3cb995df9e77b39a61084eceec7f782eb273c6437427987111e3a004341db1e#rd" />
  <meta property="og:image" content="http://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRGp4kXGYstQQPKUvbFNtqr2dlDOib3OxxpKueicqQiauDuJt1M233nx8QxrxTZ7k7ib6cRM33WfIuHRYA/0?wx_fmt=jpeg" />
  <meta property="og:description" content="唧唧堂论文导读，读懂各领域最新最热最经典论文！" />
  <meta property="og:site_name" content="微信公众平台" />
  <meta property="og:type" content="article" />
  <meta property="og:article:author" content="" />

  
  <meta property="twitter:card" content="summary" />
  <meta property="twitter:image" content="http://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRGp4kXGYstQQPKUvbFNtqr2dlDOib3OxxpKueicqQiauDuJt1M233nx8QxrxTZ7k7ib6cRM33WfIuHRYA/0?wx_fmt=jpeg" />
  <meta property="twitter:title" content="唧唧堂：MSOM 制造与服务运营管理期刊 2022年1-2月论文摘要39篇" />
  <meta property="twitter:creator" content="" />
  <meta property="twitter:site" content="微信公众平台" />
  <meta property="twitter:description" content="唧唧堂论文导读，读懂各领域最新最热最经典论文！" />


    <title></title>
    
<style>
</style>


    
<script type="module" nonce="1738606354" reportloaderror>!function(){try{new Function("m","return import(m)")}catch(o){console.warn("vite: loading legacy build because dynamic import is unsupported, syntax error above should be ignored");var e=document.getElementById("vite-legacy-polyfill"),n=document.createElement("script");n.src=e.src,n.onload=function(){System.import(document.getElementById('vite-legacy-entry').getAttribute('data-src'))},document.body.appendChild(n)}}();</script>
<script type="module" crossorigin src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/appmsg.74500902.js" nonce="1738606354" reportloaderror></script>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/sprite.e3a96375.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/vendor.1388b289.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/report.d62d386e.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/wxwork_hidden.438fe9a7.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/loadscript.115117bc.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/voice_component.d2ff964c.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/bottom_modal.eb5b4cfa.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/outer_link.abe8525c.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/review_image.e277f418.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/pay_read_utils.d317e2fc.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/controller.d361f591.js" reportloaderror>
<link rel="modulepreload" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/modal.879910c9.js" reportloaderror>









<link rel="stylesheet" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/appmsg.9b6b5c53.css" reportloaderror>
<link rel="stylesheet" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/sprite.dcee1002.css" reportloaderror>
<link rel="stylesheet" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/report.301986bf.css" reportloaderror>
<link rel="stylesheet" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/wxwork_hidden.96d6e8be.css" reportloaderror>
<link rel="stylesheet" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/controller.6ea5f70d.css" reportloaderror>

    <style>
      .cooldown_tips {
        margin: 30px auto;
        margin-top: 0;
        display: flex;
        align-items: center;
        padding: 10px;
        font-size: 14px;
        background-color: #f6f7f9;
        border-radius: 6px;
      }   
      .cooldown_tips_icon {
        display: block;
        width: 18px;
        height: 18px;
        margin-right: 8px;
      }
    </style>
  </head>

  <body id="activity-detail" class="zh_CN wx_wap_page 

                                            wx_wap_desktop_fontsize_2    mm_appmsg
 comment_feature
 discuss_tab appmsg_skin_default appmsg_style_default">
    
    
<script type="text/javascript" nonce="1738606354" reportloaderror>
  var biz = "MjM5Mzg0NDkyMA==" || "";
  var sn = "983433c51ef56b5df1cfbc3d4834c3cf" || "" || "";
  var mid = "2652258570" || "" || "";
  var idx = "3" || "" || "";
  window.__allowLoadResFromMp = true; // 允许从mp.weixin.qq.com加载js资源
  // window.__loadAllResFromMp = true; // 所有js资源都从mp域名加载
</script>

<script  nonce="1738606354" reportloaderror>
var page_begintime = (+new Date());
// 辟谣需求
var is_rumor = "";
var norumor = "";
if (!!(is_rumor * 1) && !(norumor*1) && !!biz && !!mid) {
  if (!document.referrer || document.referrer.indexOf("mp.weixin.qq.com/mp/rumor") == -1){
    location.href = "http://mp.weixin.qq.com/mp/rumor?action=info&__biz=" + biz + "&mid=" + mid + "&idx=" + idx + "&sn=" + sn + "#wechat_redirect";
  }
}
</script>

<script type="text/javascript" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/biz_wap/safe/inline_mutation_observer5e2ea0.js" nonce="1738606354" reportloaderror></script>

    <link rel="dns-prefetch" href="//res.wx.qq.com" reportloaderror>
<link rel="dns-prefetch" href="//mmbiz.qpic.cn" reportloaderror>
<link rel="dns-prefetch" href="https://wxa.wxs.qq.com" reportloaderror>
<link rel="shortcut icon" type="image/x-icon" href="//res.wx.qq.com/a/wx_fed/assets/res/NTI4MWU5.ico" reportloaderror>
<link rel="mask-icon" href="//res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg" color="#4C4C4C" reportloaderror>
<link rel="apple-touch-icon-precomposed" href="//res.wx.qq.com/a/wx_fed/assets/res/OTE0YTAw.png" reportloaderror>
<script type="text/javascript" nonce="1738606354" reportloaderror>
String.prototype.html = function (encode) {
  var replace = ["&#39;", "'", "&quot;", '"', "&nbsp;", " ", "&gt;", ">", "&lt;", "<", "&yen;", "¥", "&amp;", "&"];
  // 最新版的safari 12有一个BUG，如果使用字面量定义一个数组，var a = [1, 2, 3]
  // 当调用了 a.reverse() 方法把变量 a 元素顺序反转成 3, 2, 1 后，
  // 即使此页面刷新了， 或者此页面使用 A标签、 window.open 打开的页面，
  // 只要调用到同一段代码， 变量 a 的元素顺序都会变成 3, 2, 1
  // 所以这里不用 reverse 方法
  /*
  if (encode) {
      replace.reverse();
  }*/
  var replaceReverse = ["&", "&amp;", "¥", "&yen;", "<", "&lt;", ">", "&gt;", " ", "&nbsp;", '"', "&quot;", "'", "&#39;"];
  var target;
  if (encode) {
    target = replaceReverse;
  } else {
    target = replace;
  }
  for (var i = 0, str = this; i < target.length; i += 2) {
    str = str.replace(new RegExp(target[i], 'g'), target[i + 1]);
  }
  return str;
};

window.isInWeixinApp = function () {
  return /MicroMessenger/.test(navigator.userAgent);
};

window.getQueryFromURL = function (url) {
  url = url || 'http://qq.com/s?a=b#rd'; // 做一层保护，保证URL是合法的
  var tmp = url.split('?'),
    query = (tmp[1] || "").split('#')[0].split('&'),
    params = {};
  for (var i = 0; i < query.length; i++) {
    var arg = query[i].split('=');
    params[arg[0]] = arg[1];
  }
  if (params['pass_ticket']) {
    params['pass_ticket'] = encodeURIComponent(params['pass_ticket'].html(false).html(false).replace(/\s/g, "+"));
  }
  return params;
};

(function () {
  var params = getQueryFromURL(location.href);
  window.uin = params['uin'] || "" || '';
  window.key = params['key'] || "" || '';
  window.wxtoken = params['wxtoken'] || '';
  window.pass_ticket = params['pass_ticket'] || '';
  window.appmsg_token = "";
})();
</script>
    
<script type="text/javascript" nonce="1738606354" reportloaderror>window.PAGE_MID="mmbizwap:appmsg/newindex.html"</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
  var write_sceen_time = (+new Date());
  var preview = "" * 1 || 0;

  var currencyMap = {
    'USD': '$',
    'HKD': 'HK$',
    'CAD': 'C$',
    'AUD': 'A$',
    'TWD': 'NT$',
    'JPY': 'JPY￥',
    'EUR': '€',
    'SGD': 'S$',
    'GBP': '£',
    'NZD': 'NZ$',
    'MYR': 'RM',
    'KZT': '〒',
    'KRW': '₩',
    'THB': '฿',
    'PHP': '₱',
    'TRY': '₺',
    'MXN': 'Mex$',
    'CNY': '￥'
  };
  var can_use_wecoin = '1' * 1; // 是否个人号
  var wecoin_tips = '0' * 1; // 是否出教育弹窗
  /* var can_use_wecoin = 1; */
  var wecoin_amount = '0' * 1; // 微信豆个数
</script>

<div id="js_article" class="rich_media">
  
  <div id="js_top_ad_area" class="top_banner"></div>
  
  <div class="rich_media_inner">
    
    
    <div id="page-content" class="rich_media_area_primary">
      <div class="rich_media_area_primary_inner">
        
        
        
                <div id="img-content" class="rich_media_wrp">
          
          <h1 class="rich_media_title " id="activity-name">
            
唧唧堂：MSOM 制造与服务运营管理期刊 2022年1-2月论文摘要39篇
          </h1>
          <div id="meta_content" class="rich_media_meta_list">
                                                
                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
              <a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">
                唧唧堂              </a>
              <div id="js_profile_qrcode" aria-hidden="true" class="profile_container" style="display:none;">
                <div class="profile_inner">
                  <strong class="profile_nickname">唧唧堂</strong>
                  <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                  <p class="profile_meta">
                  <label class="profile_meta_label">微信号</label>
                  <span class="profile_meta_value">Jijitang_com</span>
                  </p>

                  <p class="profile_meta">
                  <label class="profile_meta_label">功能介绍</label>
                  <span class="profile_meta_value">唧唧堂论文导读，读懂各领域最新最热最经典论文！</span>
                  </p>
                </div>
                <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                  <i class="profile_arrow arrow_out"></i>
                  <i class="profile_arrow arrow_in"></i>
                </span>
              </div>
            </span>
            <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>
            <em id="js_ip_wording_wrp" class="rich_media_meta rich_media_meta_text" role="option" style="display: none;">发表于<span id="js_ip_wording" ></span></em>

          </div>

          
                                                    <div id="js_tags" class="article-tag__list" style="display: none;" data-len="0"
                      >
                          
              <div class="article-tag-card__title">收录于合集</div>
              <div class="article-tags">
                                                                </div>
                      </div>

          
                    
                                        

          
                    

          
                              
                                        
                    
                    
          
          <div class="rich_media_content                                                                     " 
            id="js_content" style="visibility: hidden;">
            <p style="text-align: center;" data-mpa-powered-by="yiban.io"><img class="rich_pages wxw-img" data-backh="464" data-backw="579" data-ratio="0.8028571428571428" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRHcMwYZIzicf2NSkk90c4t0Jmb95n2ztd6JyD6sFF1mSNKBiaXztKVl1C4MnkMRMxlGNLkh17Qk5maQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="700" style="width: 100%;height: auto;"  /></p><figure style="outline: 0px;max-width: 100%;white-space: normal;letter-spacing: 0.544px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);width: 600px;text-align: center;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(136, 136, 136);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 16px;letter-spacing: 0.544px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">picture from Internet</span></figure><section style="outline: 0px;max-width: 100%;white-space: normal;letter-spacing: 0.544px;font-size: 16px;min-height: 1em;background-color: rgb(255, 255, 255);text-align: center;font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(136, 136, 136);visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">解析作者 | 唧唧堂管理学写作小组：</span><span style="outline: 0px;max-width: 100%;color: rgb(0, 0, 0);visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">&nbsp;</span><span style="outline: 0px;max-width: 100%;color: rgb(0, 0, 0);letter-spacing: 0.544px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">辰辰，泡泡</span></section><section style="outline: 0px;max-width: 100%;white-space: normal;letter-spacing: 0.544px;font-size: 16px;min-height: 1em;background-color: rgb(255, 255, 255);text-align: center;font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(136, 136, 136);visibility: visible;">审校</span><span style="outline: 0px;max-width: 100%;color: rgb(136, 136, 136);letter-spacing: 0.544px;visibility: visible;">&nbsp;| 唧唧堂管理学写作小组：</span></span><span style="outline: 0px;max-width: 100%;color: rgb(0, 0, 0);letter-spacing: 0.544px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">OMIS</span></section><section style="outline: 0px;max-width: 100%;white-space: normal;letter-spacing: 0.544px;font-size: 16px;min-height: 1em;background-color: rgb(255, 255, 255);text-align: center;font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(136, 136, 136);visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">编辑 |&nbsp;</span><span style="outline: 0px;max-width: 100%;color: rgb(0, 0, 0);letter-spacing: 0.544px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">小巴</span></section><p style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.4352px;white-space: normal;background-color: rgb(255, 255, 255);visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"  /></p><p style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">1. OM论坛-流行病/广泛性流行病：业务管理研究的挑战和机遇</span></strong></p><p><br  /></p><p>我们回顾了截至2019年底发表在主要运营管理、运营研究和管理科学期刊上的有关流行病/广泛性流行病（全球/区域范围内的疾病暴发）的研究论文，并对这些论文进行评估和分类。通过分析研究趋势，探索研究差距，本文旨为未来更高效和有效的研究提供方向。而且，我们建议从当前流行的COVID-19中汲取教训。具体来说，我们对以下几类论文进行了讨论：(a)预警信号/监测，(b)疾病传播导致大流行，(c)缓解，(d)疫苗和治疗方法的研发，(e)资源管理，(f)供应链配置，(g)管理流行病/广泛性流行病的决策支持系统，(h)风险评估。</p><p><br  /></p><p>We reviewed research papers related to pandemics/epidemics (disease outbreaks of a global/regional scope) published in major operations management, operations research, and management science journals through the end of 2019. We evaluate and categorize these papers. We study research trends, explore research gaps, and provide directions for more efficient and effective research in the future. In addition, our recommendations include the lessons learned from the ongoing pandemic, COVID-19. We discuss papers in the following categories: (a) warning signals/surveillance, (b) disease propagation leading to pandemic conditions, (c) mitigation, (d) vaccines and therapeutics development, (e) resource management, (f) supply chain configuration, (g) decision support systems for managing pandemics/epidemics, and (h) risk assessment.</p><p><br  /></p><p>参考文献：Sushil Gupta, Martin K. Starr, Reza Zanjirani Farahani, Nasrin Asgari. OM Forum—Pandemics/Epidemics: Challenges and Opportunities for Operations Management Research. Manufacturing &amp; Service Operations Management, 2021, 24(1):1-23.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">2. 通过运营管理实现智慧城市</span></strong></p><p><br  /></p><p>新技术和数据分析的最新发展引发了所谓的智慧城市(SC)运动，这已经改变了城市（及其服务）的运营方式。这一运动与运营管理(OM)界对创新研究问题的追求是一致的，而且部分人员已经开始在这一令人兴奋的SC OM领域开展研究工作。本文我们将讨论：(i) OM对SC运动的潜在贡献，即OM研究如何有助于获悉公共和私营部门的讨论和决策制定。特别地，让城市更智慧的核心原则与OM理论是一致的。(ii)通过与OM文献的既有和最新的研究方向相联系，讨论SC运作如何以及为何可以成为一个可能扩大OM理论的范畴和深度的有趣主题。最后，我们提出(iii)在诸如能源、交通（移动）和零售等领域中一些有前景的研究方向和实例。</p><p><br  /></p><p>Recent development of new technologies and data analytics has unleashed the so-called smart city (SC) movement, which has been transforming the ways that cities (and their services) operate. This movement is in line with the operations management (OM) community’s pursuit of innovative research questions, and part of our community has already started working on this exciting area of SC OM. In this article, we shall discuss (i) the potential contribution that OM can make to the SC movement, that is, how OM research may help inform discussion and decision making in the public and private sectors. In particular, the core principle of making cities smarter is in line with the OM literature. We then discuss (ii) how and why SC operations can be an interesting topic that possibly expands the scope and depth of OM theory, through drawing links to the existing and new streams of OM literature. Finally, we present (iii) a few promising research directions and examples, in domains such as energy, transportation (mobility), and retail.</p><p><br  /></p><p>参考文献：Ho-Yin Mak. Enabling Smarter Cities with Operations Management. Manufacturing &amp; Service Operations Management , 2020, 24(1):24-39.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">3. 这是不公平的：屋顶太阳能电力设施的关税结构</span></strong></p><p><br  /></p><p>问题定义：公用事业监管机构正努力为那些将屋顶太阳能发电卖回电网的客户设计补偿方案，以平衡环境利益和公用事业、太阳能系统安装商和零售客户的财务利益。但这是困难的，2015年内华达州为保护其公用事业公司而进行监管改革，却导致太阳能系统市场的主导者SolarCity暂停了当地的运营。我们发现公用事业收费结构的选择对于实现社会期望的目标是至关重要的。学术/实践相关性：对于监管者来说，理解关税结构如何与社会目标相互作用极为重要。这点对于消费者、监管机构和行业都有影响。研究方法：利用序列博弈分析了具有管制效用的市场中监管者的社会福利最大化问题；一个不受监管、定价和利润最大化的太阳能系统安装者；以及根据公用事业电价、太阳能价格、和他们不同的使用概况和发电潜力，而自行决定是否采用太阳能的客户。结果：我们发现，关税结构的有效性不是简单地由自由关税参数的数量来控制，而是由这些参数服务的函数来控制。特别地，有效的电价必须区别对待客户的使用层次，以及有和没有屋顶太阳能的客户，才能实现社会期望的目标。我们提出了一个具备这两个特点的关税结构，并展示其如何可以作为一个简单的购买和出售关税，并同时保留其有利的属性。我们使用了正在努力解决这个问题的内华达州和新墨西哥州的数据。管理含义：美国诸多公用事业运营的关税结构至少缺少两个确定的特征之一。监管机构必须彻底改革这些关税结构，才能充分保护所有利益相关者。</p><p><br  /></p><p>Problem definition: Utility regulators are grappling to devise compensation schemes for customers who sell rooftop solar generation back to the grid, balancing environmental interests and the financial interests of utilities, solar system installers, and retail customers. This is difficult: Regulatory changes made in Nevada in 2015 to protect Nevada’s utility induced SolarCity, the market leader in solar systems, to suspend local operations. We show that the choice of utility tariff structure is crucial to achieving socially desirable objectives. Academic/practical relevance: It is important for regulators to understand how tariff structure interacts with social objectives. This has implications for consumers, regulators, and industry. Methodology: We use a sequential game to analyze the regulator’s social welfare maximization problem in a market with a regulated utility; an unregulated, price-setting, profit-maximizing solar system installer; and customers who endogenously determine whether to adopt solar or not, based on utility tariffs, solar prices, and their heterogeneous usage profiles and generation potentials. Results: We illustrate that the effectiveness of tariff structures is not governed simply by the number of free tariff parameters, but by the functions these parameters serve. In particular, an effective tariff must discriminate among customer usage tiers and between customers with and without rooftop solar to achieve socially desirable outcomes. We present a tariff structure with these two characteristics and show how it can be implemented as a simple buy-all, sell-all tariff while retaining its favorable properties. We illustrate our findings numerically using data from Nevada and New Mexico, two states grappling with this issue. Managerial implications: Many utilities in the United States operate tariff structures that are missing at least one of the two identified features. Regulators must overhaul these tariff structures to adequately safeguard all stakeholders.</p><p><br  /></p><p>参考文献：Siddharth Prakash Singh, Alan Scheller-Wolf. That’s Not Fair: Tariff Structures for Electric Utilities with Rooftop Solar. Manufacturing &amp; Service Operations Management, 2021, 24(1):40-58.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">4. 基地和过载能力的最优动态预约调度</span></strong></p><p><br  /></p><p>问题定义：我们研究了当延迟预约增加发生昂贵故障的风险时的动态随机预约调度问题，例如医疗保健系统的再就诊或预防性维护中的引擎故障。当短期基本预约容量满时，调度器面临着一种权衡：要么以代价高昂的失败风险推迟预约，要么以额外的成本使用激增容量以更快地安排预约。学术/实践相关性：操作领域的大多数预约调度文献关注的是等待时间和利用率之间的权衡。相比之下，我们分析了当企业负责服务和故障成本时，预防性预约调度及其对更广泛的服务供应网络的影响。方法：我们采用一个随机动态规划(DP)公式来描述最优的调度策略并利用启发式进行评估。结果：我们给出了简单政策最优性的充分条件。当解析解难以解决时，我们用数值方法来解决DP，并提出医疗保健环境中几种实际政策的最优性差距。管理启示：在实践中使用的直觉任命政策在适度的产能利用率下是稳健的，但在高负荷下它的最优差距可能会翻四倍。</p><p><br  /></p><p>Problem definition: We study dynamic stochastic appointment scheduling when delaying appointments increases the risk of incurring costly failures, such as readmissions in healthcare or engine failures in preventative maintenance. When near-term base appointment capacity is full, the scheduler faces a trade-off between delaying an appointment at the risk of costly failures versus the additional cost of scheduling the appointment sooner using surge capacity. Academic/practical relevance: Most appointment-scheduling literature in operations focuses on the trade-off between waiting times and utilization. In contrast, we analyze preventative appointment scheduling and its impact on the broader service-supply network when the firm is responsible for service and failure costs. Methodology: We adopt a stochastic dynamic programming (DP) formulation to characterize the optimal scheduling policy and evaluate heuristics. Results: We present sufficient conditions for the optimality of simple policies. When analytical solutions are intractable, we solve the DP numerically and present optimality gaps for several practical policies in a healthcare setting. Managerial implications: Intuitive appointment policies used in practice are robust under moderate capacity utilization, but their optimality gap can quadruple under high load.</p><p><br  /></p><p>参考文献：Benjamin Grant, Itai Gurvich, R. Kannan Mutharasan, Jan A. Van Mieghem. Optimal Dynamic Appointment Scheduling of Base and Surge Capacity. Manufacturing &amp; Service Operations Management, 2021, 24(1), 59-76.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">5. 供应链竞争下的战略库存</span></strong><span style="color: rgb(255, 76, 65);"></span></p><p><br  /></p><p>问题定义：我们在一个两周期模型中考虑存在链对链竞争时战略库存(SI)的影响。学术/实践相关性：已建立的研究结果表明，SI可以缓解双重边缘化，并提高分散分销渠道的效率。然而，目前还没有研究考虑链对链竞争下SI的作用。方法：我们建立了一个由两个竞争供应链组成的两周期模型，每个供应链包含一个上游制造商和一个独家零售商。零售商在价格或数量上进行竞争。我们在完全贝叶斯均衡的概念下刻画了企业战略的特征。我们考虑了供应链合同可观察和不可观察两种情形。结果：(1)在链对链的竞争下，SI仍然存在。当竞争变得愈加激烈时，零售商可能会有更多的库存，而这会进一步加剧供应链的竞争。(2)与已有的发现不同，SI可能会适得其反，并损害所有公司。不过有趣的是，企业可能会从更高的库存持有成本中受益。(3)在供应链竞争下，当竞争强度为中等时，会出现囚徒困境；换句话说，没有战略库存的制造商会更好，但他们不得不允许战略库存的存在，毕竟这是唯一的均衡。管理启示：尽管SI在单一供应链的公司中具有吸引力，但其作用在链对链的竞争中改变甚至颠倒了，因此应该谨慎应用SI。</p><p><br  /></p><p>Problem definition: We consider the effects of strategic inventory (SI) in the presence of chain-to-chain competition in a two-period model. Academic/practical relevance: Established findings suggest that SI may alleviate double marginalization and improve the efficiency of a decentralized distribution channel. However, no studies consider the role of SI under chain-to-chain competition. Methodology: We build a two-period model consisting of two competing supply chains, each with an upstream manufacturer and an exclusive retailer. The retailers compete on either price or quantity. We characterize the firms’ strategies under the concept of perfect Bayesian equilibrium. We consider cases where contracts are either observable or unobservable across supply chains. Results: (1) SI still exists under chain-to-chain competition. Retailers may carry more inventory when the competition becomes fiercer, which further intensifies the supply chain competition. (2) Different from the existing findings, SI may backfire and hurt all firms. Interestingly, firms may benefit from a higher inventory holding cost. (3) Under supply chain competition, the prisoner’s dilemma can arise if competition intensity is intermediate; in other words, manufacturers are better off without strategic inventory, and yet they cannot help allowing strategic inventory, which is the unique equilibrium. Managerial implications: Despite its appeal among firms of a single supply chain, the role of SI is altered or even reversed by chain-to-chain competition. Conventional wisdom on SI should be applied with caution.</p><p><br  /></p><p>参考文献：Xi Li, Yanzhi Li, Ying-Ju Chen. Strategic Inventories Under Supply Chain Competition. Manufacturing &amp; Service Operations Management, 2021, 24(1):77-90.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">6. 网约车中的高峰定价和双边时间响应</span></strong></p><p><br  /></p><p>问题定义：我们从时间的角度研究网约车平台的峰时定价，强调乘客和司机的战略行为、以及司机对峰时定价的反应比乘客慢得多。学术/实践相关性：网约车平台的峰时定价是一个关键且有争议的课题。虽然已有有大量的轶事证据，但骑手和司机的策略行为还未能在文献中得到正式的研究。方法：类似于战略消费者文献中的做法，我们采用并分析一个经典的两周期博弈理论模型。结果：我们确定了两种均衡定价策略。第一种是短暂的、急剧的价格飙升后价格再下降，我们称之为撇脂提价(SSP)。第二种是一个较低的初始价格后价格再上升，我们称之为渗透提价(PSP)。我们发现，当两者都存在且需要平台与骑手共享需求-供应信息时，PSP均衡通常优于SSP均衡。管理启示：SSP均衡合理化了有争议的大幅提价行为：短暂的大幅提价导致许多高价值乘客自愿等待度过最初的提价期，这吸引了较多骑手到该地区以远低于最初的提价价格为乘客服务。理论上更优的PSP均衡表明了一种截然不同的方法可能会改善峰时定价，并强调了平台与骑手共享供求信息的潜在价值和重要性。</p><p><br  /></p><p>Problem definition: We investigate surge pricing in ride-hailing platforms from a temporal perspective, highlighting strategic behavior by riders and drivers and that drivers respond to surge pricing much more slowly than riders do. Academic/practical relevance: Surge pricing in ride-hailing platforms is a pivotal and controversial subject. Despite abundant anecdotal evidence, strategic behavior by riders and drivers has not been formally studied in the literature. Methodology: We adopt and analyze a classic two-period, game-theoretical model as in the strategic consumer literature. Results: We identify two types of equilibrium pricing strategies. The first consists of a short-lived, sharp price surge followed by a lower price, which we refer to as skimming surge pricing (SSP). The second consists of a low initial price followed by a higher price, which we refer to as penetration surge pricing (PSP). We find that PSP equilibria are generally superior to SSP equilibria when both exist but require platforms to share demand–supply information with drivers. Managerial implications: The SSP equilibrium rationalizes the controversial sharp surge-pricing practice: the short-lived sharp price surge causes many high-value riders to voluntarily wait out the initial surge period, which attracts additional drivers to the region to serve riders at a much lower price than the initial surge price. The theoretically superior PSP equilibrium suggests that a vastly different approach may improve surge pricing and highlights the potential value and importance for platforms to share demand–supply information with drivers.</p><p><br  /></p><p>参考文献：Bin Hu, Ming Hu, Han Zhu. Surge Pricing and Two-Sided Temporal Responses in Ride Hailing. Manufacturing &amp; Service Operations Management, 2021, 24(1):91-109.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">7. 按需服务平台中的劳动福利</span></strong></p><p><br  /></p><p>问题定义：按需服务平台依赖于独立的工作人员（代理），他们决定在平台上投入多少时间（如果有的话）。一些劳工倡导者认为，劳动力储备的扩大会降低工资和代理人的利用率（例如，代理人忙于服务客户的时间的比例），从而损害到代理人的利益。出于对代理人福利的关注，监管机构正在考虑采取减少劳动力储备的规模，或对名义工资和有效工资（即名义工资和代理人利用率的乘积）施加下限的措施。劳动力储备规模的扩张真的伤害了代理吗? 哪种最低工资规定更可取? 设定最低工资标准是否伤害了消费者的利益? 学术/实践相关性：由于不具备传统保护的独立代理人的工作旨在确保雇员的福利，因此代理人的福利确实是一个重要问题。方法：我们采用了一个均衡模型，该模型解释了价格、工资、劳动力供应、客户延迟和需求之间的相互作用。结果：平均的劳动福利随劳动力储备规模的增大而先增大后减小；即，当且仅当劳动力储备的规模足够大时，代理人会受到劳动力储备规模扩大而带来的伤害。有效的最低工资标准在劳动福利最大化方面优于名义工资的最低标准。更概括地说，这两种最低工资在结构上对劳动福利都有影响，只是当名义工资的最低标准足够小时，才会对代理人有利。传统观点认为，有效的最低工资会伤害消费者（由于工资的上涨压力、更长的延迟以及代理人利用率的上升压力，他们面临更高的价格）。与此相反，消费者实际上是受益的。管理启示：管理者、劳工倡导者、平台管理者和代理人从理解创造和破坏劳工福利的力量中受益。</p><p><br  /></p><p>Problem definition: An on-demand service platform relies on independent workers (agents) who decide how much time, if any, to devote to the platform. Some labor advocates have argued that an expansion of the labor pool hurts agents—by reducing the wage and agent utilization (i.e., the fraction of time an agent is busy serving customers). Motivated by concern for agent welfare, regulators are considering measures that reduce the labor pool size or that impose a floor on the nominal wage or effective wage (i.e., the product of the nominal wage and agent utilization). Are agents indeed hurt by an expansion in the labor pool size? Which type of wage-floor regulation is preferable? Are consumers hurt by the imposition of a wage floor? Academic/practical relevance: Because independent agents work without the traditional protections intended to ensure the welfare of employees, the welfare of those agents is an important concern. Methodology: We employ an equilibrium model that accounts for the interaction among price, wage, labor supply, customer delay, and demand. Results: Average labor welfare increases and then decreases in the labor pool size; that is, agents are harmed by an expansion in the labor pool size if and only if the labor pool size is sufficiently large. The effective wage floor is superior to the nominal wage floor in terms of labor welfare maximization. More generally, the two types of wage floors have structurally different effects on labor welfare, with a floor on the nominal wage only beneficial to agents if it is sufficiently small. Contrary to the conventional view that consumers are hurt by an effective wage floor (because they face a higher price, due to upward pressure on the wage, and longer delay, due to upward pressure on agent utilization), consumers actually benefit. Managerial implications: Regulators, labor advocates, platform managers, and agents benefit from understanding the forces that create and destroy labor welfare.</p><p><br  /></p><p>参考文献：Saif Benjaafar, Jian-Ya Ding, Guangwen Kong, Terry Taylor. Labor Welfare in On-Demand Service Platforms. Manufacturing &amp; Service Operations Management, 2021, 24(1):110-124.</p><p><br  /></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-backh="386" data-backw="579" data-ratio="0.668" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRHcMwYZIzicf2NSkk90c4t0Jaoy647OPyg1wCQiavnJONMEVZjfnVykcIhksrCvHicgN6qZ59Bj4ORibA/640?wx_fmt=jpeg" data-type="jpeg" data-w="750" style="width: 100%;height: auto;"  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">8. 动态类型匹配</span></strong></p><p><br  /></p><p>问题定义：我们以周期性回顾的方式研究了一个中介问题，即异构类型的供需动态匹配问题。具体来说，存在有两种不相关的需求和供给类型，每种需求和供给类型的可能匹配都会产生奖励。在每一周期，各种类型的需求和供给随机产生。考虑到不匹配的需求和供给可能会产生等待或持有成本，并将全部或部分结转到下一阶段，平台旨在决定最优的匹配策略，以使期望总折扣回报最大化。学术/实践相关性：该问题对于共享经济中诸多涉及到匹配的中介是至关重要的。方法：我们将问题描述为一个动态过程。我们探讨最优策略的结构性质，并提出启发式策略。结果：我们给出了匹配奖励的充分条件，使最优匹配策略在可能的匹配对之间遵循一个优先级层次结构。我们发现，当质量和距离分别决定优先级时，垂直和单向水平区分类型满足于这些条件。管理启示：优先属性简化了一个周期内的匹配决策，而权衡会归为当前周期和未来周期的匹配之间的选择。此外，在优先级层次中考虑特定的供需对时，最优匹配策略具有向下匹配结构。</p><p><br  /></p><p>Problem definition: We consider an intermediary’s problem of dynamically matching demand and supply of heterogeneous types in a periodic-review fashion. Specifically, there are two disjoint sets of demand and supply types, and a reward for each possible matching of a demand type and a supply type. In each period, demand and supply of various types arrive in random quantities. The platform decides on the optimal matching policy to maximize the expected total discounted rewards, given that unmatched demand and supply may incur waiting or holding costs, and will be fully or partially carried over to the next period. Academic/practical relevance: The problem is crucial to many intermediaries who manage matchings centrally in a sharing economy. Methodology: We formulate the problem as a dynamic program. We explore the structural properties of the optimal policy and propose heuristic policies. Results: We provide sufficient conditions on matching rewards such that the optimal matching policy follows a priority hierarchy among possible matching pairs. We show that those conditions are satisfied by vertically and unidirectionally horizontally differentiated types, for which quality and distance determine priority, respectively. Managerial implications: The priority property simplifies the matching decision within a period, and the trade-off reduces to a choice between matching in the current period and that in the future. Then the optimal matching policy has a match-down-to structure when considering a specific pair of demand and supply types in the priority hierarchy.</p><p><br  /></p><p>参考文献：Ming Hu, Yun Zhou. Dynamic Type Matching. Manufacturing &amp; Service Operations Management, 2021, 24(1):125-142.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">9. 集中或分散转移价格：一种改进供应链协调的行为方法</span></strong></p><p><br  /></p><p>问题定义：我们研究转运情况下的供应链协调问题。我们使用集中和分散的转移价格作为增加供应链协调的方式。学术/实践相关性：转运能力可以通过改善供需之间的匹配来提高渠道效率。我们研究了人类决策者在该情况下的行为，并为改善协调提供了清晰的见解。方法：我们使用有经济激励的人类主体构成的可控室内实验。我们研究了在分散和集中转移价格两种情形下的一组临界比率。在分散转移价格情形下，零售商通过协商确定转移价格。在集中转移价格情形下，我们采用了两种不同的定价方法：理论定价和行为定价。这两种方法给出了相反的建议。结果：分析表明，最优转移价格应取决于临界比率；但分散情形下的结果表明，参与者在定价时似乎忽略了关键比例，而专注于将转移单位的潜在利润分成两半。不过，转移价格与订购决策之间存在着正相关关系。此外，通过推广拉动中心效应，我们发现主体并为下可以协调供应链的订单。对于集中情形，我们发现与分散环境相比，使用理论方法不能协调排序决策，也不能改进决策。行为分析方法表明，当临界比率较高时，转移价格接近于产品售价；当临界比率低时，转移价格低于产品成本。这些建议都可用于协调排序决策。管理启示：我们从研究中得出两个实践结论：第一，转运无疑是有益的，可以带来更高的利润，当其可行时应该予以鼓励；第二，可以的话，应该选择集中定价，但要考虑到主体的行为。否则，价格谈判可能会带来更好的表现。</p><p><br  /></p><p>Problem definition: We study supply chain coordination in a setting with transshipment. We use centralized and decentralized transfer prices as a way to increase supply chain coordination. Academic/practical relevance: The ability to transship can improve channel efficiency by improving the match between supply and demand. We study how human decision makers behave in this setting and provide clear insights to improve coordination. Methodology: We use controlled laboratory experiments with financially incentivized human subjects. We study a broad set of critical ratios under both decentralized and centralized transfer-price settings. In the decentralized transfer-price setting, retailers negotiate a transfer price. In the centralized transfer-price setting, we use two different approaches: theoretical and behavioral transfer price. Both approaches suggest opposite recommendations. Results: Analytically, the optimal transfer price should depend on the critical ratio; but results from the decentralized setting show that participants set prices as if they ignore the critical ratio and instead focus on splitting potential profit from transshipped units in half. However, there is a positive relationship between transfer prices and ordering decisions. Moreover, generalizing the pull-to-center effect, we find that subjects do not place orders that coordinate the supply chain. For the centralized setting, we find that using the theoretical approach does not coordinate ordering decisions and does not improve decisions compared with the decentralized setting. The behavioral approach suggests a transfer price close to product selling price for a high critical ratio and a transfer price below product cost for a low critical ratio. These recommendations lead to coordinating ordering decisions. Managerial implications: We draw two practical conclusions from our research. First, transshipments are unambiguously beneficial, resulting in higher profitability, and, when feasible, should be encouraged. Second, when possible, transfer prices should be set centrally but taking into account subjects’ behavior. Otherwise, price negotiation might lead to better performance.</p><p><br  /></p><p>参考文献：Elena Katok, Sebastián Villa. Centralized or Decentralized Transfer Prices: A Behavioral Approach for Improving Supply Chain Coordination. Manufacturing &amp; Service Operations Management, 2021, 24(1), 143-158.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><span style="color: rgb(255, 76, 65);"><strong>10. 假冒产品对全球供应链的影响</strong></span></p><p><br  /></p><p>问题定义：本文研究了假冒产品如何影响全球供应链，以及供应链应如何有效地采取反假冒行动。学术/实践相关性：假冒产品对全球供应链的影响日益加深。当供应链成员为自己的利益行事时，理解假冒如何影响供应链是一个重要问题；而当所有成员都能为其做贡献时，供应链如何能有效地打击假冒。这是第一篇对这些重要问题提出见解的文章。特别地，我们研究了供应链成员中谁最适合进行反假冒活动、成员如何在反假冒活动中合作，以及反假冒行动对供应链、企业个体、消费者剩余和社会福利具有的经济影响。方法：考虑由制造商和零售商组成的供应链，通过分析一个博弈理论框架得出供应链均衡。结果：制造商更倾向于诱导零售商打击假货，而不是自己打击假货。与传统观点相反，即使在没有网络外部性效应的情况下，假冒也能增加供应链的利润。关键在于，制造商通过降低批发价格来激励零售商进行打击，因此假冒产品的威胁可以缓解双重边缘化，而使供应链受益。管理启示：我们的研究结果表明，可持续性风险可以触发供应链成员的合作，从而有利于供应链。调查结果还强调了零售商在防伪方面应发挥的重要作用。特别是，制造商不执行打击措施，或与零售商联合或自己单独，这可能符合供应链的利益。</p><p><br  /></p><p>Problem definition: This paper investigates how counterfeits influence a global supply chain and how the supply chain should effectively take anticounterfeit actions. Academic/practical relevance: The impacts of counterfeiting have been increasingly profound on global supply chains. It is critical to understand how counterfeiting impacts supply chains when supply chain members act in their own interests, and how supply chains can effectively combat counterfeiting when all the members can contribute to it. This is the first paper that offers insights into these important questions. In particular, we examine who among the supply chain members is in the best position to perform counteracting activities, how these members can cooperate in anticounterfeiting, and what economic implications the anticounterfeit actions have to the supply chain, individual firms, consumer surplus, and social welfare. Methodology: We consider a supply chain consisting of a manufacturer and a retailer, and analyze a game-theoretical framework to derive the equilibrium. Results: The manufacturer prefers to induce the retailer to combat counterfeits rather than to combat itself. Contrary to conventional wisdom, counterfeits can increase the supply chain’s profit even in the absence of network externality effects. The crux is that the manufacturer lowers wholesale price to incentivize the retailer’s counteraction and, consequently, the threat of counterfeits can mitigate double marginalization and benefit the supply chain. Managerial implications: Our results demonstrate that a sustainability risk can trigger collaborative endeavors of supply chain members and thus be advantageous to the supply chain. The findings also underscore the important role that retailers should play in anticounterfeiting. Particularly, it can be in the supply chain’s interest that the manufacturer does not execute the counteraction, either jointly with the retailer or by itself.</p><p><br  /></p><p>参考文献：Zelong Yi, Man Yu, Ki Ling Cheung. Impacts of Counterfeiting on a Global Supply Chain. Manufacturing &amp; Service Operations Management, 2020, 24(1), 159-178.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">11. 相关随机收益率下不可靠供应商的采购策略</span></strong></p><p><br  /></p><p>问题定义：本文研究了垄断企业从多个不可靠供应商采购以满足其确定的/依赖于价格的需求的采购问题。供应商的生产过程是不可靠的，是用相关比例的随机产量来刻画的。学术/实际相关性：作为一种主动的风险缓解工具，供应多样化已在文献中得到广泛研究，主要聚焦于独立供应风险。然而，由于各种原因，供应风险在实践中可能在本质上是相互关联的。通过考虑供应商生产过程中的产量相关性，我们试图帮助企业更好地管理其供应基础，并利用多样性充分探索分担风险的益处。方法：随机优化是我们使用的主要分析工具。结果：在一般的n-供应商情形下，我们建立模型并证明其结构特性。对于两个供应商的情形，我们充分刻画了企业的最优采购决策，并提供了一个统一的度量来量化产量相关性和特征如何共同影响供应基础的选择。具体来说，当两个供应商高度正相关时，企业可能会从具有较高有效采购成本（每预期交付单位的采购成本）和较高可靠性的供应商处进行单独采购。此外，随着产量变得愈发正相关时，供应多样化变少，而企业利润也随之减少。而且，当假设产量多元正态分布时，我们将这些结果和相关见解推广到了多供应商的情形。我们揭示了产量相关性的重要作用，并说明了仅使用有效的采购成本来衡量供应商是不充分的。最后，我们考虑了需求不确定性以证实结论的稳健性。管理启示：当产量风险相关时，我们提醒谨慎选择最佳的供应基础。特别地，产量相关性、有效采购成本和供应商可靠性应一并考虑；否则，忽略这些因素中的任何一个都可能导致次优结果。</p><p><br  /></p><p>Problem definition: This paper studies the sourcing of a monopoly firm that procures from multiple unreliable suppliers to meet its deterministic/price-dependent demand. The suppliers’ production processes are unreliable and are modeled by correlated proportional random yields. Academic/practical relevance: As a proactive risk-mitigation tool, supply diversification has been widely studied in the literature, with the primary focus on independent supply risks. However, supply risks in practice may be correlated in nature for various reasons. By accounting for yield correlation among suppliers’ production processes, our work aims to help firms better manage their supply base and fully exploit the benefit of risk pooling through diversification. Methodology: Stochastic optimization serves as our main tool for analysis. Results: We formulate the firm’s problem in a general n-supplier setting and prove its structural properties. For a two-supplier case, we fully characterize the firm’s optimal sourcing decision and provide a unified measurement to quantify how yield correlation and characteristics jointly affect the supply base selection. Specifically, we show that when the two suppliers are highly positively correlated, the firm may sole-source from the supplier with higher effective procurement cost (the procurement cost per expected delivered unit) and also higher reliability. In addition, as the production yields become more positively correlated, supply diversification becomes less likely, and the firm’s profit decreases. Moreover, assuming multivariate normally distributed yields, we generalize those results and relevant insights to the multiple-supplier case. We uncover the critical role played by yield correlation and illustrate the insufficiency of using effective procurement cost alone to qualify a supplier. Finally, we incorporate demand uncertainty to confirm the robustness of our findings. Managerial implications: Our results urge caution in selecting the optimal supply base when the yield risks are correlated. Particularly, yield correlation, effective procurement costs, and supplier reliability should be jointly taken into account; otherwise, ignoring any one of these factors may lead to suboptimal outcomes.</p><p><br  /></p><p>参考文献：Lingxiu Dong, Xin Geng, Guang Xiao, Nan Yang. Procurement Strategies with Unreliable Suppliers Under Correlated Random Yields. Manufacturing &amp; Service Operations Management, 2021, 24(1):179-195.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">12. 响应定价的零售商从面临供应中断的竞争供应商处采购</span></strong></p><p><br  /></p><p>问题定义：我们研究了零售商的一个问题，该零售商从竞争的战略供应商处订购时受制于独立的或相关的中断，通过设定送货时的零售价格作为对应策略，称其为响应定价。供应商在纳什博弈中设定批发价。学术/实践相关性：供应商中断相关性存在的原因包括产品和服务设计、地理邻近性和常见的二级供应商。实践中，诸多零售商都能够在知道发货数量后确定产品价格。方法：我们将该问题建模为Stackelberg-Nash博弈，供应商为领导者，零售商为追随者，并推得均衡。我们对供应商的生产成本、可靠性及其相关性进行了敏感性分析。结果：我们惊奇地发现，供应商可靠性的提高反而对它不利，这与我们的直觉相反，因为竞争存在于向响应定价的零售商销售产品的供应商之间。此外，与已有文献相反，我们发现在响应式定价下，高中断相关性可能有利于具有成本优势的供应商，且由于供应商竞争，该相关性下的总订货量可能会增加。管理启示：本文对不可靠供应商具有重要启示，因为可靠性和相关性对其利润的影响取决于零售商的定价能力和供应商之间的竞争强度。对于一个响应定价的零售商，供应商可能不会从更高的可靠性中获益，但可能会从更高的相关性中受益。这表明一个低成本的供应商服务响应价格的零售商可以创建呈正相关的供应网络来增加其决策工具，即通过在其竞争对手的地理位置上建厂或从同一二级供应商处进行采购，以从战略上增加相关性。</p><p><br  /></p><p>Problem definition: We study a problem of a retailer that orders from competing strategic suppliers subject to independent or correlated disruptions and responds by setting the retail price on delivery, called responsive pricing. The suppliers set their wholesale prices in a Nash game. Academic/practical relevance: Supplier disruption correlation exists for reasons such as product and service designs, geographic proximity, and common tier 2 suppliers. In practice, many retailers are able to set the product price after knowing the delivered quantity. Methodology: We model this problem as a Stackelberg–Nash game with the suppliers as the leaders and the retailer as the follower and obtain its equilibrium explicitly. We perform sensitivity analyses with respect to suppliers’ production costs, reliabilities, and their correlation. Results: We find, surprisingly, that an increase in the reliability of a supplier may, counter to our intuition, hurt it because of the competition between the suppliers selling to a responsive-pricing retailer. Furthermore, in contrast to the literature, we find that under responsive pricing, a high disruption correlation may benefit a supplier that has a cost advantage, and the total order quantity may increase in that correlation because of supplier competition. Managerial implications: This paper has important implications for unreliable suppliers because the way reliability and correlation influence their profits depends on the retailer’s pricing power and the competition intensity between the suppliers. With a responsive-pricing retailer, a supplier may not benefit from higher reliability but may benefit from a higher correlation. This suggests that a low-cost supplier serving a responsive-pricing retailer could add to its decision-making tools a new incentive of creating a positively correlated supply network by building plants in the geographic location of its competitor or sourcing from the same tier 2 supplier to obtain an increased correlation strategically.</p><p><br  /></p><p>参考文献：Xi Shan, Tao Li, Suresh P. Sethi. A Responsive-Pricing Retailer Sourcing from Competing Suppliers Facing Disruptions. Manufacturing &amp; Service Operations Management, 2021, 24(1):196-213.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">13. 技术许可与生产率增长：来自发展中经济体制造业企业的证据</span></strong></p><p><br  /></p><p>问题定义：本研究探讨了技术许可和短期生产率增长之间的关系是否以及如何受到发展中经济体企业经营所处环境中固有的挑战和约束的影响。为此我们调查了正式的员工培训计划在企业中的调节作用，以及企业外部环境中的腐败水平和基础设施约束水平。学术/实用的相关性：尽管发展中经济体制造企业采用外国技术的目的往往是为了在长期内增强其能力，但以往的研究对技术许可在短期内的绩效后果提供了有限的理解，这是一个重要的企业现状。我们的研究旨在弥补研究和实践中的这一重要差距。方法：利用匹配和固定效应回归对世界银行的多行业数据集进行实证分析。我们分析了来自南亚和东亚25个发展中经济体的16000多家制造企业的企业层面的详细信息。为了加强因果推断，我们的分析处理了选择偏差和未观察到的异质性。结果：我们的结果表明，发展中经济体制造业企业采用外国技术对企业运营具有显著的短期破坏性影响，这些企业的生产率增长相比于未使用外国技术许可的企业下降了4.5个百分点。我们发现，正式的劳动力培训计划减弱了技术许可和生产率增长之间的负相关关系。然而，外部商业环境中的基础设施限制放大了这种负面关系。有趣的是，我们的研究结果表明，企业外部环境中的腐败行为是一种“有效的润滑剂”，可以减弱技术许可对生产率增长的负面影响。管理启示：我们的结论对于技术许可在短期内对生产率增长的破坏性影响提供了令人信服的证据。此外，这些结论为发展中经济体的制造业企业和决策者对于如何减轻这些负面影响提供了决策参考。</p><p><br  /></p><p>Problem Definition: This study examines whether and how the relationship between technology licensing and productivity growth in the short run is affected by the challenges and constraints inherent in the contexts in which developing economy firms operate. We do so by investigating the moderating role of formal workforce training program in a firm and the corruption level and the infrastructural constraint level in the firm's external environment. Academic/Practical Relevance: Although the adoption of foreign technology by developing economy manufacturing firms is often driven by the goal to strengthen their capabilities in the long run, prior research provides a limited understanding of the performance consequences of technology licensing in the short run, which is an important business reality. Our study serves to address this important gap in research and practice. Methodology: The empirical analyses are conducted using matching and fixed-effects regression on a multi-industry dataset from the World Bank. We analyze detailed firm-level information from over 16,000 manufacturing firms across 25 developing economies in South Asia and East Asia. To strengthen causal inference, our analyses address selection bias and unobserved heterogeneity. Results: Our results indicate that the adoption of foreign technology by developing economy manufacturing firms has a substantial short-run disruptive effect on firm operations with productivity growth declining by 4.5 percentage points in these firms relative to comparable firms that do not use foreign technology licensing. We find that formal workforce training programs attenuate the negative relationship between technology licensing and productivity growth. However, infrastructural constraints in the external business environment amplify this negative relationship. Intriguingly, our results suggest that corruption in the firm's external environment acts as an “efficient grease,” attenuating the negative impact of technology licensing on productivity growth. Managerial Implications: Our results provide compelling evidence regarding the disruptive effects of technology licensing on productivity growth in the short run. Furthermore, these results offer insights for manufacturing firms and policymakers in developing economies on how to mitigate these negative effects.</p><p><br  /></p><p>参考文献：Arzi Adbi, Xiaojin Liu, Anant Mishra. Technology Licensing and Productivity Growth: Evidence from Manufacturing Firms in Developing Economies. Manufacturing &amp; Service Operations Management, 2021, 24(1):214-234.</p><p><br  /></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">14. 协调流感疫苗供应链的双边激励计划</span></strong></p><p><br  /></p><p>问题定义：美国流感疫苗供应链是分散的，而且经常出现供需不匹配的情况，这主要是由两个关键因素造成的：(1)疫苗生产过程（产量）高度不确定；(2)个体是自利的，不会完全考虑他们强加于他人的正外部性和负外部性。为了改善供给和需求的匹配，我们提出预先中性预算激励计划来抵消这些因素。学术/实践相关性：我们确定了导致流感疫苗供应链无效率的源头。为了消除无效率，我们提出了一项双边激励方案，决策者在事先平衡的预算下为疫苗提供资金。方法：我们将流感疫苗供应链建模为一个分散的系统，该系统由需求方的自利个体和供给方的不确定产量的利润最大化制造商组成。我们使用逆向归纳法来描述序列博弈的子博弈完美均衡，该博弈模拟了个体与制造商之间的相互作用。结果：我们提出了一个双边激励方案，建议在需求方向个人提供“疫苗接种激励”，并在供应方向社会计划者和制造商提供“转移支付菜单”。当实现的疫苗供应高（或低）时，我们的激励方案为个人提供积极（消极）的疫苗接种激励，通过使疫苗接种更易负担（或更昂贵）来刺激（或抑制）需求并消除积极（或消极）外部性。当疫苗接种的社会效益显著增高时，我们的激励方案利用转移支付菜单来惩罚（或补贴）低（或高）产量的制造商，以使其生产社会最优产量。我们证明了所提的激励方案能够达到社会最优，保持事前预算平衡（即预期预算中性），并在个体和制造商之间任意分配最大的社会福利。管理启示：对个人的疫苗接种激励措施可以确保他们获得疫苗，但并不足以诱使制造商确保疫苗的供应。通过产量实现合同可以为制造商提供必要的激励，以确保了其可用性。</p><p><br  /></p><p>Problem definition: The U.S. influenza (flu) vaccine supply chain is decentralized and experiences frequent supply and demand mismatches caused by two key factors: (1) the vaccine production process (yield) is highly uncertain; and (2) individuals are self-interested and do not completely take into account positive and negative externalities that they impose on others. To improve matching of supply and demand, we counteract these factors by developing an ex ante budget-neutral incentive program. Academic/practical relevance: We establish the sources of inefficiency in the flu vaccine supply chain. To eliminate the inefficiency, we develop a two-sided incentive program that policymakers can implement to finance vaccines under an ex ante balanced budget. Methodology: We model the flu vaccine supply chain as a decentralized system consisting of self-interested individuals on the demand side, and a profit-maximizing manufacturer with uncertain yield on the supply side. We use backward induction to characterize the subgame-perfect equilibrium of the sequential game that models the interactions between individuals and the manufacturer. Results: We develop a two-sided incentive program that proposes “vaccination incentives” to be given to individuals on the demand side, and “a menu of transfer payments” between the social planner and manufacturer on the supply side. When the realized vaccine supply is high (or low), our incentive program provides positive (negative) vaccination incentives for individuals to stimulate (or curb) the demand and eliminate positive (or negative) externalities by making vaccination more affordable (or costly). When social benefits from vaccination are significantly high, our incentive program uses a menu of transfer payments to penalize (or subsidize) the manufacturer for low (or high) yield realizations so that it produces the socially optimal quantity. We show that our incentive program can attain the social optimum, maintain an ex ante balanced budget (i.e., budget-neutral in expectation), and distribute the maximum social welfare between individuals and the manufacturer arbitrarily. Managerial implications: Vaccination incentives to individuals can ensure their access to the vaccine, but they are not enough to entice the manufacturer to ensure vaccine availability. A menu of contracts contingent on realized yield provides necessary incentives to the manufacturer and assures the availability.</p><p><br  /></p><p>参考文献：Kenan Arifoğlu, Christopher S. Tang. A Two-Sided Incentive Program for Coordinating the Influenza Vaccine Supply Chain. Manufacturing &amp; Service Operations Management, 2021, 24(1):235-255.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">15. 免费游戏中的激励行为</span></strong></p><p><br  /></p><p>问题定义：游戏是娱乐产业中增长最快的领域。免费游戏是游戏中发展最快的部分。免费模式背后的理念是吸引大量的玩家，而这些玩家将永远不会在游戏中花钱。当游戏发行商无法直接从消费者口袋中赚取收益时，他们便会使用其他能够创造收益的内容，例如广告。玩家可能会对创收内容感到厌烦。最近的一项创新是为玩家提供与此类内容互动的奖励，如点击广告或观看视频。这些被称为激励行为。我们研究了激励行动的最优部署。学术/实践相关性：移除或添加激励行动基本上可以实时完成。因此，对游戏设计师来说，激励行为的部署是一个战术和运作问题。方法：将部署问题建模为马尔可夫决策过程(MDP)。我们研究了简单策略的性能，以及最优策略的结构。我们使用专有的数据集来校准我们的MDP并得到了一些见解。结果：同类行为（即激励行为分散玩家在app购买的程度）是决定如何使用刺激行为的关键参数。如果同类行为的比例足够高，提供激励行为永远不会是最佳选择。如果同类行为的比例足够低，提供激励行为总是最佳选择。我们找到了阈值策略最优性的充分条件，即为参与率低的用户提供激励行动，然后在用户参与率足够高时将其移除。管理启示：本研究将运营管理理论引入游戏产业一类新的运营问题中。游戏产业的管理者可以了解什么时候激励行为更有效或无效。游戏设计师可以使用我们的MDP模型来制定部署激励行为的数据驱动决策。</p><p><br  /></p><p>Problem definition: Games are the fastest-growing sector of the entertainment industry. Freemium games are the fastest-growing segment within games. The concept behind freemium is to attract large pools of players, many of whom will never spend money on the game. When game publishers cannot earn directly from the pockets of consumers, they employ other revenue-generating content, such as advertising. Players can become irritated by revenue-generating content. A recent innovation is to offer incentives for players to interact with such content, such as clicking an ad or watching a video. These are termed incentivized (incented) actions. We study the optimal deployment of incented actions. Academic/practical relevance: Removing or adding incented actions can essentially be done in real-time. Accordingly, the deployment of incented actions is a tactical, operational question for game designers. Methodology: We model the deployment problem as a Markov decision process (MDP). We study the performance of simple policies, as well as the structure of optimal policies. We use a proprietary data set to calibrate our MDP and derive insights. Results: Cannibalization—the degree to which incented actions distract players from making in-app purchases—is the key parameter for determining how to deploy incented actions. If cannibalization is sufficiently high, it is never optimal to offer incented actions. If cannibalization is sufficiently low, it is always optimal to offer. We find sufficient conditions for the optimality of threshold strategies that offer incented actions to low-engagement users and later remove them once a player is sufficiently engaged. Managerial implications: This research introduces operations management academics to a new class of operational issues in the games industry. Managers in the games industry can gain insights into when incentivized actions can be more or less effective. Game designers can use our MDP model to make data-driven decisions for deploying incented actions.</p><p><br  /></p><p>参考文献：Lifei Sheng, Christopher Thomas Ryan, Mahesh Nagarajan, Yuan Cheng, Chunyang Tong. Incentivized Actions in Freemium Games. Manufacturing &amp; Service Operations Management, 2020, 24(1):275-284.</p><p><br  /></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-backh="320" data-backw="480" data-ratio="0.6666666666666666" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRHcMwYZIzicf2NSkk90c4t0JicDVFZcWUzZDmicpmI4qOnCcNUDO6cH1cvCVJibx93LPw9CbBvO3QY5yw/640?wx_fmt=jpeg" data-type="jpeg" data-w="480" style="width: 100%;height: auto;"  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">16. 网易云音乐数据</span></strong></p><p><br  /></p><p>本文描述了网易云音乐的印象/显示数据以及对应的用户、创作者和音乐内容的卡片数据。本数据集由INFORMS收益管理和定价(RMP)部门和网易云音乐共同提供，以支持运营管理的数据驱动研究。该数据包含从2019年11月1日至2019年11月30日向2085,533名随机样本用户所推荐的超过5700万次音乐内容卡片的印象/展示。对于每一印象，数据可以提供相应的用户活动，如点击、喜欢和关注。此外，数据集还包含关于印象示例中的每个用户、每个内容创建者和每条内容的信息。</p><p><br  /></p><p>This paper describes the impression/display data and corresponding user, creator, and music content card data from NetEase Cloud Music. This data set is collectively supplied by the Revenue Management and Pricing (RMP) section of INFORMS and NetEase Cloud Music to support data-driven research in operations management. The data contain more than 57 million impressions/displays of music content cards recommended to a random sample of 2, 085, 533 users from November 1, 2019 to November 30, 2019. For each impression, the data provide the corresponding user activities, such as clicks, likes, and follows. Moreover, the data set also contains information on each user, each content creator, and each content in the impression sample.</p><p><br  /></p><p>参考文献：Dennis J. Zhang, Ming Hu, Xiaofei Liu, Yuxiang Wu, Yong Li. NetEase Cloud Music Data. Manufacturing &amp; Service Operations Management, 2020, 24(1):275-284.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">17. 啤酒游戏的深度Q-网络：库存优化的深度强化学习</span></strong></p><p><br  /></p><p>问题定义：啤酒游戏广泛应用于供应链管理课程中，以证明牛鞭效应和供应链协调的重要性。该游戏是一个分散的、多主体、协同问题，可以将其建模为一个连续的供应链网络。在这个网络中，虽然每个主体只能观察局部信息，但主体可以选择订单量并且可以合作以实现网络总成本的最小化。学术/实践相关性：在某些条件下，基础库存补充政策是最优的。然而，在一些主体非理性行动的分散供应链中，没有已知的可以让主体实现最优行动的最优策略。方法：我们提出了一种深度强化学习(RL)算法进行啤酒游戏。我们的算法对成本或其他设置没有任何假设。与任何的深度RL算法一样，训练是计算密集型的，但一旦训练，算法实时执行。我们提出了一种转移学习方法，以便为一个主体所执行的训练可以快速适应其他主体和设置。结果：当与遵循基本库存策略的队友比赛时，我们的算法可以得到接近最优的订购量。更重要的是，当其他主体使用更现实的人类订购行为模型时，所得到的订购量明显优于基础库存策略。我们在真实数据集上观察到相似的结果。敏感性分析表明，训练后的模型对成本系数的变化具有稳健性。最后，利用转移学习可以将训练时间减少一个数量级。管理启示：本文展示了人工智能应如何应用于库存优化。我们的方法可以扩展到其他供应链优化问题，特别是那些供应链合作伙伴的行为不合理或方式不可预测时。我们的RL主体被整合到一个新的在线啤酒游戏中，该游戏已经被超过4000人玩了超过17000次。</p><p><br  /></p><p>Problem definition: The beer game is widely used in supply chain management classes to demonstrate the bullwhip effect and the importance of supply chain coordination. The game is a decentralized, multiagent, cooperative problem that can be modeled as a serial supply chain network in which agents choose order quantities while cooperatively attempting to minimize the network’s total cost, although each agent only observes local information. Academic/practical relevance: Under some conditions, a base-stock replenishment policy is optimal. However, in a decentralized supply chain in which some agents act irrationally, there is no known optimal policy for an agent wishing to act optimally. Methodology: We propose a deep reinforcement learning (RL) algorithm to play the beer game. Our algorithm makes no assumptions about costs or other settings. As with any deep RL algorithm, training is computationally intensive, but once trained, the algorithm executes in real time. We propose a transfer-learning approach so that training performed for one agent can be adapted quickly for other agents and settings. Results: When playing with teammates who follow a base-stock policy, our algorithm obtains near-optimal order quantities. More important, it performs significantly better than a base-stock policy when other agents use a more realistic model of human ordering behavior. We observe similar results using a real-world data set. Sensitivity analysis shows that a trained model is robust to changes in the cost coefficients. Finally, applying transfer learning reduces the training time by one order of magnitude. Managerial implications: This paper shows how artificial intelligence can be applied to inventory optimization. Our approach can be extended to other supply chain optimization problems, especially those in which supply chain partners act in irrational or unpredictable ways. Our RL agent has been integrated into a new online beer game, which has been played more than 17,000 times by more than 4,000 people.</p><p><br  /></p><p>参考文献：Afshin Oroojlooyjadid, MohammadReza Nazari, Lawrence V. Snyder, Martin Takáč. A Deep Q-Network for the Beer Game: Deep Reinforcement Learning for Inventory Optimization. Manufacturing &amp; Service Operations Management, 2021, 24(1):285-304.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">18. 不对称信息下的最优契约</span></strong></p><p><br  /></p><p>问题定义：为了改善批发价格契约下由于激励不一致而导致供应链绩效不佳的问题，在理论上提出了协调契约。然而，测试这类契约的实验研究的一个普遍发现是，与批发定价相比，如果有的话，它们往往只产生微小的性能改进。这些研究确定了几个起作用的行为因素，但没有一项研究给出协调契约的理论解释。其中，导致契约被拒绝的公平偏好的不完全被认为是对供应链绩效最不利的唯一因素。供应链绩效是否可以通过设计允许这种信息不对称的契约来改善? 这种契约（机制）是什么样的? 学术/实践相关性：现有研究刻画了一些重要的实际案例的最优契约机制，包括供应商生产成本的私人信息、零售商的终端客户需求的私人信息。本研究在另一个重要的实际案例中解决了这一差距：当信息不对称的来源是关于公平偏好的私人信息时。方法：基本的研究方法是机制设计。结果：我们证明了最优机制由一个位于Pareto边界上的单一契约组成，并描述了供应商和零售商之间的最优利润分配。我们发现，在广泛的公平偏好下，由于私人信息而导致的效率损失是严格为正的，不过也有例外。我们还证明了最优机制可以用实践中常用和文献中广泛研究的各种契约来实现，包括最小订货量契约和两部分关税契约。管理启示：我们将关于社会偏好的大量理论和实证文献与供应链契约的研究之间建立了直接联系。由于不完全信息而导致的拒绝是实验室中观察到的契约无效的一个重要原因，因此管理者在谈判契约时应避免接受或放弃合同。相反，讨价还价的过程应该着眼于发现缔约双方对公平偏好的程度。</p><p><br  /></p><p>Problem definition: To improve the poor performance of supply chains caused by misaligned incentives under the wholesale price contract, theory proposes coordinating contracts. However, a common finding of experimental studies testing such contracts is that they tend to yield only a marginal, if any, performance improvement over wholesale pricing. These studies identify several behavioral factors that are at play but none accounted for by the theory proposing coordinating contracts. Among them, identified as the single most detrimental for the supply chain performance, is incomplete information about preferences for fairness causing contract rejections. Can the supply chain performance be improved with a contract designed allowing for this type of information asymmetry? What does this contract (mechanism) look like? Academic/practical relevance: The extant research characterized the optimal contracting mechanisms for such important practical cases as the suppliers’ private information about production cost or the retailers’ private information about the end customer demand. The present study addresses the gap in another important practical case: when the source of information asymmetry is the private information about preferences for fairness. Methodology: The underlying research method is mechanism design. Results: We prove that the optimal mechanism consists of a single contract positioned on the Pareto frontier and characterize the optimal profit split between the supplier and the retailer. We show that, under a wide range of preferences for fairness, the efficiency loss because of private information is strictly positive, but exceptions are possible. We also show that the optimal mechanism can be implemented with a variety of commonly used in practice and widely studied in academic literature contracts, including the minimum order quantity and the two-part tariff ones. Managerial implications: We establish a direct link between a large volume of theoretical and empirical literature on social preferences with the research on supply chain contracts. Because rejections that are because of incomplete information are an important cause of contract inefficiency observed in the laboratory, managers should avoid take it or leave it offers when they negotiate contracts. Instead, the bargaining process should be geared toward discovering the extent of the fairness preferences of the contracting parties.</p><p><br  /></p><p>参考文献：Valery Pavlov, Elena Katok, Wen Zhang. Optimal Contract Under Asymmetric Information About Fairness. Manufacturing &amp; Service Operations Management, 2021, 24(1):305-314.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">19. 预算、需求和供应不确定性下紧急行动的预先部署和当地采购</span></strong></p><p><br  /></p><p>问题定义：考虑到预先部署和当地采购的结合，共同满足快速发生灾难后的人道主义需求，我们提出了确定预先储备的政策。这些方案是在存在需求、预算和当地供应不确定的情况下制定的，是针对单一项目的交付。学术/实际相关性：灾难发生后的最近时期是人道主义组织必须向受益人提供救济物品的最关键时期。然而，由于诸多的未知因素，例如时间、地点和灾难的规模，供应管理是一个重大的挑战，而且这些决策是凭直觉做出的。我们所研究的特征和复杂性在已有文献中还未被研究过。方法：我们推导最优解的性质，确定精确解的方法，并确定易于实现的近似方法。结果：我们(i)描述了供给、需求和预算不确定性的相互作用，以及产品特性对最佳预先储备水平的影响；(ii)给出了预先储备是一个简单的报童方案的条件；(iii)讨论了应急基金的价值。管理启示：我们表明预算水平是最优政策的关键决定因素。当它高于一个阈值时，储备随灾难的频率和严重的程度而增加，反之亦然。当预算有限时，通过提高的预测所节省的比率在关键（非关键）项目上被放大（减弱），反映了不匹配成本和资金不足成本的相反方向效应。我们的模型还可用于估计减轻当地支出限制的举措的价值（例如，在紧急救济期间，由大捐赠者提供的信贷额度）。</p><p><br  /></p><p>Problem definition: Considering a mix of prepositioning and local purchasing, common to cover humanitarian demands in the aftermath of a rapid-onset disaster, we propose policies to determine preposition stock. These formulations are developed in the presence of demand, budget, and local supply uncertainties and for single-items delivery. Academic/practical relevance: The immediate period aftermath of a disaster is the most crucial period during which humanitarian organizations must supply relief items to beneficiaries. Yet, because of many unknowns such as time, place, and magnitude of a disaster, supply management is a significant challenge, and these decisions are made intuitively. The features and complexities we examine have not been studied in the literature. Methodology: We derive properties of the optimal solution, identify exact solution methods, and determine approximate methods that are easy to implement. Results: We (i) characterize the interplay of supply, demand, and budget uncertainties, as well as the impact of product characteristics on optimal prepo stock levels; (ii) show in what conditions the prepo stock is a simple newsvendor solution; and (iii) discuss the value of emergency funds. Managerial implications: We show that budget level is a key determinant of the optimal policy. When it is above a threshold, inventory increases in disaster frequency and severity, but the reverse is true otherwise. When budget is limited, the rate of savings from improved forecasts is amplified (attenuated) for critical (noncritical) items, reflecting opposing directional effects of mismatch cost and cost of insufficient funding. Our model can also be used to estimate the value of initiatives to mitigate constraints on local spend (e.g., a line of credit underwritten by large donors that is available during the immediate relief period).</p><p><br  /></p><p>参考文献：Mahyar Eftekhar, Jing-Sheng Jeannette Song, Scott Webster. Prepositioning and Local Purchasing for Emergency Operations Under Budget, Demand, and Supply Uncertainty. Manufacturing &amp; Service Operations Management, 2021, 24(1):315-332.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">20. 物联网与信息融合：谁在和谁说话?</span></strong></p><p><br  /></p><p>问题定义：通过物联网(IoT)连接的自主传感器由不同的公司部署在同一环境中。传感器测量一个重要的运作条件状态变量，由于它们的测量是有噪声的，所以估量是有瑕疵的。传感器可以通过收集其他传感器的估量来对自己的估量进行改进。选择与哪些传感器（目标）通信是一项挑战，这是因为传感器(1)受限于它们可以瞄准的传感器的数量，而且(2)对其他传感器如何运作只有部分了解，也就是说，不知道其他传感器的潜在推理算法/模型。我们研究了靶问题，调查了企业间传感器通信模式的演化，并探讨了驱动这些模式的因素。学术/实践相关性：诸多行业正越来越多地使用传感器通过更好的运作条件信息来推动关键性能指标（如资产正常运行时间）的改善。传感器之间将相互通信来提高估量。这种IoT愿景将对运营管理(OM)产生重大影响，OM学者需要开发和研究模型和框架以便能更好地理解传感器交互。方法：采用决策、估计、优化和学习相结合的分析模型。结果：在选择目标时，每个传感器需要考虑其他传感器的测量质量和对其推理模型的熟悉程度。我们发现环境状态在调节质量和熟悉度方面起着关键作用。当传感器的质量公开时，我们发现每个传感器最终都在一个恒定的目标集上，但是这个长期的目标集是依赖于采样路径的（即依赖于过去的状态），并且随传感器变化。然而，长期网络可以在时间零点被完全定义为一个随机有向图，因此，我们可以从概率上预测它。这种预测可以在观察状态值有限个周期后变得完美（即，网络可以以确定性的方式被识别）。当传感器的质量私有时，我们的结果表明，传感器可能不会停留在一个恒定的目标集，但它的子集仍然可以随机预测。管理启示：我们的工作可以帮助管理人员预测（和影响）传感器之间形成信息链接的其他公司的集合。类似于制造商测绘供应商基地以帮助其管理供应连续性，我们的工作能够使公司测绘基于传感器的信息供应商，以帮助其管理信息连续性。</p><p><br  /></p><p>Problem definition: Autonomous sensors connected through the internet of things (IoT) are deployed by different firms in the same environment. The sensors measure an important operating-condition state variable, but their measurements are noisy, so estimates are imperfect. Sensors can improve their own estimates by soliciting estimates from other sensors. The choice of which sensors to communicate with (target) is challenging because sensors (1) are constrained in the number of sensors they can target and (2) only have partial knowledge of how other sensors operate—that is, they do not know others’ underlying inference algorithms/models. We study the targeting problem, examine the evolution of interfirm sensor communication patterns, and explore what drives the patterns. Academic/practical relevance: Many industries are increasingly using sensors to drive improvements in key performance metrics (e.g., asset uptime) through better information on operating conditions. Sensors will communicate among themselves to improve estimation. This IoT vision will have a major impact on operations management (OM), and OM scholars need to develop and examine models and frameworks to better understand sensor interactions. Methodology: Analytic modeling combining decision-making, estimation, optimization, and learning is used. Results: We show that when selecting its target(s), each sensor needs to consider both the measurement quality of the other sensors and its level of familiarity with their inference models. We establish that the state of the environment plays a key role in mediating quality and familiarity. When sensor qualities are public, we show that each sensor eventually settles on a constant target set, but this long-run target set is sample-path dependent (i.e., dependent on past states) and varies by sensor. The long-run network, however, can be fully defined at time zero as a random directed graph, and hence, one can probabilistically predict it. This prediction can be made perfect (i.e., the network can be identified in a deterministic way) after observing the state values for a limited number of periods. When sensor qualities are private, our results reveal that sensors may not settle on a constant target set but the subset among which it cycles can still be stochastically predicted. Managerial implications: Our work allows managers to predict (and influence) the set of other firms with which their sensors will form information links. Analogous to a manufacturer mapping its supplier base to help manage supply continuity, our work enables a firm to map its sensor-based-information suppliers to help manage information continuity.</p><p><br  /></p><p>参考文献：Soroush Saghafian, Brian Tomlin, Stephan Biller. The Internet of Things and Information Fusion: Who Talks to Who?. Manufacturing &amp; Service Operations Management, 2021, 24(1):333-351.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">21. 介绍自动驾驶汽车：采用模式和对社会福利的影响</span></strong></p><p><br  /></p><p>问题定义：自动驾驶汽车(AVs)估计会在不到十年内进入消费市场。对于它们的存在是否会对用户和社会产生积极影响，目前还未达成共识。对自动化持怀疑态度的人预计会出现更严重的交通拥堵，而自动化的支持者则认为会有更顺畅的交通，从而缩短了出行时间。我们研究了关于自动化的争议，并就如何以及何时推广AVs向政策制定者提供建议。学术/实践相关性：自动驾驶汽车技术正在迅速发展，因此有必要研究其对社会福利的影响，以及公众采用该技术的可能性。方法：我们运用供需理论得到了自动驾驶家庭和普通家庭出行的均衡次数。我们提出了一个点对点AV共享的仿真模型。当家庭自主选择车辆类型时，我们比较了具有自私采用模式的自动化的社会最优水平。结果：我们确定最优社会福利受以下因素的影响：(i)网络连接，即服务AVs的基础设施的能力, (ii) AVs提供的额外的舒适性，即让乘客从事其他生产活动而不是开车，(iii) AV共享模式降低了拥有成本，但制造了增加拥堵的空车出行。管理启示：我们在多伦多的一个案例研究中调查了AVs的影响，并表明部分自动化能够最大化社会福利。我们发现，AVs的舒适性可能会增加交通流量，而损害社会福利。此外，虽然自动化会增加交通流量，但由于网络中的AV连通性能够显著改善交通流量，因此出行时间可能会是减少的。</p><p><br  /></p><p>Problem definition: Autonomous vehicles (AVs) are predicted to enter the consumer market in less than a decade. There is currently no consensus on whether their presence will have a positive impact on users and society. The skeptics of automation foresee increased congestion, whereas the advocates envision smoother traffic with shorter travel times. We study the automation controversy and advise policymakers on how and when to promote AVs. Academic/practical relevance: The AV technology is advancing rapidly and there is a need to study its impact on social welfare and the likelihood of its adoption by the public. Methodology: We use supply-demand theory to find the equilibrium number of trips for autonomous and regular households. We develop a simulation model of peer-to-peer AV sharing. We compare the socially optimal level of automation with the selfish adoption patterns where households independently choose their vehicle type. Results: We establish that the optimal social welfare is influenced by: (i) the network connectivity, that is, the ability of the infrastructure to serve AVs, (ii) the additional comfort provided by AVs that allows passengers to engage in other productive activities instead of driving, and (iii) the AV sharing patterns that reduce ownership costs, but create empty vehicle trips that increase congestion. Managerial implications: We investigate the impact of AVs in a case study of Toronto and show that partial automation maximizes social welfare. We show that the comfort of AVs may add traffic that compromises social welfare. Moreover, although traffic increases with automation, travel times may decrease because of significant improvements in traffic flow caused by AV connectivity in the network.</p><p><br  /></p><p>参考文献：Opher Baron, Oded Berman, Mehdi Nourinejad. Introducing Autonomous Vehicles: Adoption Patterns and Impacts on Social Welfare. Manufacturing &amp; Service Operations Management, 2021, 24(1):352-369.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">22. 对纳税人征税：美国联邦政府技术项目基线变化驱动因素的实证调查</span></strong></p><p><br  /></p><p>问题定义：美国联邦政府对技术项目进行了大量投资，以向公众提供必要的服务。项目的执行是根据一个基线来监视的——一个代表项目的计划预算、进度和范围的综合计划。最新的报告表明，联邦技术项目因被多次重新设定基准而导致纳税人的钱被额外支出。虽然项目的范畴经常被认为是基线变更的驱动因素，但是我们对可能影响这种关系的执行因素的理解是有限的。学术/实践相关性：随着两党对联邦政府在技术项目上的支出进行越来越多的审查，以及媒体对其执行情况的持续讨论，对联邦技术项目基线变化的驱动因素的细致入微的理解对于政策制定者和管理者都是一个关键且当代的调查方向。我们的研究也回应了运营管理最新文献中关于公共部门运营研究的呼吁。方法：研究样本包括24个联邦机构的240个美国联邦政府技术项目的详细档案数据。我们估计负二项回归规范，该规范解释了代理固定效应和一些项目特定的特征以测试关于项目的范畴、粒度、管理能力、执行方法和基线变化之间的相互关系的四个假设。结果：结果表明，项目范畴与基线改变的数量之间呈正相关关系。不过，提高项目粒度和项目管理能力的水平会减弱这种积极的关系。额外的分析强调纳税人贡献的显著节省可以通过增加项目粒度和项目管理能力的水平来减少具有更大范畴的项目的基线变化来实现。管理含义：研究结果强调，当项目范畴较大时，联邦机构需要在细化项目和指定具有高水平项目管理能力的管理人员上投入更大的努力，因为这样的努力可以减少基线变化的数量。结果还强调了基线变化数量的作用，可以作为项目管理人员和联邦机构监测联邦技术项目的执行和指定具有更大潜力的项目的一种有价值的度量。</p><p><br  /></p><p>Problem definition: The U.S. federal government makes significant investments in technology programs to deliver essential services to the public. The execution of a program is monitored against a baseline—an aggregate plan representing the program’s planned budget, schedule and scope. Recent reports suggest that federal technology programs are re-baselined multiple times, resulting in additional spending of taxpayer money. Although a program’s scope has often been considered a driver of baseline changes, we have a limited understanding of the execution factors that may affect this relationship. Academic/Practical Relevance: With increasing bipartisan scrutiny of federal spending in technology programs and continuing debate in the media about their execution, a nuanced understanding of the drivers of baseline changes in federal technology programs is a critical and contemporary line of inquiry relevant to both policymakers and managers. Our study also responds to recent calls in the operations management literature for research on public sector operations. Methodology: The study sample comprises detailed archival data on 240 U.S. federal government technology programs across 24 federal agencies. We estimate a negative binomial regression specification that accounts for agency fixed effects and several program-specific characteristics to test four hypotheses on the interrelationships between a program’s scope, granularity, management competency, execution methodology and baseline changes. Results: The results indicate that program scope is positively associated with the number of baseline changes. However, increasing levels of program granularity and program management competency attenuate this positive relationship. Additional analysis highlights the significant savings in taxpayer contributions that can occur by reducing baseline changes in programs of greater scope through an increase in the levels of program granularity and program management competency. Managerial Implications: The study results emphasize the need for federal agencies to invest greater efforts in granularizing a program and in identifying managers with high levels of program management competency when program scope is high, as such efforts can translate into a reduction in the number of baseline changes. The results also highlight the role of number of baseline changes as a valuable in-process metric for program managers and federal agencies to monitor the execution of federal technology programs and identify programs with greater potential.</p><p><br  /></p><p>参考文献：Dwaipayan Roy, Anant Mishra, Kingshuk K. Sinha. Taxing the Taxpayers: An Empirical Investigation of the Drivers of Baseline Changes in U.S. Federal Government Technology Programs. Manufacturing &amp; Service Operations Management, 2021, 24(1):370-391.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">23. 隐藏在群体中：产品召回群集现象</span></strong></p><p><br  /></p><p>问题定义：产品召回会对公司和消费者都会造成严重的后果。然而，关于公司如何管理召回的时机以及这个时机如何影响召回的财务后果，我们知之甚少。在本研究中，我们为一个之前不为人知的现象提供了证据：召回聚集，即短时间内的召回集合，在这个集合中，一次领先的召回（集群中的第一次召回）可以激发随后的召回（集群中的后续召回）。我们还研究了股票市场如何根据公司在召回集群中的位置不同而对公司进行不同的惩罚。学术/实用的相关性：通过证明汽车公司集中召回，以及市场根据召回在集群中的位置而对公司进行不同的惩罚，我们丰富了调查召回时间和股票市场事件研究的文献，并为监管汽车召回的监管机构和作出召回决定的管理者提供了指导。方法：我们首先使用激励我们的假设的动态博弈模型来进行分析预测。然后，我们使用Hawkes过程模型分析了48年来的3117起汽车召回事件来检验我们的假设得到了实证支持。当召回在一个聚集中被分类为领先和随后的召回时，Hawkes过程模型可以被用于研究事件在不同时间的自激发，而且也可以用于研究召回聚类。最后，在一个事件研究中，我们使用从Hawkes过程模型中获得的领先和随后的召回来检验召回在股票市场中的影响如何随其在集群中的位置而变化。结果：我们发现，73%的召回是集中发生的，它们是在16天的召回公告间隔后形成的。平均而言，召回聚集持续34天，包括领先召回之后宣布的7.6个随后的召回。领先的召回比随后的召回要高出67%的股市处罚。此外，我们还发现，随着领先召回时间的增加，后续召回实现的股票市场收益减弱，而领先召回面临的股票市场惩罚随着上次聚集结束时间的增加而增加。管理启示：我们的研究结果为监管汽车召回的监管机构提供了一个关键启示，证实了召回聚集的证据以及可归因于召回的潜在股市效应。我们为国家公路交通和安全管理局提供了一个成本适中的政策建议，即应该限制召回聚集。</p><p><br  /></p><p>Problem definition: Product recalls have serious consequences for firms and consumers. Little is known, however, about how firms manage the timing of recalls and how this timing influences the financial consequences of recalls. In this study, we provide evidence for a previously unknown phenomenon: recall clustering, a collection of recalls within close temporal proximity in which a leading recall (the first recall in a cluster) excites following recalls (subsequent recalls in a cluster). We also investigate how the stock market penalizes firms differently depending upon their position within the recall cluster. Academic/practical relevance: By demonstrating that auto firms cluster their recalls and that the market penalizes firms differently based on the position of a recall within a cluster, we contribute to the literature that investigates recall timing and stock market event studies and provide guidance for regulators who oversee auto recalls and managers who make recall decisions. Methodology: We first develop analytical predictions using a dynamic game theoretic model to motivate our hypotheses. We then examine empirical support for our hypotheses by analyzing 3,117 auto recalls across 48 years using a Hawkes process model. Hawkes process models are designed to examine self-excitation of events across time and can be used to investigate recall clustering, while categorizing recalls as leading or following within a cluster. Finally, we use the leading and following recall designations obtained from the Hawkes process model in an event study to examine how the stock market effects of a recall vary depending on its position within a cluster. Results: We find that 73% of recalls occur in clusters, and they form after a 16-day gap in recall announcements. On average, clusters last for 34 days and are comprised of 7.6 following recalls announced after the leading recall. Leading recalls are associated with as high as a 67% larger stock market penalty than following recalls. Further, we find that the stock market benefit realized by a following recall weakens as the time since the leading recall increases and that the stock market penalty faced by a leading recall grows as the time since the end of the last cluster increases. Managerial Implications: Our findings lead to a key implication for regulators who oversee auto recalls by demonstrating evidence of recall clustering and the underlying stock market effects that are attributable to it. We provide a cost-neutral policy recommendation for the National Highway Traffic and Safety Administration that should limit recall clustering.</p><p><br  /></p><p>参考文献：Ujjal K. Mukherjee, George P. Ball, Kaitlin D. Wowak, Karthik V. Natarajan, Jason W. Miller. Hiding in the Herd: The Product Recall Clustering Phenomenon. Manufacturing &amp; Service Operations Management, 2021, 24(1):392-410.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">24. 运营中断、企业风险和控制系统</span></strong></p><p><br  /></p><p>问题定义：运营中断会影响企业的风险，这体现在一系列运营问题上，包括更高的库存持有成本，更高的产能扩张融资成本，以及供应链合作伙伴对企业风险的更高感知。学术/实际相关性：虽然业务管理文献对中断进行了广泛研究，但关注点在于减轻对公司生产潜力的有害影响，而不是它的风险。我们研究了实施和可靠地证明有有效的内部控制系统是否会显著地影响运营中断对公司的风险和市场估值。方法：我们利用了2004年的一项监管变化，该变化要求某些公司证明其拥有适当的控制系统。我们的三重差异回归规范利用了一种监管异常，它可以排除遵守控制系统要求的一组定义明确的公司。结果：我们发现，有义务遵守这一监管要求的公司在运营中断后，其风险的增加和市场价值的下降明显较小。没有义务遵守这一要求的公司在运营中断后并没有获得这样的好处，反而面临到风险的较大增加。管理启示：对可靠的控制系统是否可以减少中断对公司风险和价值的影响的深入理解是重要的，因为它确定了一套可供业务管理人员使用的更广泛的缓解战略。这可以帮助管理人员在风险缓解举措与目标和预算限制之间实现更好的匹配。</p><p><br  /></p><p>Problem definition: Operational disruptions can impact a firm’s risk, which manifests in a host of operational issues, including a higher holding cost for inventory, a higher financing cost for capacity expansion, and a higher perception of the firm’s risk among its supply chain partners. Academic/practical relevance: Although disruptions have been studied extensively in the operations management literature, the emphasis has been on mitigating the deleterious impact on the firm’s production potential rather than its risk. We examine whether implementing and credibly attesting to having effective internal control systems will meaningfully influence the impact of operational disruptions on the firm’s risk and market valuation. Methodology: We exploit a 2004 regulatory change that required certain firms to attest to having control systems in place. Our triple-difference regression specification takes advantage of a regulatory anomaly that excluded a well-defined set of firms from complying with the control system requirement. Results: We find that firms that were obligated to comply with this regulatory requirement experienced a materially smaller increase in their risk and a smaller decrease in their market value in the aftermath of an operational disruption. Firms that were not obligated to comply with this requirement did not experience such benefits in the aftermath of a disruption and instead, experienced a larger increase in their risk. Managerial implications: Fostering a better understanding of whether credible control systems can reduce the impact of disruptions on the firm’s risk and value is important as it identifies a broader set of mitigation strategies available to operations managers. This can help managers achieve a better fit between their risk mitigation initiatives and their objectives and budget constraints.</p><p><br  /></p><p>参考文献：William Schmidt, Ananth Raman. Operational Disruptions, Firm Risk, and Control Systems. Manufacturing &amp; Service Operations Management, 2021, 24(1):411-429.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">25. 消费者选择模型下的产品价格、质量和服务决策</span></strong></p><p><br  /></p><p>问题定义：本文我们提出了一个集成的框架来研究在各种垄断和竞争情形下，企业对产品价格、质量和服务时间的联合决策。学术/实践相关性：产品价格、质量和辅助服务（如维修和工厂保修）可以说是消费者在做购买决定时所考虑的主要因素。同时，它们也被视为企业实现市场细分的有效工具。我们考虑一家企业的成本结构，其中服务成本取决于产品质量水平。特别地，若质量与产品的可靠性（依次地，复杂性）有关联，那么服务成本会随质量水平而下降（增加）。方法：我们采用广泛使用的多项logit模型和嵌套logit模型研究消费者的选择行为，并采用混合整数优化和博弈论进行分析。结果：我们发现，在提供多种可替代产品的情况下，企业在最优状态下仅提供两种最大差异化的服务时间就足够了。每一种产品的质量应设定在消费者的边际效用等于企业的边际成本的水平上，这独立于其他产品的决策，但是定价决策应该考虑到所有的产品。此外，当企业可以制定更多决策时，消费者剩余会增加。管理启示：忽视产品替代和市场竞争，每种产品的最佳质量水平和服务时间的确定都应独立于其他产品。此外，服务差异化可以使消费者受益，而且可以提高企业的盈利能力。</p><p><br  /></p><p>Problem definition: In this paper, we develop an integrated framework to study a firm’s joint decisions on product price, quality, and service duration in a variety of monopolistic and competitive scenarios. Academic/practical relevance: Product price, quality, and ancillary service (such as maintenance and factory warranty) are arguably among the most important factors consumers consider when making a purchase decision. Meanwhile, they are also seen as effective instruments for firms to achieve market segmentation. We consider a cost structure for a firm in which the service cost depends on the product quality level. In particular, if quality is associated with product reliability (respectively, complexity), the service cost would decrease (increase) in the quality level. Methodology: We adopt the widely used multinomial logit model and the nested logit model to study consumers’ choice behavior and employ mixed-integer optimization and game theory to conduct analyses. Results: We find that with multiple substitutable products being offered, it is sufficient for a firm to provide only two maximally differentiated service durations at optimality. The quality of each product should be set at a level such that the marginal utility to consumers equals the marginal cost to the firm, independent of the decisions on other products, whereas the pricing decision should take into account all products. In addition, consumer surplus increases when the firm can make more decisions. Managerial implications: Regardless of product substitution and market competition, the optimal quality level and service duration for each product can be determined independently of other products. Moreover, service differentiation can benefit consumers and improve the firm’s profitability at the same time.</p><p><br  /></p><p>参考文献：Ruxian Wang, Chenxu Ke, Shiliang Cui. Product Price, Quality, and Service Decisions Under Consumer Choice Models. Manufacturing &amp; Service Operations Management, 2021, 24(1):430-447.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">26. 阈值对消费者选择和定价决策的影响</span></strong></p><p><br  /></p><p>问题定义：本文研究了阈值对消费者考虑集形成和企业相关定价决策的影响。学术/实践相关性：在随机效用最大化选择模型中，消费者在分析所有选项的效用不确定性后选择效用最大的选项。然而，实践中由于有限理性或搜索成本的存在，消费者可能并不会检查所有可用的选项。方法：本文将有限理性纳入消费者的选择行为：在第一阶段，一位具有代表性的消费者通过剔除名义效用最大低于阈值的选项来形成其考虑集；在第二阶段，她考察了其考虑集中的所有选项，并选择具有最高实现效用的选项。结果：对于Gumbel分布随机效用，我们推导了具有考虑集的两阶段阈值多项logit模型。对于定价问题，我们证明了准同加价/同效用策略是最优的：高成本产品的定价是使其利润加成相同，而低成本产品的定价是使其名义效用相同。对于价格竞争，可能会存在0、1、2或无限的纳什均衡，这取决于阈值效应的大小。管理启示：我们的分析表明，考虑集和有限理性在消费者选择行为中起着重要的作用，因此企业在制定决策时应将其考虑在内。</p><p><br  /></p><p>Problem definition: This paper investigates the threshold effects on the consideration set formation for consumers and the associated pricing decisions for firms. Academic/practical relevance: In the class of random utility maximization choice models, consumers choose the alternative with the largest utility after resolving utility uncertainties for all options. However, in practice, consumers may not inspect all available alternatives due to bounded rationality or search cost. Methodology: This paper incorporates bounded rationality into consumer choice behavior: in the first stage, a representative consumer forms her consideration set by removing alternatives whose nominal utility is lower than the largest by a threshold; in the second stage, she examines all alternatives in her consideration set and chooses the one with the highest realized utility. Results: For the Gumbel-distributed random utilities, we derive the two-stage threshold multinomial logit model with a consideration set. For the pricing problem, we show the quasi-same-markup/same-utility policy is optimal: high-cost products charge the prices such that their profit markups are the same, and low-cost products charge prices such that their nominal utilities are the same. For the price competition, there may exist zero, one, two, or infinite Nash equilibria, depending on the magnitude of the threshold effects. Managerial implications: Our analysis shows that the consideration set and bounded rationality play an important role in consumer choice behavior, so they should be taken into account in firms’ decision making.</p><p><br  /></p><p>参考文献：Ruxian Wang. The Threshold Effects on Consumer Choice and Pricing Decisions. Manufacturing &amp; Service Operations Management, 2021, 24(1):448-466.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">27. 店铺品牌介绍和多边合同</span></strong></p><p><br  /></p><p>问题定义：我们探讨了纵向供应关系中，当两个上游国家品牌制造商(NBMs)通过一个共同的零售商进行销售时，商店品牌(SB)引入对多边合同的影响。两种不同的信息结构被深入检查：同时（秘密报价）和顺序合同（公开报价），NBMs与零售商签订合同的时间本质上是不同的。学术/实践相关性：SB产品现在很流行；但是不同类别的市场份额差异较大，可以从微不足道的销售额（如酒精饮料）到占据总销售额的一半以上（如牛奶）。随着零售商蚕食NBM的产品市场，他们的关系随之改变。因此，研究SB引入是否会颠覆多边合同的传统认知是有意义的。方法：采用的方法是非合作博弈论。结果：我们确定了一个边界均衡，在这个边界均衡中，SB的销售是可忽略的，但它的存在能够使得零售商加强上游竞争，并获得更好的批发合同。我们发现，相比同时合同，在顺序合同下这种均衡更容易于在一个更大的区域内出现。在顺序合同的边界均衡中，NBM具有先动优势，与非边界均衡中的后动优势形成鲜明对比。此外，与序列合同的唯一性相反，我们刻画了同时合同下的一个连续边界均衡，可以使对称NBM设定不对称批发价格，从而将SB逐出市场。管理启示：我们为观察到的可忽略的SBs销售提供了一个基本原理，并进一步阐明了公开报价和秘密报价之间的选择。公开报价可能会使从信息泄露中受益的零售商产生更好的绩效。在公开报价的情形下，NBM对领导层的偏好可能会被SBs逆转，这是因为SBs的销售额可以忽略不计。由于SBs对顺序合同的影响十分复杂，因此这两种方式应该进行联合分析。</p><p><br  /></p><p>Problem definition: We explore the impacts of store-brand (SB) introduction on multilateral contracting in vertical supply relationships that involve two upstream national-brand manufacturers (NBMs) selling through a common retailer. Two different information structures are scrutinized: simultaneous (secret offers) versus sequential contracting (public offers), essentially different timing by which the NBMs contract with the retailer. Academic/practical relevance: SB products are prevalent nowadays; however, the market shares in different categories vary substantially, from negligible sales (e.g., alcoholic beverages) to more than half of the total sales (e.g., milk). As retailers encroach on the NBMs’ product market, their relationships are reshaped accordingly. Thus, investigating whether SB introduction would overturn the conventional wisdom about multilateral contracting is pertinent. Methodology: The methodology is noncooperative game theory. Results: We identify a boundary equilibrium where the sale of the SB is negligible, but its presence enables the retailer to intensify the upstream competition and elicits better wholesale contracts. We show that this equilibrium tends to occur in a wider region under sequential contracting than under simultaneous contracting. In the boundary equilibrium of sequential contracting, the NBM could entail a first-mover advantage, a stark contrast to the second-mover advantage in the nonboundary equilibrium. Further, as opposed to the uniqueness of sequential contracting, we characterize a continuum of boundary equilibria under simultaneous contracting such that symmetric NBMs may even set asymmetric wholesale prices so as to drive the SB out of the market. Managerial implications: We provide a rationale for the observed negligible sales of certain SBs and further shed light on the choice between public and secret offers. Public offers could perform better for the retailer who, in turn, benefits from information leakage. With public offers, the NBMs’ preference for the leadership could also be reversed for SBs with negligible sales. Because of the intricate impact of SBs on contracting sequence, these two instruments should be jointly analyzed.</p><p><br  /></p><p>参考文献：Quan Zheng, Hongseok Jang, Xiajun Amy Pan. Store-Brand Introduction and Multilateral Contracting. Manufacturing &amp; Service Operations Management, 2021, 24(1):467-468.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">28. 非随机性对随机选择模型的影响是什么?</span></strong></p><p><br  /></p><p>问题定义：本文研究了非随机性对随机选择模型的影响，并研究了新的离散选择模型下的各种运营问题。学术/实践相关性：文献经常假设随机效用组分遵循一些独立同分布的分布。这种假设在某些现实场景中过于严苛，这是因为，例如消费者可能非常了解他们反复购买的产品的属性值。方法：我们采用了随机效用最大化框架，并刻画了当某些方案的效用确定时的选择概率。在线形效用-属性假设下，属性系数的对数似然函数为联合凹函数；我们提出了一种期望最大化算法来克服估计中数据缺失的问题。结果：令人惊讶的是，当某一特定产品的效用确定时，分类问题仍然是多项式时间可解的，而当无购买选项的效用确定时，分类优化对应的决策问题是NP完全的。我们发现价格减去价格敏感性的倒数在最优时是不随产品改变的，这一点可以用于简化多产品定价问题。管理启示：通过对真实数据的实证研究，发现将非随机性纳入随机选择模型可以提高模型拟合和预测精度。不考虑非随机性的影响可能会损失严重。</p><p><br  /></p><p>Problem definition: This paper examines the impact of nonrandomness on random choice models and studies various operations problems under the new discrete choice models. Academic/practical relevance: The literature often assumes that the random utility components follow some independent and identically distributed distribution. This assumption is too restrictive in some real-world scenarios, because, for example, consumers may have known well about the attribute values for the product that they have repeatedly purchased. Methodology: We adopt the random utility maximization framework and characterize the choice probabilities when the utility of some alternative is deterministic. The log-likelihood function is jointly concave in the attribute coefficients under the linear utility-attribute assumption; an expectation-maximization algorithm is developed to overcome the missing data issue in estimation. Results: Surprisingly, if the utility of a particular product is deterministic, the assortment problem is still polynomial-time solvable, whereas if the utility of the no-purchase option is deterministic, the decision problem corresponding to the assortment optimization is NP-complete. We show that the price minus the reciprocal of price sensitivity is product invariant at optimality, which helps to simplify the multiproduct pricing problems. Managerial implications: Empirical study on real data shows that incorporating nonrandomness into random choice models can increase model fitting and prediction accuracy. Failure of accounting for the impact of nonrandomness may result in substantial losses.</p><p><br  /></p><p>参考文献：Ruxian Wang. What Is the Impact of Nonrandomness on Random Choice Models?. Manufacturing &amp; Service Operations Management, 2021, 24(1):485-503.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">29. 非参数信息报童问题的鲁棒数据驱动方法</span></strong></p><p><br  /></p><p>问题定义：对于具有未知需求分布的标准报童问题，我们提出了一种方法使用数据输入来构造具有真实分布的非参数特征的分布模糊集的方法，并利用它制定稳健的决策。学术/实践相关性：经验方法依赖于历史数据来估计真实的分布。虽然估计分布收敛于真实分布，但在数据有限的情况下，其性能并不能得到保证。我们的方法从分布模糊集生成稳健的决策，该分布模糊集由非参数特征的数据驱动估计器构建，并包含具有期望概率的真实分布。该方法适用于数据规模较小的情形。方法：我们利用一种具有非参数信息的鲁棒优化方法。结果：在对需求支持度进行固定划分的方法下，我们构造了一个分布模糊集，建立了一条保护曲线来代表该集合中的最坏情况分布，并利用保护曲线得到了具有解析形式的鲁棒库存量。在实现方面，我们提出了一种自适应方法，通过连续地传送数据可以无偏地更新预先指定的置信水平地分区，并调整保护曲线以获得鲁棒决策。我们从理论上和实验上将所提的方法和现有的方法进行了比较。管理启示：我们在自适应划分下的非参数方法保证了实现的平均利润以较大的概率超出最坏情况下的预期利润。利用Kaggle.com的真实数据集，发现所提方法在收益率和稳定产生的利润方面要优于现有方法，而且随着服务比率的降低其优势愈发突出。在服务要求不太高的情况下，非参数信息比参数信息在利润产生中更具价值。此外，我们所提的方法提供了在鲁棒优化框架下一种结合非参数和参数信息的方式。</p><p><br  /></p><p>Problem definition: For the standard newsvendor problem with an unknown demand distribution, we develop an approach that uses data input to construct a distribution ambiguity set with the nonparametric characteristics of the true distribution, and we use it to make robust decisions. Academic/practical relevance: Empirical approach relies on historical data to estimate the true distribution. Although the estimated distribution converges to the true distribution, its performance with limited data is not guaranteed. Our approach generates robust decisions from a distribution ambiguity set that is constructed by data-driven estimators for nonparametric characteristics and includes the true distribution with the desired probability. It fits situations where data size is small. Methodology: We apply a robust optimization approach with nonparametric information. Results: Under a fixed method to partition the support of the demand, we construct a distribution ambiguity set, build a protection curve as a proxy for the worst-case distribution in the set, and use it to obtain a robust stocking quantity in closed form. Implementation-wise, we develop an adaptive method to continuously feed data to update partitions with a prespecified confidence level in their unbiasedness and adjust the protection curve to obtain robust decisions. We theoretically and experimentally compare the proposed approach with existing approaches. Managerial implications: Our nonparametric approach under adaptive partitioning guarantees that the realized average profit exceeds the worst-case expected profit with a high probability. Using real data sets from Kaggle.com, it can outperform existing approaches in yielding profit rate and stabilizing the generated profits, and the advantages are more prominent as the service ratio decreases. Nonparametric information is more valuable than parametric information in profit generation provided that the service requirement is not too high. Moreover, our proposed approach provides a means of combining nonparametric and parametric information in a robust optimization framework.</p><p><br  /></p><p>参考文献：Liang Xu, Yi Zheng, Li Jiang. A Robust Data-Driven Approach for the Newsvendor Problem with Nonparametric Information. Manufacturing &amp; Service Operations Management, 2021, 24(1):504-523.</p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">30. 扩大药品生产商责任</span></strong></p><p><br  /></p><p>问题定义：我们调查了药品的不同的延伸生产者责任(EPR)实施模式的效力。特别地，我们研究了两种可行和普遍的模式：(1)源头削减(SR)，这是一种对生产商征收销售费用的形式，(2)管道末端控制(EC)，生产商负责收集未使用的药品。学术/实践相关性：现有关于EPR实施模型的文献主要关注于非消耗性产品（如电子产品），而对于实际使用的药品的不同的EPR实施模型的有效性的研究有限。本研究旨在填补这一空白。方法：我们提出了一个博弈模型来刻画不同利益相关者在SR和EC模型下的均衡策略，并比较产生的生产者利润、环境/社会影响和总福利。结果：与非消耗品（SR模型显示总福利最大化）相比，EC模型能有效消除过度处方，从而使某些类别的药品获得更高的总福利。此外，我们刻画了利益相关者（例如，生产者、环境/社会倡导团体）对EPR实施模式选择偏好（错误的）一致的条件。我们进一步发现，在SR下限制社会计划者的预算盈余可以消除偏好偏差，但却会导致总福利损失。管理启示：(1)决策者在将其他产品类别适用的EPR模型应用于制药环境时应慎重。(2) 对于具有高健康益处、高收集成本和高环境/社会成本的突出药品类别，EC模型可以使所有利益攸关方的目标实现最大化。(3)决策者应考虑不同药品类别的EPR实施模式。(4)仔细量化药品对健康的影响和决策制定相关的运营成本参数是至关重要的。</p><p><br  /></p><p>Problem definition: We investigate the effectiveness of different extended producer responsibility (EPR) implementation models for pharmaceuticals. In particular, we study two viable and prevalent models: (1) source reduction (SR), where a form of fee on sale is imposed on producers, and (2) end-of-pipe control (EC), where producers are made responsible for the collection of unused pharmaceuticals. Academic/practical relevance: The existing literature on EPR implementation models has focused primarily on nonconsumable products (e.g., electronics), whereas there is limited research on the effectiveness of different EPR implementation models for pharmaceuticals used in practice. We aim to fill this gap in this study. Methodology: We develop a game-theoretic model to characterize the equilibrium strategies of different stakeholders under both the SR and EC models and compare the resulting producer profit, environmental/social impact, and total welfare. Results: In contrast to the nonconsumable contexts where the SR model is shown to maximize total welfare, the EC model leads to a higher total welfare for certain categories of pharmaceuticals because of its effectiveness in eliminating overprescription. Moreover, we characterize conditions under which stakeholder (e.g., producer, environmental/social advocacy groups) preferences toward EPR implementation model choices are (mis-)aligned. We further show that limiting the social planner’s budget surplus under SR can eliminate the preference misalignment but leads to a loss of total welfare. Managerial implications: (1) Policymakers should be cautious about directly applying preferred EPR models from other product categories to the pharmaceutical setting. (2) The EC model maximizes the objectives of all stakeholders for a salient category of pharmaceuticals with high health benefits, high collection costs, and high environmental/social costs. (3) Policymakers should give thought to differentiating EPR implementation models across pharmaceutical categories. (4) It is important to carefully quantify the health impact of the pharmaceuticals and the operational cost parameters to inform policymaking.</p><p><br  /></p><p>参考文献：Işıl Alev, Can Zhang. Extended Producer Responsibility for Pharmaceuticals. Manufacturing &amp; Service Operations Management, 2021, 24(1):524-541.</p><p><span style="text-align: center;"></span></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">31. 灵活的药品审批政策</span></strong></p><p><br  /></p><p>问题定义：在批准一种新的药物疗法时，美国食品和药物管理局(FDA)要求临床试验应展现出具有2.5%的统计学意义的疗效，尽管该机构在解释这些标准时经常使用监管裁量权。疾病严重程度、流行率和现有治疗方法的可得性等因素一般是定性考虑的；然而，当前的指导方针在批准决定时未能系统地考虑这些特点。学术/实践相关性：在做出批准决定时，FDA会将引入救生疗法的健康益处与批准无效或有害药物的潜在风险进行权衡。针对个别疾病制定批准标准可以改善那些选择很少的患者的治疗方案，并能进一步激励制药公司投资于常被忽视的疾病。方法：我们利用一种新的排队框架，分析了FDA的药物批准过程——通过一组先发制人的M/M/1/1排队，将疾病特异性因素和陈旧性（更新的药物取代旧的配方）纳入其中。基于包括所有已注册的美国临床试验和FDA批准的药物的公开数据，我们估计了三种高负担疾病（乳腺癌、人类免疫缺陷病毒(HIV)和高血压）的模型参数，并求解了在FDA批准后可以最大化净生命年的最佳策略。结果：最优政策放宽了试验时间长、损耗高、研发强度低的疾病的审批标准。结果表明，相对于FDA现有的政策，针对乳腺癌或高血压的药物应采取更宽松的政策，而针对艾滋病毒的药物应采取更严苛的政策。如果制药公司通过提交更多药物申请批准来回应新标准——导致内源性临床试验的启动率——FDA的最佳政策将会适度降低乳腺癌和高血压的治疗，不过对艾滋病的改变最小。管理启示：我们的研究提供了一个透明的、定量的框架，可以帮助FDA根据潜在疾病相关的严重程度、流行率和药物开发过程和现有市场的特点制定特定疾病的批准指南。</p><p><br  /></p><p>Problem definition: To approve a novel drug therapy, the U.S. Food and Drug Administration (FDA) requires clinical trial evidence demonstrating efficacy with 2.5% statistical significance, although the agency often uses regulatory discretion when interpreting these standards. Factors including disease severity, prevalence, and availability of existing therapies are qualitatively considered; yet, current guidelines fail to systematically consider such characteristics in approval decisions. Academic/practical relevance: In making approval decisions, the FDA weighs the health benefits of introducing life-saving therapies against the potential risks of approving ineffective or harmful drugs. Tailoring approval standards to individual diseases could improve treatment options for patients with few alternatives and further incentivize pharmaceutical companies to invest in neglected diseases. Methodology: Using a novel queueing framework, we analyze the FDA’s drug approval process to incorporate disease-specific factors and obsolescence—newer drugs replacing older formulas—through a set of pre-emptive M/M/1/1 queues. Based on public data encompassing all registered U.S. clinical trials and FDA-approved drugs, we estimate model parameters for three high-burden diseases (breast cancer, human immunodeficiency virus (HIV), and hypertension) and solve for the optimal policy to maximize net life-years gained following FDA approval. Results: The optimal policy relaxes approval standards for diseases with long trial duration, high attrition, or low research and development intensity. Results indicate that a more lenient policy is warranted for drugs targeting breast cancer or hypertension, and a more stringent policy is recommended for HIV, relative to the FDA’s existing policy. If pharmaceutical firms respond to the new standards by submitting more drugs for approval—leading to an endogenous clinical trial initiation rate—the FDA’s optimal policy modestly decreases for breast cancer and hypertension, with minimal change for HIV. Managerial implications: Our study offers a transparent, quantitative framework that could help the FDA develop disease-specific approval guidelines based on underlying disease-related severity, prevalence, and characteristics of the drug development process and existing market.</p><p><br  /></p><p>参考文献：Fernanda Bravo, Taylor C. Corcoran, Elisa F. Long. Flexible Drug Approval Policies. Manufacturing &amp; Service Operations Management, 2021, 24(1):542-560.</p><p><br  /></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-backh="329" data-backw="579" data-ratio="0.5685714285714286" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRHcMwYZIzicf2NSkk90c4t0JiaMqfDrhiarpmescickibMD3GvtrogPTzAqdr5RzWKARXCHjyJhgDibNoeg/640?wx_fmt=jpeg" data-type="jpeg" data-w="700" style="text-align: center;white-space: normal;width: 100%;height: auto;"  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">32. 带患者重新输入和行为变化的日内调度</span></strong></p><p><br  /></p><p>问题定义：我们考虑一组骨科诊所的日内掉入问题，其中计划者安排预约时间并给出预约序列。我们考虑了病人重新进入——病人可能被要求去做x光检查，回到他们曾经见过的同一位医生那里——以及病人行为的多样性，如不请自来、早到和缺席，这些都会导致低效率，这是由于病人的等待时间过长和医生加班。学术/实践相关性：在我们的数据集中，25%的患者需要进行x线检查。我们发现患者的行为具有显著差异。因此，患者的重新进入和行为的可变性是常见的，但是我们在已有文献中几乎找不到关注这一点的研究。方法：我们将问题规划为一个两阶段的优化问题，其中调度决策在第一阶段作出。第二阶段的队列动态是在P-排队范式下建模的，它最小化了表示违反性能目标（如患者等待时间）的风险指数。该模型可以简化为一系列混合整数线性优化问题。结果：在与样本平均近似(SAA)模型的对比研究中，我们的模型在保持服务器超时时间不变的情况下，患者的等待时间显著减少。我们的仿真进一步刻画了SAA性能较差的不确定性类型。管理启示：我们提出了一个易于在实践中实施并易于计算的优化模型。我们的仿真表明，不考虑患者的重新进入或可变行为会导致次优政策，特别是当这些行为具有需要考虑的特定结构时。</p><p><br  /></p><p>Problem definition: We consider the intraday scheduling problem in a group of orthopaedic clinics where the planner schedules appointment times, given a sequence of appointments. We consider patient re-entry—where patients may be required to go for an x-ray examination, returning to the same doctor they have seen—and variability in patient behaviours such as walk-ins, earliness, and no-shows, which leads to inefficiency such as long patient waiting time and physician overtime. Academic/practical relevance: In our data set, 25% of the patients are required to go for x-ray examination. We also found significant variability in patient behaviours. Hence, patient re-entry and variability in behaviours are common, but we found little in the literature that could handle them. Methodology: We formulate the problem as a two-stage optimization problem, where scheduling decisions are made in the first stage. Queue dynamics in the second stage are modeled under a P-Queue paradigm, which minimizes a risk index representing the chance of violating performance targets, such as patient waiting times. The model reduces to a sequence of mixed-integer linear-optimization problems. Results: Our model achieves significant reductions, in comparative studies against a sample average approximation (SAA) model, on patient waiting times, while keeping server overtime constant. Our simulations further characterize the types of uncertainties under which SAA performs poorly. Managerial insights: We present an optimization model that is easy to implement in practice and tractable to compute. Our simulations indicate that not accounting for patient re-entry or variability in patient behaviours will lead to suboptimal policies, especially when they have specific structure that should be considered.</p><p><br  /></p><p>参考文献：Minglong Zhou, Gar Goei Loke, Chaithanya Bandi, Zi Qiang Glen Liau, Wilson Wang. Intraday Scheduling with Patient Re-entries and Variability in Behaviours. Manufacturing &amp; Service Operations Management, 2021, 24(1):561-579.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">33. 药物质量的自适应学习及对退出临床试验患者招募的优化</span></strong></p><p><br  /></p><p>问题定义：临床试验对于新药开发至关重要。本研究通过中期分析来调查临床试验中最优的患者登记情况，中期分析是对中间点患者治疗反应的分析。我们的模型考虑了患者登记和药物治疗效果的不确定性。我们考虑了早期完成试验的收益，和通过最大化药物累积利润的净现值来加速试验的成本。学术/实践相关性：临床试验通常是药物开发中投入最大的环节，患者登记是试验管理中的一个重要问题。通过了解所研究药物的治疗效果，我们的研究提出了一个动态程序，通过准确地捕捉到问题的动态以优化患者的登记。方法：该模型可以准确地捕获有关被研究药物和标准治疗药物有效性的物理状态（登记患者）和信念状态。我们利用贝叶斯更新和动态规划，确定了状态变量中值函数的单调性，并刻画了最优的登记策略。我们首次将反向近似动态规划(ADP)引入这类问题中。我们使用一家领先公司的临床试验程序来说明研究结果，并对最优登记政策的输入参数进行了敏感性分析。结果：值函数关于累计患者登记以及被研究药物和标准治疗药物的平均治疗反应是单调的。最优的登记政策关于在两个连续中期分析期间使用该药物的患者的平均反应是非减的，关于累计登记患者人数是非增的。前向ADP算法（或后向ADP算法）利用了值函数的单调性，将运行时间从使用精确方法的1.5个月减少至1天（或20分钟）内的4%。通过对一家领先公司的临床试验项目的应用，发现该模型提供的最优策略可以使该公司获得可观的药品利润。管理启示：我们提出了一种改进临床试验管理的新模式。我们的研究提供了对最优策略的见解，并洞察了值函数对退出率和先验概率分布的敏感性。一家公司可以通过使用最优策略和值函数的性质来管理其试验而获得可观的药品利润。我们表明公司可以使用ADP算法来制定他们的患者登记策略。</p><p><br  /></p><p>Problem definition: Clinical trials are crucial to new drug development. This study investigates optimal patient enrollment in clinical trials with interim analyses, which are analyses of treatment responses from patients at intermediate points. Our model considers uncertainties in patient enrollment and drug treatment effectiveness. We consider the benefits of completing a trial early and the cost of accelerating a trial by maximizing the net present value of drug cumulative profit. Academic/practical relevance: Clinical trials frequently account for the largest cost in drug development, and patient enrollment is an important problem in trial management. Our study develops a dynamic program, accurately capturing the dynamics of the problem, to optimize patient enrollment while learning the treatment effectiveness of an investigated drug. Methodology: The model explicitly captures both the physical state (enrolled patients) and belief states about the effectiveness of the investigated drug and a standard treatment drug. Using Bayesian updates and dynamic programming, we establish monotonicity of the value function in state variables and characterize an optimal enrollment policy. We also introduce, for the first time, the use of backward approximate dynamic programming (ADP) for this problem class. We illustrate the findings using a clinical trial program from a leading firm. Our study performs sensitivity analyses of the input parameters on the optimal enrollment policy. Results: The value function is monotonic in cumulative patient enrollment and the average responses of treatment for the investigated drug and standard treatment drug. The optimal enrollment policy is nondecreasing in the average response from patients using the investigated drug and is nonincreasing in cumulative patient enrollment in periods between two successive interim analyses. The forward ADP algorithm (or backward ADP algorithm) exploiting the monotonicity of the value function reduced the run time from 1.5 months using the exact method to a day (or 20 minutes) within 4% of the exact method. Through an application to a leading firm’s clinical trial program, the study demonstrates that the firm can have a sizable gain of drug profit following the optimal policy that our model provides. Managerial implications: We developed a new model for improving the management of clinical trials. Our study provides insights of an optimal policy and insights into the sensitivity of value function to the dropout rate and prior probability distribution. A firm can have a sizable gain in the drug’s profit by managing its trials using the optimal policies and the properties of value function. We illustrated that firms can use the ADP algorithms to develop their patient enrollment strategies.</p><p><br  /></p><p>参考文献：Zhili Tian, Weidong Han, Warren B. Powell. Adaptive Learning of Drug Quality and Optimization of Patient Recruitment for Clinical Trials with Dropouts. Manufacturing &amp; Service Operations Management, 2021, 24(1):580-599.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">34. 协调医疗服务提供者与结果成本部分归因的支付模式</span></strong></p><p><br  /></p><p>问题定义：在许多医疗系统中，全科医生将病人转给专家，专家在有限的能力下做出治疗决定。我们评估了包括传统方案和捆绑方案的不同支付方案的有效性，前者是支付方与医疗服务提供者分别签订合同，后者是医疗服务提供者共享一个捆绑支付。我们考虑的一个关键特征是基于绩效的支付部分，通过单一支付方协调全科医生和专家的决策。医疗服务提供者对病人的治疗结果和治疗决策所产生的费用承担部分责任。</p><p><br  /></p><p>学术/实践依据：我们提出并分析了一个模型，以解决医疗中的转诊和专家治疗决策如何相互影响，以及支付方案如何影响全科医生和专家之间的护理协调问题。我们的工作对于政策制定者了解在以转诊为基础的医疗系统中使用捆绑式和非捆绑式支付方案之间的权衡很有价值。</p><p><br  /></p><p>方法：基本的研究方法是分析优化模型（考虑了拥挤效应），以探索不同支付方案对不同实体和医疗系统中各种运营绩效指标的影响。</p><p><br  /></p><p>结果：相对于非捆绑方案，捆绑方案有更高的转诊率，专家花在病人身上的时间更少，在大多数情况下专家的利用率更高，系统成本也更高。我们的结论对各种模型变化都是稳健的。</p><p><br  /></p><p>管理启示：本文对基于转诊的医疗系统中，捆绑式和非捆绑式支付方案在运营指标上的相对表现提供了具体的管理见解。它还揭示了服务结果对提供者的归因水平如何与支付方案相互作用，影响转诊和专家治疗决策，并影响各种质量和成本指标。Problem definition: In many healthcare systems, general practitioners refer patients to specialists, who make treatment decisions under limited capacity. We evaluate the effectiveness of different payment schemes, both traditional ones, where the payer contracts separately with the providers, and bundled schemes, where the providers share a single bundled payment. A key feature considered is a performance-based payment component to coordinate the decisions of the general practitioner and specialist by a single payer. The providers are partially responsible for the patient outcomes and costs stemming from their treatment decisions.</p><p><br  /></p><p>Academic/practical relevance: We propose and analyze a model to address how referral and specialist treatment decisions in healthcare impact each other and how payment schemes impact the coordination of care between the general practitioner and specialist. Our work is valuable to policymakers in understanding the trade-offs between using bundled and unbundled payment schemes in a referral-based healthcare system.</p><p><br  /></p><p>Methodology: The underlying research method is the analysis of optimization models (with congestion effects embedded) to explore the effects of different payment schemes on different entities and various operational performance measures in a healthcare system.</p><p><br  /></p><p>Results: A bundled scheme has higher referral rates, lower time spent with the patient by the specialist, higher specialist utilization relative to an unbundled system in most scenarios, and higher system costs. Our conclusions are robust to various model changes.</p><p><br  /></p><p>Managerial implications: Our work provides specific managerial insights into the relative performance of bundled and unbundled payment systems on operational metrics in a referral-based healthcare system. It also sheds light on how the level of attributability of service outcomes to providers interacts with payment schemes to influence referral and specialist treatment decisions and impact various quality and cost metrics.</p><p><br  /></p><p>参考文献：Sampath Rajagopalan, Chunyang Tong (2018) Payment Models to Coordinate Healthcare Providers with Partial Attribution of Outcome Costs. Manufacturing &amp; Service Operations Management 24(1):600-616.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">35. 全关节置换术后护理过程的最佳干预策略</span></strong></p><p><br  /></p><p>问题定义：全关节置换术（TJR）的成功结果不仅取决于手术，也取决于患者的术后行为；术后表现不佳可能会导致并发症和/或再住院。为了防止这类事件的发生，患者要经历术后干预过程，接受物理治疗和/或某种形式的康复服务。虽然提供这种干预和再入院处罚的成本很高，但没有任何方法可以让医护人员确定干预的最佳时机和目标群体。</p><p><br  /></p><p>学术/实践依据：为了解决这些需求，本文研究了医护人员所面临的决策问题：我们应该在什么时候向哪一组病人提供干预措施以使总费用最小？我们将出院后的干预过程建模为有限跨度的离散时间马尔可夫决策过程。</p><p><br  /></p><p>方法：我们通过以下方式对TJR后的干预过程进行动态建模：（1）直接包含再入院风险和惩罚；（2）基于病人的位置（护理设施类型），考虑干预措施的不同效果。</p><p><br  /></p><p>结果：我们通过对一家社区医院的案例研究，说明了该模型的适用性，并证明了一些结构性质，包括有限控制类型策略的存在。基于从合作医院获得的数据，最优策略是建议在急性期后的恢复期开始干预专业护理机构（SNF）的病人。</p><p><br  /></p><p>管理启示：该模型的最优策略表明，将干预资源集中在术后初期的常见做法需要进一步论证。应该将更多的注意力集中在术前或手术阶段，以制定更适合预防早期再入院原因的干预措施。</p><p><br  /></p><p>Problem definition: Successful outcomes of total joint replacement (TJR) depend not only on the surgery but also on the patients’ postsurgical behaviors; inadequate postsurgical performance can lead to complications and/or readmissions. To prevent such events, patients go through postoperative intervention processes in which they receive physical therapy and/or some form of rehabilitative services. Although the costs of providing such interventions and readmission penalties are substantial, no methods exist that enable healthcare professionals to determine the optimal timing and target group of the interventions.</p><p><br  /></p><p>Academic/practical relevance: To address these gaps, this paper investigates the decision problem faced by healthcare professionals: When should we provide interventions to which group of patients to minimize the total expense? We formulate the postdischarge intervention process as a finite-horizon discrete-time Markov decision process.</p><p><br  /></p><p>Methodology: We dynamically model the post-TJR intervention process by (1) directly incorporating the readmission risk and penalty, and (2) considering the varying effectiveness of interventions depending on where the patient is located (care facility type).</p><p><br  /></p><p>Results: Through a case study at a community hospital, the applicability of the model is illustrated and a number of structural properties, including the existence of a control-limit type policy, are proved. Based on the data obtained from the collaborating hospital, the optimal policy suggests to start intervening skilled nursing facility (SNF) patients after the postacute recovery period.</p><p><br  /></p><p>Managerial implications: The optimal policy of the model shows that the common practice of focusing intervention resources on immediate postoperative periods needs further justification, and more attention should be focused on the presurgical or surgical phase to devise interventions that are more tailored toward preventing early readmission causes.</p><p><br  /></p><p>参考文献：Hyo Kyung Lee, Jingshan Li, Philip A. Bain, Christine Baker (2021) Optimal Intervention Policies for Total Joint Replacement Postoperative Care Process. Manufacturing &amp; Service Operations Management 24(1):617-631.</p><p><br  /></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">36. 具有边际利润差异的工艺灵活性设计的鲁棒优化方法</span></strong></p><p><br  /></p><p>问题定义：对有限灵活有效性的理论研究主要集中在基于最大化单位销售额的绩效指标。然而，当最大销售指标被用来指导灵活性设计，而产品的边际利润差异相当大时，这可能导致巨大利润损失。</p><p><br  /></p><p>学术/实践依据：为了解决这个问题，我们将边际利润差异引入工艺灵活性设计的分析。当产品具有异质边际利润率，我们的结果可以为灵活性配置的评估和设计提供有用的指导。</p><p><br  /></p><p>方法：我们采用一个鲁棒优化框架，通过引入对偶边际组指数（DMGI），从最坏情况的角度研究工艺灵活性设计。</p><p><br  /></p><p>结果和管理意义：我们表明，一类一般性的最坏情况的性能度量可以表示为设计DMGI和给定不确定性集的函数。此外，DMGI给出了一个部分排序，使我们能够比较不同设计的最坏情况的性能。利用这些结果，我们证明，在所谓的部分独立对称不确定性集和一大类最坏情况下的性能衡量标准下，在具有相同数量的高利润产品和低利润的长链设计中，备用长链设计是最优的。最后，我们开发了一种基于DMGI的启发式方法，以便在产品存在边际利润差异时能产生有效的灵活性设计。</p><p><br  /></p><p>Problem definition: The theoretical investigation of the effectiveness of limited flexibility has mainly focused on a performance metric that is based on the maximum sales in units. However, this could lead to substantial profit losses when the maximum sales metric is used to guide flexibility designs while the products have considerably large profit margin differences.</p><p><br  /></p><p>Academic/practical relevance: We address this issue by introducing margin differentials into the analysis of process flexibility designs, and our results can provide useful guidelines for the evaluation and design of flexibility configurations when the products have heterogeneous margins.</p><p><br  /></p><p>Methodology: We adopt a robust optimization framework and study process flexibility designs from the worst-case perspective by introducing the dual margin group index (DMGI).</p><p><br  /></p><p>Results and managerial implications: We show that a general class of worst-case performance measures can be expressed as functions of a design’s DMGIs and the given uncertainty set. Moreover, the DMGIs lead to a partial ordering that enables us to compare the worst-case performance of different designs. Applying these results, we prove that under the so-called partwise independently symmetric uncertainty sets and a broad class of worst-case performance measures, the alternate long-chain design is optimal among all long-chain designs with equal numbers of high-profit products and low-profit products. Finally, we develop a heuristic based on the DMGIs to generate effective flexibility designs when products exhibit margin differentials.</p><p><br  /></p><p>参考文献：Shixin Wang, Xuan Wang, Jiawei Zhang (2020) Robust Optimization Approach to Process Flexibility Designs with Contribution Margin Differentials. Manufacturing &amp; Service Operations Management 24(1):632-646.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">37. 具有多个需求源和多个设施的服务提供商之间的价格导向成本分摊和需求分配</span></strong></p><p><br  /></p><p>问题定义：我们考虑在有多个需求源和多个服务设施的企业之间通过需求分配来实现能力共享。企业决定将不同来源的需求分配给不同的设施，以最大限度地减少延迟成本和可能取决于服务水平要求的服务履约成本。如果企业决定作为一个联盟集体运作，他们还必须决定一个分摊总成本的机制。</p><p><br  /></p><p>学术/实践依据：我们研究在有服务履约成本的情况下，通过服务系统中的需求分配来实现能力共享。该问题的研究动机是涉及公私合营的医疗服务合作。</p><p><br  /></p><p>方法：我们将该问题建立为合作博弈，并确定了核为成本分配。</p><p><br  /></p><p>结果：我们确定的成本分配机制是价格导向的，每个公司的成本包括三个部分。(1)企业内部产生的延迟成本；(2)企业使用其他企业设施的能力所支付的成本；(3)本企业设施满足其他企业的需求所收到的付款。有趣的是，我们表明成本分配机制与市场均衡等价，也就是说，它可以以非集中的方式实施。我们将分析扩展到每个设施的能力是内生决定的情形，以及实施了服务优先策略的情形。我们的结果对各种泛化的情形是稳健的：部分共享、部分转移、设施建模为一般排队系统和凸的延迟成本。</p><p><br  /></p><p>管理启示：我们的研究结果为如何在有服务履约成本的情况下在不同公司之间进行需求分配和成本分摊以促进服务合作提供了指南和见解。特别是，均衡的市场价格可以被看作是公私合营中服务合作的价格/补贴。</p><p><br  /></p><p>Problem definition: We consider capacity sharing through demand allocation among firms with multiple demand sources and multiple service facilities. Firms decide on the allocation of demand from different sources to different facilities to minimize delay costs and service-fulfillment costs possibly subject to service-level requirements. If firms decide to operate collectively as a coalition, they must also decide on a scheme for sharing the total cost.</p><p><br  /></p><p>Academic/practical relevance: We study capacity sharing through demand allocation in service systems in the presence of service-fulfillment costs. Our problem is motivated by service collaboration in healthcare involving public–private partnerships.</p><p><br  /></p><p>Methodology: We formulate the problem as a cooperative game and identify a cost allocation that is in the core.</p><p><br  /></p><p>Results: The cost-allocation scheme we identify is price-directed, and the cost of each firm consists of three components: (1) the delay cost incurred within the firm; (2) a cost paid for the capacity used by the firm at facilities owned by other firms; and (3) a payment received for fulfilling demand of other firms at facilities owned by the firm. Interestingly, we show that the cost-allocation scheme is equivalent to a market equilibrium—that is, it can be implemented in a decentralized fashion. We extend our analysis to settings where the capacity of each facility is endogenously determined and to settings where a service-priority policy is deployed. Our results are robust to a variety of generalizations: partial sharing, partial transfer, facilities modeled as general queueing systems, and convex delay costs.</p><p><br  /></p><p>Managerial implications: Our findings provide guidelines for and insights into how to carry out demand allocation and cost sharing among different firms in the presence of service-fulfillment costs to foster service collaboration. In particular, the equilibrium market prices can be viewed as the prices/subsidies for service collaboration in a public–private partnership.</p><p><br  /></p><p>参考文献：Hanlin Liu, Yimin Yu, Saif Benjaafar, Huihui Wang (2021) Price-Directed Cost Sharing and Demand Allocation Among Service Providers with Multiple Demand Sources and Multiple Facilities. Manufacturing &amp; Service Operations Management 24(1):647-663.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">38. 展示还是讲述？改善金字塔底层基于代理商的公司的库存支持</span></strong></p><p><br  /></p><p>问题定义：为低收入的金字塔底层（BOP）客户提供产品和服务的公司在其分销模式中更多地使用独立的承包商代理人而不是雇佣员工。我们通过实证研究了帮助代理商表现更好的最佳方法。</p><p><br  /></p><p>学术/实践依据：BOP客户占世界经济的三分之一，但其每天赚取5美元或更少。向这些顾客提供商品和服务对传统企业来说是困难的，因为大多数零售活动发生在小规模的独立商店。改善代理商的表现可以帮助企业在这种环境下接触客户。我们加强了在BOP情境下基于代理商的模型、决策、发展中经济体的技术和实地实验的文献。</p><p><br  /></p><p>方法：我们与坦桑尼亚的一家移动支付运营商合作，对4,771名代理商进行了随机对照试验，研究不同类型的指导以及是否提供当面培训如何影响代理商的库存管理。移动支付是一个平台，发展中经济体的公司通过手机向客户提供金融服务。移动货币代理商作为无分行的银行网点为客户提供提款和存款服务。他们每天决定储存多少钱来服务客户的交易，并从中赚取佣金。</p><p><br  /></p><p>结果：我们发现，那些只获得明确建议（相较于汇总统计或两者都有）的代理商被邀请参加当面培训（相比于简单地收到自动通知），他们的表现得到了改善。其他处置组中的代理商没有表现出统计学上的显著变化。这种影响集中在那些从未在银行补充过资金的代理商和处置阶段前的资金库存水平很低的代理商身上。</p><p><br  /></p><p>管理启示：我们通过实证研究表明，企业可以更好地管理代理商，从而提高服务BOP客户的价值主张。我们展示了基于代理商异质性的细分效用。这可以改善公司业绩、代理商利润和客户服务。</p><p><br  /></p><p>Problem definition: Firms providing products and services to low-income base of the pyramid (BOP) customers are increasingly utilizing independent contractor agents rather than employees in their distribution models. We empirically investigate the best way to help agents perform better.</p><p><br  /></p><p>Academic/practical relevance: BOP customers represent one-third of the world’s economy but make five United States dollars or less daily. Providing goods and services to these customers is difficult for traditional firms because most retail activity occurs at small-scale independent outlets. Improving agent performance can help firms reach customers in this environment. We enhance the literature on agent-based models in BOP settings, decision making, technology in developing economies, and field experiments.</p><p><br  /></p><p>Methodology: In partnership with a Tanzanian mobile money operator, we perform a randomized, controlled trial with 4,771 agents to examine how differing types of guidance, and whether in-person training is offered, impact agents’ inventory management. Mobile money is a platform whereby firms in developing economies provide financial services to customers via cell phones. Mobile money agents service customer withdrawals and deposits as branchless banking outlets. Every day, they decide how much money to stock to service customers’ transactions, from which they earn commissions.</p><p><br  /></p><p>Results: We find that those agents given only explicit recommendations (as opposed to summary statistics or both) who were invited to in-person training (as opposed to simply received an automated notification) improve their performance. Agents in other treatments showed no statistically significant change. The effect is concentrated in agents who never replenished their money at a bank and whose money inventory levels were low in the pretreatment period.</p><p><br  /></p><p>Managerial implications: We show empirically how firms can better manage agents, thereby improving the value proposition of serving BOP customers. We show the utility of segmentation based on agent heterogeneity. This can improve firm performance, agent profits, and customer service.</p><p><br  /></p><p>参考文献：Jason Acimovic, Chris Parker, David F. Drake, Karthik Balasubramanian (2020) Show or Tell? Improving Inventory Support for Agent-Based Businesses at the Base of the Pyramid. Manufacturing &amp; Service Operations Management 24(1):664-681.</p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">39. 数据集：英特尔公司 187 周的微处理器顾客预测和订单</span></strong></p><p><br  /></p><p>问题定义：这个数据集包含了英特尔在其五个销售地区中的一个销售地区里五个分销中心连续187周的微处理器需求信息。对于每个地点的每个库存单位（SKU），都提供了每周的预测需求和实际客户订单，以及SKU的平均销售价格类别。这些数据按周和按分销中心提供，共产生了26114条记录。</p><p><br  /></p><p>学术/实践依据：数据集中的86个SKU跨越了五代产品。它提供了各代产品和价格点的多年演变情况。</p><p><br  /></p><p>方法：作为一份数据集文件，其目的是为开发预测、库存、定价和选品模型的研究人员提供有趣和丰富的现实世界数据。</p><p><br  /></p><p>结果：该数据集显示了明显的预测偏差、分销中心之间预测误差的异质性、代际差异、产品生命周期和定价动态的存在。</p><p><br  /></p><p>管理启示：这个数据集提供了一个大型企业丰富的定价和销售环境，这在以前是没有的。</p><p><br  /></p><p>Problem definition: This data set contains 187 consecutive weeks of Intel microprocessor demand information for all five distribution centers in one of its five sales geographies. For every stock keeping unit (SKU) at every location, the weekly forecasted demand and actual customer orders are provided as well as the SKU’s average selling price category. These data are provided by week and by distribution center, producing 26,114 records in total.</p><p><br  /></p><p>Academic/practical relevance: The 86 SKUs in the data set span five product generations. It provides years of product evolution across generations and price points.</p><p><br  /></p><p>Methodology: As a data set paper, its purpose is to provide interesting and rich real-world data for researchers developing forecasting, inventory, pricing, and product assortment models.</p><p><br  /></p><p>Results: The data set demonstrates the presence of significant forecast bias, heterogeneity of forecast errors between distribution centers, generational differences, product life cycles, and pricing dynamics.</p><p><br  /></p><p>Managerial implications: This data set provides access to a rich pricing and sales setting from a major corporation that has not been made available before.</p><p><br  /></p><p>参考文献：Matthew P. Manary, Sean P. Willems (2021) Data Set: 187 Weeks of Customer Forecasts and Orders for Microprocessors from Intel Corporation. Manufacturing &amp; Service Operations Management 24(1):682-689.</p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><br  /></p><section powered-by="xiumi.us" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;max-width: 100%;color: rgb(34, 34, 34);white-space: normal;caret-color: rgb(34, 34, 34);letter-spacing: 0.544px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);text-align: center;font-size: 29px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-bottom: 0.8em;padding: 0.15em;outline: 0px;max-width: 100%;display: inline-block;width: 3.6em;height: 3.6em;transform: rotate(45deg);border-radius: 50% 50% 0px;background-color: rgb(249, 110, 87);box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin: auto;outline: 0px;max-width: 100%;width: 3.3em;height: 3.3em;display: inline-block;vertical-align: bottom;border-radius: 100%;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;display: table;width: 95px;height: 3.3em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;display: table-cell;vertical-align: middle;width: 95px;line-height: 1.2;transform: rotate(-45deg);box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">推荐</p><p style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">订阅<br style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"  /></p></section></section></section></section></section><p style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);white-space: normal;caret-color: rgb(34, 34, 34);letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-bottom: 0em;"><img class="rich_pages wxw-img" data-cropselx1="0" data-cropselx2="574" data-cropsely1="0" data-cropsely2="490" data-fileid="504768636" data-ratio="0.9294117647058824" data-s="300,640" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_png/JYKDNBjmXREVicfO35stGZ9jymhDjiccnXs57wa8FPsOc4KXbqQR1HvbjDvTSBxdgJR0XqhHSLJ5wB8khAU5ia0ng/640?wx_fmt=png" data-type="png" data-w="935" style="outline: 0px;border-width: 1px;border-style: solid;border-color: rgb(238, 237, 235);background-color: rgb(238, 237, 235);background-size: 22px;background-position: center center;background-repeat: no-repeat;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible !important;width: 574px !important;"  /></p><p style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);white-space: normal;letter-spacing: 0.544px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-bottom: 0em;"><img class="rich_pages wxw-img" data-fileid="504768637" data-galleryid="" data-ratio="0.5571878279118573" data-s="300,640" src="https://images.weserv.nl/?url=https://mmbiz.qpic.cn/mmbiz_png/JYKDNBjmXRGVLJBMsGzW8JmFuQLTXtKOoia6VaFLVt4d0WwNo5zW75qhM1BB1QrywsGsnTPzRSp4Q6IjlmJYPfA/640?wx_fmt=png" data-type="png" data-w="953" style="outline: 0px;border-width: 1px;border-style: solid;border-color: rgb(238, 237, 235);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;box-sizing: border-box !important;overflow-wrap: break-word !important;background-color: rgb(238, 237, 235) !important;background-size: 22px !important;visibility: visible !important;background-position: center center !important;background-repeat: no-repeat !important;width: 677px !important;"  /></p><section powered-by="xiumi.us" style="margin-top: 0.5em;outline: 0px;max-width: 100%;color: rgb(34, 34, 34);white-space: normal;letter-spacing: 0.544px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="padding: 0.5em;outline: 0px;max-width: 100%;border-width: 1px;border-style: solid;border-color: rgb(255, 129, 36);box-shadow: rgb(226, 226, 226) 0px 16px 1px -13px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;text-align: justify;color: rgb(64, 84, 115);box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(255, 76, 65);box-sizing: border-box !important;overflow-wrap: break-word !important;">点击“阅读原文”发现更多未推送经济金融学论文导读！</span></p></section></section></section></section><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;white-space: normal;letter-spacing: 0.544px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);font-size: 32px;color: rgb(255, 129, 36);box-sizing: border-box !important;overflow-wrap: break-word !important;">↓↓↓&nbsp;</section>
          </div>

          <script type="text/javascript" nonce="1738606354" reportloaderror>
            var first_sceen__time = (+new Date());
            if ("" == 1 && document.getElementById('js_content')) {
              document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
            }
          </script>

          
<div id="js_sponsor_ad_area"></div>


           
                                
                    
        </div>
                        <div id="js_tags_preview_toast" class="article-tag__error-tips" style="display: none;">预览时标签不可点</div>
                
        
        <div id="js_album_keep_read" class="appmsg_card_context album_read_card" style="display: none;">
          <div role="button" class="album_read_hd weui-flex" id="js_album_directory">
            <div class="album_read_source">收录于合集 <span class="weui-link wx_tap_link js_album_directory__name">#<span id="js_album_keep_read_title"></span></span></div>
            <span class="weui-btn__word-wrp wx_tap_link js_album_directory__size">&nbsp;<span id="js_album_keep_read_size"></span><span class="weui-hidden_abs">个</span></span>
          </div>
          <div class="album_read_bd weui-flex">
            <span role="button" class="album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight" id="js_album_prev">
              <span class="album_read_nav_inner">
                <span class="album_read_nav_btn">上一篇</span>
                <span class="album_read_nav_title">
                  <span class="album_read_nav_title_inner" id="js_album_keep_read_pre_title"></span>
                </span>
              </span>
            </span>
            <span role="button" class="album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight" id="js_album_next">
              <span class="album_read_nav_inner">
                <span class="album_read_nav_btn">下一篇</span>
                <span class="album_read_nav_title">
                  <span class="album_read_nav_title_inner" id="js_album_keep_read_next_title"></span>
                </span>
              </span>
            </span>
          </div>
        </div>

        

        
        <div id="content_bottom_area" class="rich_media_tool_area"></div>

              </div>
    </div>

    <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>

    
    <div class="rich_media_area_extra">
      <div class="rich_media_area_extra_inner">
        
        <div class="wx_follow_container" id="js_like_profile_container"></div>
        
        <div class="related_container" id="js_related_container"></div>
        
        <div id="page_bottom_area"></div>
      </div>
    </div>

    
    <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
      <div class="qr_code_pc_inner">
        <div class="qr_code_pc">
          <img id="js_pc_qr_code_img" class="qr_code_pc_img">
          <p>微信扫一扫<br>关注该公众号</p>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="comment_primary_emotion_panel_wrp" id="js_emotion_panel_pc" style="display: none">
  <div class="comment_primary_emotion_panel">
    <ul class="comment_primary_emotion_list_pc" id="js_emotion_list_pc">
    </ul>
  </div>
</div>


<div class="weui-dialog__wrp" id="js_alert_panel" style="display:none;">
  <div class="weui-mask"></div>
  <div class="weui-dialog">
    <div class="weui-dialog__bd" id="js_alert_content"></div>
    <div class="weui-dialog__ft">
      <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_alert_confirm">知道了</a>
    </div>
  </div>
</div>


<script type="text/javascript" nonce="1738606354" reportloaderror>
  window.img_popup = 1; // 全量小程序弹窗
</script>


<div id="js_pc_weapp_code" class="weui-desktop-popover weui-desktop-popover_pos-up-center weui-desktop-popover_img-text" style="display: none;">
  <div class="weui-desktop-popover__content">
      <div class="weui-desktop-popover__desc">
          <img id="js_pc_weapp_code_img">
          微信扫一扫<br>使用小程序<span id="js_pc_weapp_code_des"></span>
      </div>
  </div>
</div>
<div id="js_minipro_dialog" role="dialog" aria-modal="true" tabindex="0" aria-labelledby="js_minipro_dialog_head" style="display:none;">
  <div class="weui-mask"></div>
  <div class="weui-dialog weui-dialog_link">
      <div class="weui-dialog__hd">
          <strong class="weui-dialog__title" id="js_minipro_dialog_head" tabindex="0"></strong>
      </div>
      <div class="weui-dialog__bd" id="js_minipro_dialog_body"></div>
      
      <div class="weui-dialog__ft">
          <a role="button" id="js_minipro_dialog_cancel" href="javascript:void(0);" class="weui-dialog__btn weui-dialog__btn_default">取消</a>
          <a role="button" id="js_minipro_dialog_ok" href="javascript:void(0);" class="weui-dialog__btn weui-dialog__btn_primary">允许</a>
      </div>
  </div>
</div>
<div id="js_link_dialog" role="dialog" aria-modal="true" tabindex="0" aria-labelledby="js_link_dialog_body" style="display:none;">
  <div class="weui-mask"></div>
  <div class="weui-dialog weui-dialog_link">
    <div class="weui-dialog__hd">
      <strong class="weui-dialog__title" id="js_link_dialog_head" tabindex="0"></strong>
    </div>
    <div class="weui-dialog__bd" id="js_link_dialog_body" tabindex="0"></div>
    
    <div class="weui-dialog__ft">
      <a role="button" id="js_link_dialog_cancel" href="javascript:void(0);" class="weui-dialog__btn weui-dialog__btn_default">取消</a>
      <a role="button" id="js_link_dialog_ok" href="javascript:void(0);" class="weui-dialog__btn weui-dialog__btn_primary">允许</a>
    </div>
  </div>
</div>



    <script type="text/javascript" nonce="1738606354" reportloaderror>
window.logs.pagetime.page_begin = Date.now();
</script>
    <script type="text/javascript" nonce="1738606354" reportloaderror>
var __DEBUGINFO = {
  debug_js: "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/biz_wap/debug/console5e2ea0.js",
  safe_js: "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/biz_wap/safe/moonsafe5e2ea0.js",
  res_list: []
};
</script>

<script type="text/javascript" nonce="1738606354" reportloaderror>
(function () {
  var totalCount = 0,
    finishCount = 0;

  function _loadVConsolePlugin() {
    window.vConsole = new window.VConsole();
    while (window.vConsolePlugins.length > 0) {
      var p = window.vConsolePlugins.shift();
      window.vConsole.addPlugin(p);
    }
    // 视频落地页h5有时候不会触发onload事件，导致vConsole无法渲染，这里手动强制渲染vConsole @baakqiu
    if (!window.vConsole.isInited) {
      window.vConsole._render();
      window.vConsole._mockTap();
      window.vConsole._bindEvent();
      window.vConsole._autoRun();
    }
  }

  function _addVConsole(uri, cb) {
    totalCount++;
    var node = document.createElement('SCRIPT');
    node.type = 'text/javascript';
    node.src = uri;
    node.setAttribute('nonce', '1738606354');
    if (cb) {
      node.onload = cb;
    }
    document.getElementsByTagName('head')[0].appendChild(node);
  }
  if (
    (document.cookie && document.cookie.indexOf('vconsole_open=1') > -1)
    || location.href.indexOf('vconsole=1') > -1
  ) {
    window.vConsolePlugins = [];
    _addVConsole('//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/3.2.2/vconsole.min5e2e9e.js', function () {
      // _addVConsole('plugin/vconsole-sources/1.0.1/vconsole-sources.min.js');
      _addVConsole('//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/plugin/vconsole-mpopt/1.0.1/vconsole-mpopt5e2e9e.js', _loadVConsolePlugin);
    });
  }

  // // 广告iframe预加载
  try {
    var adIframeUrl = localStorage.getItem('__WXLS_ad_iframe_url');
    if (window === top) {
      if (adIframeUrl) {
        if (navigator.userAgent.indexOf('iPhone') > -1) {
          var img = new Image();
          img.src = adIframeUrl;
        } else {
          var link = document.createElement('link');
          link.rel = 'prefetch';
          link.href = adIframeUrl;
          document.getElementsByTagName('head')[0].appendChild(link);
        }
      }
    }
  } catch (err) {

  }

})();
</script>
    
    <script type="text/javascript" nonce="1738606354" reportloaderror>var __INLINE_SCRIPT__=function(){"use strict";var e=function(e,n){if(e.indexOf("——")>-1){e=e.replace(/——/g,'<span style="letter-spacing:normal">——</span>')}n&&(n.innerHTML=e)};if(!window.__second_open__){e("唧唧堂：MSOM 制造与服务运营管理期刊 2022年1-2月论文摘要39篇",document.getElementById("activity-name")),window.__setTitle=e}return e}();</script><script type="text/javascript" nonce="1738606354" reportloaderror>var __INLINE_SCRIPT__=function(){"use strict";var e=function(e,t,n,i){var _=new Date(1e3*(1*t)),o=function(e){return"0".concat(e).slice(-2)},r=_.getFullYear()+"-"+o(_.getMonth()+1)+"-"+o(_.getDate())+" "+o(_.getHours())+":"+o(_.getMinutes());i&&(i.innerText=r)};if(!window.__second_open__){e(0,"1651923081",0,document.getElementById("publish_time")),window.__setPubTime=e}return e}();</script>

<script type="text/javascript" nonce="1738606354" reportloaderror>
//兼容 IE
if (!window.console) window.console = { log: function() {} };
// 图片占位 @ekili
if (typeof getComputedStyle == 'undefined') {
  if (document.body.currentStyle) {
    window.getComputedStyle = function(el) {
      return el.currentStyle;
    }
  } else {
    window.getComputedStyle = {};
  }
}
// 图片和视频预加载逻辑，记得H5和秒开要对齐逻辑
(function(){
  window.__zoom = 1;

  var ua = navigator.userAgent.toLowerCase();
  var re = new RegExp("msie ([0-9]+[\.0-9]*)");
  var version;
  if (re.exec(ua) != null) {
    version = parseInt(RegExp.$1);
  }
  var isIE = false;
  if (typeof version != 'undefined' && version >= 6 && version <= 9) {
    isIE = true;
  }
  var bodyWidth = '' * 1;
  if (bodyWidth) {
    var styles = getComputedStyle(document.getElementById('page-content'));
    bodyWidth - parseFloat(styles.paddingLeft) - parseFloat(styles.paddingRight);
  }
  var getMaxWith = function () {
    var container = document.getElementById('img-content');
    var max_width = container.offsetWidth;
    !max_width && bodyWidth && (max_width = bodyWidth);
    var container_padding = 0;
    var container_style = getComputedStyle(container);
    container_padding = parseFloat(container_style.paddingLeft) + parseFloat(container_style.paddingRight);
    max_width -= container_padding;
    if (!max_width) {
      max_width = window.innerWidth - 30;      //防止offsetTop不可用，30为padding
    }
    return max_width;
  };
  var getParentWidth = function (dom) {
    var parent_width = 0;
    var parent = dom.parentNode;
    var outerWidth = 0;
    while (true) {
      if (!parent || parent.nodeType != 1) break;
      var parent_style = getComputedStyle(parent);
      if (!parent_style) break;
      parent_width = parent.clientWidth - parseFloat(parent_style.paddingLeft) - parseFloat(parent_style.paddingRight) - outerWidth;
      if (parent_width > 0) break;
      outerWidth += parseFloat(parent_style.paddingLeft) + parseFloat(parent_style.paddingRight) + parseFloat(parent_style.marginLeft) + parseFloat(parent_style.marginRight) + parseFloat(parent_style.borderLeftWidth) + parseFloat(parent_style.borderRightWidth);
      parent = parent.parentNode;
    }
    return parent_width;
  }
  var getOuterW = function (dom) {
    var style = getComputedStyle(dom),
      w = 0;
    if (!!style) {
      w = parseFloat(style.paddingLeft) + parseFloat(style.paddingRight) + parseFloat(style.borderLeftWidth) + parseFloat(style.borderRightWidth);
    }
    return w;
  };
  var getOuterH = function (dom) {
    var style = getComputedStyle(dom),
      h = 0;
    if (!!style) {
      h = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom) + parseFloat(style.borderTopWidth) + parseFloat(style.borderBottomWidth);
    }
    return h;
  };
  var insertAfter = function (dom, afterDom) {
    var _p = afterDom.parentNode;
    if (!_p) {
      return;
    }
    if (_p.lastChild === afterDom) {
      _p.appendChild(dom);
    } else {
      _p.insertBefore(dom, afterDom.nextSibling);
    }
  };
  var getQuery = function (name, url) {
    //参数：变量名，url为空则表从当前页面的url中取
    var u = arguments[1] || window.location.search,
      reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"),
      r = u.substr(u.indexOf("\?") + 1).match(reg);
    return r != null ? r[2] : "";
  };

  /**
    * 设置图片size
    *
    * @param {HTMLElement} item             图片元素
    * @param {number} widthNum         宽度数值
    * @param {string} widthUnit        宽度单位
    * @param {number} ratio            宽高比
    * @param {boolean} breakParentWidth 是否突破父元素宽度(父元素是否被撑大)
    */
  function setImgSize(item, widthNum, widthUnit, ratio, breakParentWidth) {
    setTimeout(function () {
      var img_padding_border = getOuterW(item) || 0;
      var img_padding_border_top_bottom = getOuterH(item) || 0;

      var isAccessibilityKey = 'isMpUserAccessibility';
      var isAccessMode = window.localStorage.getItem(isAccessibilityKey);

      // 如果设置的宽度超过了父元素最大宽度，则取父元素宽度
      if (widthNum > getParentWidth(item) && !breakParentWidth) {
        widthNum = getParentWidth(item);
      }

      height = (widthNum - img_padding_border) * ratio + img_padding_border_top_bottom;

      if (isIE || '0' === '1' || '' === '1' || isAccessMode === '1') { // 判一下是不是漫画原创，如果是，不走懒加载
        var url = item.getAttribute('data-src');
        item.src = url;

        // 不走懒加载但是需要跟懒加载一样去除占位高度
        item.style.height = 'auto';
      } else {
        if (parseFloat(widthNum, 10) > 40 && height > 40 && breakParentWidth) {
          item.className += ' img_loading';
        }
        item.src = "data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
        widthNum !== 'auto' && (item.style.cssText += ";width: " + widthNum + widthUnit + " !important;");
        widthNum !== 'auto' && (item.style.cssText += ";height: " + height + widthUnit + " !important;");
      }
    }, 10);
  }
  // 图片和视频预加载逻辑，记得H5和秒开要对齐逻辑
  (function () {
    var images = document.getElementsByTagName('img');
    var length = images.length;
    var max_width = getMaxWith();
    for (var i = 0; i < length; ++i) {
      if (window.__second_open__ && images[i].getAttribute('__sec_open_place_holder__')) {
        continue;
      }
      var imageItem = images[i];
      var src_ = imageItem.getAttribute('data-src');
      var realSrc = imageItem.getAttribute('src');
      if (!src_ || realSrc) continue;
      // 图片原始宽度
      var originWidth = imageItem.getAttribute('data-w');
      var ratio_ = 1 * imageItem.getAttribute('data-ratio');

      var height = 100;
      if (ratio_ && ratio_ > 0) {
        var parent_width = getParentWidth(imageItem) || max_width;
        var initWidth = imageItem.style.width || imageItem.getAttribute('width') || originWidth || parent_width;
        initWidth = parseFloat(initWidth, 10) > max_width ? max_width : initWidth;
        // 有attribute或style中的width，写入_width属性，在图片加载完成时写入img标签
        if (initWidth) {
          imageItem.setAttribute('_width', !isNaN(initWidth * 1) ? initWidth + 'px' : initWidth);
        }
        // 使用百分比，则计算出像素宽度
        if (typeof initWidth === 'string' && initWidth.indexOf('%') !== -1) {
          initWidth = parseFloat(initWidth.replace('%', ''), 10) / 100 * parent_width;
        }
        // 使用auto，就是原始宽度
        if (initWidth === 'auto') {
          initWidth = originWidth;
        }

        var widthNum;
        var widthUnit;
        if (initWidth === 'auto') {
          widthNum = 'auto';
        } else {
          var res = /^(\d+(?:\.\d+)?)([a-zA-Z%]+)?$/.exec(initWidth);
          widthNum = res && res.length >= 2 ? res[1] : 0;
          widthUnit = res && res.length >= 3 && res[2] ? res[2] : 'px';
        }

        // 试探一下parent宽度在设置了图片的大小之后是否会变化
        setImgSize(imageItem, widthNum, widthUnit, ratio_, true);
        // 真正设置宽高
        (function (item, widthNumber, unit, ratio) {
          setTimeout(function () {
            setImgSize(item, widthNumber, unit, ratio, false);
          });
        })(imageItem, widthNum, widthUnit, ratio_);
      } else {
        imageItem.style.cssText += ";visibility: hidden !important;";
      }
  }
  })();
  window.__videoDefaultRatio = 16 / 9;//默认值是16/9
  window.__getVideoWh = function (dom) {
    var max_width = getMaxWith(),
      width = max_width,
      ratio_ = dom.getAttribute('data-ratio') * 1,//mark16/9
      arr = [4 / 3, 16 / 9],
      ret = arr[0],
      abs = Math.abs(ret - ratio_);
    if (!ratio_) { // 没有比例
      if (dom.getAttribute("data-mpvid")) { // MP视频
        ratio_ = 16 / 9;
      } else { // 非MP视频，需要兼容历史图文
        ratio_ = 4 / 3;
      }
    } else { // 有比例，则判断更接近4/3还是更接近16/9
      for (var j = 1, jl = arr.length; j < jl; j++) {
        var _abs = Math.abs(arr[j] - ratio_);
        if (_abs < abs) {
          abs = _abs;
          ret = arr[j];
        }
      }
      ratio_ = ret;
    }

    var parent_width = getParentWidth(dom) || max_width,
      width = width > parent_width ? parent_width : width,
      outerW = getOuterW(dom) || 0,
      outerH = getOuterH(dom) || 0,
      videoW = width - outerW,
      videoH = videoW / ratio_,
      speedDotH = 12, // 播放器新样式的进度条在最下面，为了避免遮住拖动的点点，需要额外设置高一些
      height = videoH + outerH + speedDotH;

    return { w: Math.ceil(width), h: Math.ceil(height), vh: videoH, vw: videoW, ratio: ratio_, sdh: speedDotH };
  };

  // 图片和视频预加载逻辑，记得H5和秒开要对齐逻辑
  (function () {
    var iframe = document.getElementsByTagName('iframe');
    for (var i = 0, il = iframe.length; i < il; i++) {
      if (window.__second_open__ && iframe[i].getAttribute('__sec_open_place_holder__')) {
        continue;
      }
      var a = iframe[i];
      var src_ = a.getAttribute('src') || a.getAttribute('data-src') || "";

      if (!/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(src_)
        && !/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/.test(src_)
      ) {
        continue;
      }
      var vid = getQuery("vid", src_);
      if (!vid) {
        continue;
      }
      vid = vid.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");//清除前后空格
      a.removeAttribute('src');
      a.style.display = "none";
      var obj = window.__getVideoWh(a),
        videoPlaceHolderSpan = document.createElement('span'),
        videoPlayerIconSpan = document.createElement('span'),
        mydiv = document.createElement('img');

      videoPlaceHolderSpan.className = "js_img_loading db";
      videoPlaceHolderSpan.setAttribute("data-vid", vid);
      // videoPlaceHolderSpan.style.display = 'block';

      videoPlayerIconSpan.className = 'wx_video_context db'; // 预加载的视频封面图占位
      videoPlayerIconSpan.style.display = 'none';
      videoPlayerIconSpan.innerHTML = '<span class="wx_video_thumb_primary"></span><button class="wx_video_play_btn">播放</button><span class="wx_video_mask"></span>'; // 曝光后设置这里img的src

      mydiv.className = "img_loading";

      mydiv.src = "data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
      // mydiv.style.cssText += ';height:100%;width:100%;';
      // mydiv.setAttribute("data-vid",vid);
      videoPlaceHolderSpan.style.cssText = "width: " + obj.w + "px !important;";
      mydiv.style.cssText += ";width: " + obj.w + "px";
      videoPlaceHolderSpan.appendChild(videoPlayerIconSpan);
      videoPlaceHolderSpan.appendChild(mydiv);

      insertAfter(videoPlaceHolderSpan, a); // 在视频后面插入占位

      /* var parentNode = a.parentNode;
      var copyIframe = a;
      var index = i; */

      // 由于视频需要加一个转载的来源，所以这里需要提前设置高度
      function ajax(obj) {
        var url = obj.url;
        var xhr = new XMLHttpRequest();

        var data = null;
        if (typeof obj.data == "object") {
          var d = obj.data;
          data = [];
          for (var k in d) {
            if (d.hasOwnProperty(k)) {
              data.push(k + "=" + encodeURIComponent(d[k]));
            }
          }
          data = data.join("&");
        } else {
          data = typeof obj.data == 'string' ? obj.data : null;
        }

        xhr.open('POST', url, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4) {
            if (xhr.status >= 200 && xhr.status < 400) {
              obj.success && obj.success(xhr.responseText);
            } else {
              obj.error && obj.error(xhr);
            }
            obj.complete && obj.complete();
            obj.complete = null;
          }
        };
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
        xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
        xhr.send(data);
      }

      var mid = "" || "" || "2652258570";
      var biz = "" || "MjM5Mzg0NDkyMA==";
      var sessionid = "" || "svr_781e786cd50";
      var idx = "";

      (function sendReq(parentNode, copyIframe, index, vid) {
        ajax({
          url: '/mp/videoplayer?vid=' + vid + '&mid=' + mid + '&idx=1&__biz=' + biz + '&sessionid=' + sessionid + '&f=json',
          type: "GET",
          dataType: 'json',
          success: function (json) {
            var ret = JSON.parse(json || '{}');
            var ori = ret.ori_status;
            var hit_biz_headimg = ret.hit_biz_headimg + '/64';
            var hit_nickname = ret.hit_nickname;
            var hit_username = ret.hit_username;
            var sourceBiz = ret.source_encode_biz;

            var selfUserName = "gh_9807c6f6ba23";

            if (ori === 2 && selfUserName !== hit_username) {
              var videoBar = document.createElement('div');
              var videoBarHtml = '<div class="wx-edui-video_source_link js_wx_tap_highlight wx_tap_card" id="' + (hit_username + index) + '" data-hit-username="' + hit_username + '" data-hit-biz="' + sourceBiz + '">';
              videoBarHtml += '<div class="wx-edui-video_source_word">以下视频来源于</div>';
              videoBarHtml += '<div class="wx-edui-video_account_info">';
              videoBarHtml += '<div class="wx-edui-video_account_avatar" id="' + (hit_biz_headimg + index) + '" src="https://images.weserv.nl/?url=' + hit_biz_headimg + '"></div>';
              videoBarHtml += '<div class="wx-edui-video_account_name">' + hit_nickname + '</div>';
              videoBarHtml += '<i class="wx-edui-video_account_arrow"></i>';
              videoBarHtml += '</div>';
              videoBarHtml += '<div class="wx-edui-video_source_link__layer_mask"></div>';
              videoBarHtml += '</div>';
              videoBar.innerHTML = videoBarHtml;
              var spanContainer = document.getElementById('js_mp_video_container_' + index);
              if (spanContainer) {
                spanContainer.parentNode.insertBefore(videoBar, spanContainer);
              } else if (parentNode.contains && parentNode.contains(copyIframe)) {
                parentNode.insertBefore(videoBar, copyIframe);
              } else {
                parentNode.insertBefore(videoBar, parentNode.firstElementChild);
              }
              var avatorEle = document.getElementById(hit_biz_headimg + index);
              var avatorSrc = avatorEle.dataset.src;
              console.log('avatorSrc' + avatorSrc);
              if (ret.hit_biz_headimg) {
                avatorEle.style.backgroundImage = 'url(' + avatorSrc + ')';
              }
            }
          },
          error: function (xhr) {
          }
        });
      })(a.parentNode, a, i, vid);

      a.style.cssText += ";width: " + obj.w + "px !important;";
      a.setAttribute("width", obj.w);
      if (window.__zoom != 1) {
        a.style.display = "block";
        videoPlaceHolderSpan.style.display = "none";
        a.setAttribute("_ratio", obj.ratio);
        a.setAttribute("_vid", vid);
      } else {
        videoPlaceHolderSpan.style.cssText += "height: " + (obj.h - obj.sdh) + "px !important;margin-bottom: " + obj.sdh + "px !important;";
        mydiv.style.cssText += "height: " + (obj.h - obj.sdh) + "px !important;";
        a.style.cssText += "height: " + obj.h + "px !important;";
        a.setAttribute("height", obj.h);
      }
      a.setAttribute("data-vh", obj.vh);
      a.setAttribute("data-vw", obj.vw);
      if (a.getAttribute("data-mpvid")) {
        a.setAttribute("data-src", location.protocol + "//mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&auto=0&vid=" + vid);
      } else {
        a.setAttribute("data-src", location.protocol + "//v.qq.com/iframe/player.html?vid=" + vid + "&width=" + obj.vw + "&height=" + obj.vh + "&auto=0");
      }
    }
  })();

  (function () {
    if (window.__zoom != 1) {
      if (!window.__second_open__) {
        document.getElementById('page-content').style.zoom = window.__zoom;
        var a = document.getElementById('activity-name');
        var b = document.getElementById('meta_content');
        if (!!a) {
          a.style.zoom = 1 / window.__zoom;
        }
        if (!!b) {
          b.style.zoom = 1 / window.__zoom;
        }
      }
      var images = document.getElementsByTagName('img');
      for (var i = 0, il = images.length; i < il; i++) {
        if (window.__second_open__ && images[i].getAttribute('__sec_open_place_holder__')) {
          continue;
        }
        images[i].style.zoom = 1 / window.__zoom;
      }
      var iframe = document.getElementsByTagName('iframe');
      for (var i = 0, il = iframe.length; i < il; i++) {
        if (window.__second_open__ && iframe[i].getAttribute('__sec_open_place_holder__')) {
          continue;
        }
        var a = iframe[i];
        a.style.zoom = 1 / window.__zoom;
        var src_ = a.getAttribute('data-src') || "";
        if (!/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(src_)
          && !/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/.test(src_)
        ) {
          continue;
        }
        var ratio = a.getAttribute("_ratio");
        var vid = a.getAttribute("_vid");
        a.removeAttribute("_ratio");
        a.removeAttribute("_vid");
        var vw = a.offsetWidth - (getOuterW(a) || 0);
        var vh = vw / ratio;
        var h = vh + (getOuterH(a) || 0)
        a.style.cssText += "height: " + h + "px !important;"
        a.setAttribute("height", h);
        if (/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(src_)) {
          a.setAttribute("data-src", location.protocol + "//v.qq.com/iframe/player.html?vid=" + vid + "&width=" + vw + "&height=" + vh + "&auto=0");
        }
        a.style.display = "none";
        var parent = a.parentNode;
        if (!parent) {
          continue;
        }
        for (var j = 0, jl = parent.children.length; j < jl; j++) {
          var child = parent.children[j];
          if (child.className.indexOf("img_loading") >= 0 && child.getAttribute("data-vid") == vid) {
            child.style.cssText += "height: " + h + "px !important;";
            child.style.display = "";
          }
        }
      }
    }
  })();
})();
</script><script type="text/javascript" nonce="1738606354" reportloaderror>!function(){"use strict";var t={defaultContentTpl:'<span class="js_img_loading db" style="width:#width#px !important;height:#height#px !important;text-indent: 0"><img style="width:#width#px !important;height:#height#px !important;border-radius:#borderRadius#px;" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="></span>',config:[{querySelector:"redpacketcover",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return decodeURIComponent(t.node.getAttribute("data-coveruri")||"")},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return.7854*t.parentWidth},calH:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.calW({parentWidth:t.parentWidth})/.73346+27+37},replaceContentCssText:"",appendContentCssText:"display: inline-block;position: relative;",outerContainerLeft:'<section style="display:block;font-size:0;text-align:center;margin:16px 0;">',outerContainerRight:"</section>"},{querySelector:"qqmusic",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t.node.getAttribute("musicid")||"").replace(/^\s/,"").replace(/\s$/,"")+"_"+t.index},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){return 88},replaceContentCssText:"",appendContentCssText:"margin:16px 0;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mpvoice",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=decodeURIComponent(t.node.getAttribute("voice_encode_fileid")||"").replace(/^\s/,"").replace(/\s$/,"");return e+"_"+t.index},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){return 122},replaceContentCssText:"",appendContentCssText:"margin:16px 0;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mppoi",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.node.getAttribute("data-id")||""},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){return 219},replaceContentCssText:"",appendContentCssText:"margin:16px 0;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mpsearch",genId:function(){return decodeURIComponent("mpsearch")},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){return 100},replaceContentCssText:"",appendContentCssText:"margin:16px 0;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mpvideosnap",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node.getAttribute("data-type")||"video";return"live"===e?decodeURIComponent(t.node.getAttribute("data-noticeid")||""):decodeURIComponent(t.node.getAttribute("data-id")||"")},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node.getAttribute("data-type")||"video",n=t.node.getAttribute("data-width")||"",r=t.node.getAttribute("data-height")||"";if("live"===e||"topic"===e)return t.parentWidth;if("image"===e)return.665*t.parentWidth;var i=1,o=0,a=0,d=!1;return 1===(i=n/r)||i===3/4||(i===4/3||i===16/9?d=!0:i<3/4?i=3/4:i>1&&i<4/3?i=1:i>4/3?d=!0:("number"!=typeof i||Object.is(i,NaN))&&(i=1)),t.node.setAttribute("data-datio",i),t.node.setAttribute("data-isHorizontal",d),o=(a=!0===d?t.parentWidth:window.innerWidth<1024?.65*window.innerWidth:.65*t.parentWidth)/i,t.node.setAttribute("data-computedWidth",a),t.node.setAttribute("data-computedHeight",o),a},calH:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node.getAttribute("data-desc")||"",n=t.node.getAttribute("data-type")||"video",r=t.node.getAttribute("data-computedHeight")||"";switch(n){case"live":return e?152:116;case"topic":return 201;case"image":return e?this.calW(t)+44+35+27:this.calW(t)+44+35;case"video":return parseFloat(r)}},getBorderRadius:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node.getAttribute("data-type")||"video";return"video"===e?4:8},replaceContentCssText:"",appendContentCssText:"margin:16px auto;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mp-wxaproduct",genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return decodeURIComponent(t.node.getAttribute("data-wxaproduct-productid")||"")},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.node.getAttribute("data-wxaproduct-cardtype")||"";return"mini"===e?124:466},replaceContentCssText:"",appendContentCssText:"margin:16px 0;diplay:block;",outerContainerLeft:"",outerContainerRight:""},{querySelector:"mpprofile",genId:function(t){return t.node.getAttribute("data-id")||""},calW:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 1*t.parentWidth},calH:function(){return 143},replaceContentCssText:"",appendContentCssText:"margin:16px 0 16px;diplay:block;",outerContainerLeft:"",outerContainerRight:""}]};!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("function"==typeof document.querySelectorAll)for(var e={maxWith:document.getElementById("img-content").getBoundingClientRect().width,idAttr:"data-preloadingid"},n=0,r=t.config.length;n<r;n++)for(var i=t.config[n],o=document.querySelectorAll(i.querySelector),a=0,d=o.length;a<d;a++){var c=o[a],u=c.parentNode.getBoundingClientRect().width;if(u=Math.min(u,e.maxWith),!c.getAttribute("has-insert-preloading")){var l=i.calW({parentWidth:u,node:c}),p=i.calH({parentWidth:u,node:c}),g=i.genId({index:a,node:c}),s="function"==typeof i.getBorderRadius?i.getBorderRadius({index:a,node:c}):8,h=t.defaultContentTpl.replace(/#height#/g,p).replace(/#width#/g,l).replace(/#borderRadius#/g,s),C=document.createElement("div");if(C.innerHTML=h,i.replaceContentCssText){var f=i.replaceContentCssText.replace(/#height#/g,p).replace(/#width#/g,l);C.firstChild.style.cssText=f}else i.appendContentCssText&&(C.firstChild.style.cssText+=i.appendContentCssText);var v=i.outerContainerLeft+C.innerHTML+i.outerContainerRight;C.innerHTML=v,C.firstChild.setAttribute(e.idAttr,g),c.parentNode.insertBefore(C.firstChild,c.nextSibling),c.setAttribute("has-insert-preloading","1")}}}(t)}();</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
// 白名单的class不能去除
var whiteList = 'rich_pages,blockquote_info,blockquote_biz,blockquote_other,blockquote_article,js_jump_icon,h5_image_link,js_banner_container,js_list_container,js_cover,js_tx_video_container,js_product_err_container,js_product_loop_content,js_product_container,img_loading,list-paddingleft-1,list-paddingleft-2,list-paddingleft-3,selectTdClass,noBorderTable,ue-table-interlace-color-single,ue-table-interlace-color-double,__bg_gif,weapp_text_link,weapp_image_link,js_img_loading,wx_video_context,db,wx_video_thumb_primary,wx_video_play_btn,wx_video_mask,qqmusic_area,tc,tips_global,unsupport_tips,qqmusic_wrp,appmsg_card_context,appmsg_card_active,wx_tap_card,js_wx_tap_highlight,wx_tap_link,qqmusic_bd,play_area,icon_qqmusic_switch,pic_qqmusic_default,qqmusic_thumb,access_area,qqmusic_songname,qqmusic_singername,qqmusic_source,js_audio_frame,share_audio_context,flex_context,pages_reset,share_audio_switch,icon_share_audio_switch,share_audio_info,flex_bd,share_audio_title,share_audio_tips,share_audio_progress_wrp,share_audio_progress,share_audio_progress_inner,share_audio_progress_buffer,share_audio_progress_loading,share_audio_progress_loading_inner,share_audio_progress_handle,share_audio_desc,share_audio_length_current,share_audio_length_total,video_iframe,vote_iframe,js_editor_vote_card,res_iframe,card_iframe,js_editor_card,weapp_display_element,js_weapp_display_element,weapp_card,app_context,weapp_card_bd,weapp_card_profile,radius_avatar,weapp_card_avatar,weapp_card_nickname,weapp_card_info,weapp_card_title,weapp_card_thumb_wrp,weapp_card_ft,weapp_card_logo,js_pay_btn,pay,pay__mask,wx_video_loading,js_redpacketcover,js_uneditable,js_uneditablemouseover,js_editor_qqmusic,js_editor_audio,ct_geography_loc_tip,js_poi_entry,subsc_context,subsc_btn,reset_btn,js_subsc_btn,icon_subsc'.split(',');
var qaClassPrefix = 'qa__';
var whiteListReg = [
  new RegExp("^wxw"),
  new RegExp("^weui"),
  new RegExp("^appmsg"),
  new RegExp("^audio"),
  new RegExp("^music"),
  new RegExp("^cps_inner"),
  new RegExp("^bizsvr_"), // 后台压缩样式
  new RegExp("^code-snippet"), // 代码块样式
  new RegExp("^" + qaClassPrefix), // 问答卡片样式
  new RegExp("^wx-edui-"), // 图文编辑器相关样式统一前缀
  new RegExp("^wx_"), // 微信样式统一前缀
  new RegExp("^wx-"), // 微信样式统一前缀
  new RegExp('^js_darkmode__'), // 暗黑模式统一前缀
  new RegExp('^js_wechannel'), // 视频号统一前缀
];
</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
function htmlDecode(str) {
  return str
    .replace(/&#39;/g, '\'')
    .replace(/<br\s*(\/)?\s*>/g, '\n')
    .replace(/&nbsp;/g, ' ')
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&quot;/g, '"')
    .replace(/&amp;/g, '&')
    .replace(/&nbsp;/g, ' ');
}

var uin = '';
var key = '';
var pass_ticket = '';
var new_appmsg = 1;
var item_show_type = "0";
var real_item_show_type = "0";
var can_see_complaint = "0";
var tid = "";
var aid = "";
var clientversion = "";
var appuin = "" || "MjM5Mzg0NDkyMA==";
var voiceid = "";

var source = "";
var ascene = "";
var subscene = "";
var sessionid = "" || "svr_781e786cd50";
var abtest_cookie = "";

var scene = 75;

var itemidx = "";
var appmsg_token = "";
var _copyright_stat = "0";
var _ori_article_type = "";

var is_follow = "";
var nickname = "唧唧堂";
var appmsg_type = "9";
var ct = "1651923081";
var user_name = "gh_9807c6f6ba23";
var fakeid = "";
var version = "";
var is_limit_user = "0";
var round_head_img = "http://mmbiz.qpic.cn/mmbiz_png/JYKDNBjmXRHbR1nWNJOTuAkWjddBZicibmTab1G8tdOQ1GjgDFPlkNibvod1ejmkngtXvxCstcuyd6gMfzGX5XOGw/0?wx_fmt=png";
var hd_head_img = "http://wx.qlogo.cn/mmhead/Q3auHgzwzM75okUZdhsz5I14VjKJrr4YemfAkPJoxCD8Kao4hcx8Nw/0" || "";
var ori_head_img_url = "http://wx.qlogo.cn/mmhead/Q3auHgzwzM75okUZdhsz5I14VjKJrr4YemfAkPJoxCD8Kao4hcx8Nw/132";
var msg_title = '唧唧堂：MSOM 制造与服务运营管理期刊 2022年1-2月论文摘要39篇'.html(false);
var msg_desc = htmlDecode("唧唧堂论文导读，读懂各领域最新最热最经典论文！");
var msg_cdn_url = "http://mmbiz.qpic.cn/mmbiz_jpg/JYKDNBjmXRGp4kXGYstQQPKUvbFNtqr2dlDOib3OxxpKueicqQiauDuJt1M233nx8QxrxTZ7k7ib6cRM33WfIuHRYA/0?wx_fmt=jpeg"; // 首图idx=0时2.35:1 ， 次图idx!=0时1:1
var cdn_url_1_1 = "https://mmbiz.qlogo.cn/mmbiz_jpg/JYKDNBjmXRGp4kXGYstQQPKUvbFNtqr2dlDOib3OxxpKueicqQiauDuJt1M233nx8QxrxTZ7k7ib6cRM33WfIuHRYA/0?wx_fmt=jpeg"; // 1:1比例的封面图
var cdn_url_235_1 = "https://mmbiz.qlogo.cn/mmbiz_jpg/JYKDNBjmXRGp4kXGYstQQPKUvbFNtqr2eICH77dwokuVNZzMwZy4yZEfeGV6dn6VHy2sicIUKoMMswkwvzKT4nA/0?wx_fmt=jpeg"; // 首图idx=0时2.35:1 ， 次图idx!=0时1:1
// var msg_link = "http://mp.weixin.qq.com/s?__biz=MjM5Mzg0NDkyMA==\x26amp;mid=2652258570\x26amp;idx=3\x26amp;sn=983433c51ef56b5df1cfbc3d4834c3cf\x26amp;chksm=bd723add8a05b3cb995df9e77b39a61084eceec7f782eb273c6437427987111e3a004341db1e#rd";
var msg_link = "http://mp.weixin.qq.com/s?__biz=MjM5Mzg0NDkyMA==&amp;mid=2652258570&amp;idx=3&amp;sn=983433c51ef56b5df1cfbc3d4834c3cf&amp;chksm=bd723add8a05b3cb995df9e77b39a61084eceec7f782eb273c6437427987111e3a004341db1e#rd"; // @radeonwu
var user_uin = "" * 1;
var msg_source_url = 'https://appxodb2mbh5833.h5.xiaoeknow.com/';
var img_format = 'jpeg';
var srcid = '';
var req_id = '2805rdLhBrHiMECvXEqETZhn';
var networkType;
var appmsgid = "2652258570" || '' || '';
var comment_id = "2387914753949401089" || "2387914753949401089" * 1;
var comment_enabled = "" * 1;
var open_fansmsg = "0" * 1;
var is_https_res = ("" * 1) && (location.protocol == "https:");
var msg_daily_idx = "1" || "";
var profileReportInfo = "" || "";

var devicetype = "";
var source_encode_biz = ""; // 转载来源的公众号encode biz
var source_username = "";
// var profile_ext_signature = "" || "";
var reprint_ticket = "";
var source_mid = "";
var source_idx = "";
var source_biz = "";
var author_id = "";

// 关注组件灰度实验
var is_like_profile_gray = (function() {
  return (Math.floor(user_uin / 383) % 100) <= 1; // 灰度50%
})(); 
if(user_uin === 3190046805 || user_uin === 1808514905) {
  is_like_profile_gray  = false;
}
if(user_uin === 594425220 || user_uin === 3194185190|| user_uin === 3190046801 || user_uin ===  245916855 || user_uin === 2453457861) {
  is_like_profile_gray  = true;
}

console.log('is_like_profile_gray' + is_like_profile_gray)
// 压缩标志位
var optimizing_flag = "0" * 1;

// 广告灰度实验取消 @add by scotthuang
// var ad_abtest_padding = "0" * 1;

var show_comment = "";
var __appmsgCgiData = {
  wxa_product: "" * 1,
  wxa_cps: "" * 1,
  show_msg_voice: "0" * 1,
  can_use_page: "" * 1,
  is_wxg_stuff_uin: "0" * 1,
  card_pos: "",
  copyright_stat: "0",
  source_biz: "",
  hd_head_img: "http://wx.qlogo.cn/mmhead/Q3auHgzwzM75okUZdhsz5I14VjKJrr4YemfAkPJoxCD8Kao4hcx8Nw/0" || (window.location.protocol + "//" + window.location.host + "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_rumor_link.2x5e2e9e.jpg"),
  has_red_packet_cover: "0" * 1 || 0,
  minishopCardData: ""
};
var _empty_v = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/pages/voice/empty5e2e9e.mp3";
var appmsg_album_info = (function () {
  var curAlbumId = '';
  var publicTagInfo = [
              ];
  for (var i = 0; i < publicTagInfo.length; i++) {
    if (curAlbumId) {
      if (curAlbumId === publicTagInfo[i].id) {
        return publicTagInfo[i];
      }
    } else {
      if (publicTagInfo[i].continousReadOn) {
        return publicTagInfo[i];
      }
    }
  }
  return {};
})();
var copyright_stat = "0" * 1;
var hideSource = "" * 1;

var pay_fee = "" * 1;
var pay_timestamp = "";
var need_pay = "" * 1;
var is_pay_subscribe = "0" * 1;

var need_report_cost = "0" * 1;
var use_tx_video_player = "0" * 1;
var appmsg_fe_filter = "contenteditable";

var friend_read_source = "" || "";
var friend_read_version = "" || "";
var friend_read_class_id = "" || "";

var is_only_read = "1" * 1;
var read_num = "" * 1;
var like_num = "" * 1;
var liked = "" == 'true' ? true : false;
var is_temp_url = "" ? 1 : 0;
var send_time = "";
var icon_emotion_switch = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch5e2e9e.svg";
var icon_emotion_switch_active = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch_active5e2e9e.svg";
var icon_emotion_switch_primary = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch_primary5e2e9e.svg";
var icon_emotion_switch_active_primary = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch_active_primary5e2e9e.svg";
var icon_loading_white = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/common/icon_loading_white5e2e9e.gif";
var icon_audio_unread = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/audio/icon_audio_unread5e2e9e.png";
var icon_qqmusic_default = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/qqmusic/icon_qqmusic_default.2x5e2e9e.png";
var icon_qqmusic_source = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/qqmusic/icon_qqmusic_source5e2e9e.svg";
var icon_kugou_source = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/kugou/icon_kugou_source5e2e9e.png";

var topic_default_img = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/topic/pic_book_thumb.2x5e2e9e.png';
var comment_edit_icon = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg_new/icon_edit5e2e9e.png';
var comment_loading_img = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/common/icon_loading_white5e2e9e.gif';
var comment_c2c_not_support_img = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_discuss_more5e2e9e.png';

var voice_in_appmsg = {
  "1": "1"
  };
var voiceList = {};
voiceList={"voice_in_appmsg":[]}
var reprint_style = '' * 1;
var wxa_img_alert = "" != 'false';

// 小程序相关数据
var weapp_sn_arr_json = "" || "";

// 视频号相关数据
var video_snap_json = "" || "";
// profile相关数据
var mp_profile = [
  ];

// 能力封禁字段
var ban_scene = "0" * 1;

var svr_time = "1653685288" * 1;
// 加迁移文章字段, 默认为false
var is_transfer_msg = "" * 1 || 0;

var malicious_title_reason_id = "0" * 1; // 标题党wording id @radeonwu
var malicious_content_type = "0" * 1; // 标题党类型 @radeonwu

// 修改错别字逻辑
var modify_time = "";

// 限制跳转到公众号profile @radeonwu
var isprofileblock = "0";

var jumpInfo = [
    ];

var hasRelatedArticleInfo = '0' * 1 || 0; // 有相关阅读的数据 @radeonwu
var relatedArticleFlag = '' * 1 || 0; // 0不用拓展，为1时拓展3条 @yinshen

var canUseAutoTypeSetting = '0' * 1 || 0; // 可以应用到自动排版样式
window.wxtoken = "777";
window.is_login = '' * 1; // 把上面的那段代码改一下，方便配置回退

window.__moon_initcallback = function () {
  if (!!window.__initCatch) {
    window.__initCatch({
      idkey: 27611 + 2,
      startKey: 0,
      limit: 128,
      badjsId: 43,
      reportOpt: {
        uin: uin,
        biz: biz,
        mid: mid,
        idx: idx,
        sn: sn
      },
      extInfo: {
        network_rate: 0.01,    //网络错误采样率
        badjs_rate: 0.1 // badjs上报叠加采样率
      }
    });
  }
}
// msg_title != title
var title = "唧唧堂";

var is_new_msg = true;
// var appmsg_like_type = "2" * 1 ? "2" * 1 : 1; //区分点赞和看一看
// var appmsg_like_type = 2;

var is_wash = '' * 1;
var topbarEnable = false;
var enterid = "" * 1 || "" * 1 || parseInt(Date.now() / 1000);
// var appid_list = ""; // 改图文所在的小程序的appid列表，只在小程序中使用
var miniprogram_appid = ""; // 该图文所在的小程序的appid

var defaultAvatarUrl = '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/common/avatar_default5e2e9e.svg';

document.addEventListener('DOMContentLoaded', function () {
  window.domCompleteTime = Date.now();
});

// 记录是否有转载推荐语
      var hasRecommendMsg = 0;
  ;
// 付费阅读
var isPayTopic = '' * 1;
  var payTopicPrice = '' * 1;
var isRemovedFromPayTopic = '' * 1;
var isPaySubscribe = '0' * 1; // 是否付费文章
var isPaid = '0' * 1; // 是否已付费
var isRefund = '' * 1; // 是否已退款
var payShowIAPPrice = 1; // 是否启用IAP价格显示，用于外币显示
var payProductId = '' || ''; // 付费金额对应商品ID，用于iOS多币种金额IAP查询
var previewPercent = '0' || ''; // 试读比例
var payGiftsCount = '0' * 1 || 0; // 付费赠送数量
var payFreeGift = '' * 1 || 0; // 是否是领取付费赠送的用户
var is_finished_preview = 0; // 是否试读完
var jump2pay = '' * 1; // 是否跳转到支付按钮的位置

var isFans; // getext里获取数据再塞到这里
var is_need_reward = (isPaySubscribe && !isPaid) ? 0 : "0" * 1; // 非付费不可赞赏
var is_teenager = '' * 1 || 0; //是否处于青少年模式
var is_care_mode = '' * 1 || 0; //是否处于关怀模式

// 段落投诉
var anchor_tree_msg = '';
// Dark Mode
var colorScheme = ''; // ''|'dark'|'light', 空表示跟随系统

var iapPriceInfo = {
  };
var productPayPackage = {
    iap_price_info: iapPriceInfo
};

// 漫画原创
var isCartoonCopyright = '0' * 1; // 是否漫画原创

// 图文朗读
var show_msg_voice = '' * 1;
var qnaCardData = '';
var exptype = '' || '';
var expsessionid = '' || '';

// 留言相关
var goContentId = '';
var goReplyId = '';

var show_related_article = '' * 1; // 是否强制出相关阅读

var wwdistype = ''; // 企微场景，industrynews表示行业资讯

// 腾讯视频相关
window.cgiData = {
  appImg: '//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/pages/video/pic_v.2x5e2e9e.png',
}

window.ip_wording = {
  countryName: '中国',
  countryId: '156',
  provinceName: '上海',
  provinceId: '',
  cityName: '',
  cityId: ''
};
window.show_ip_wording = '1' * 1;
</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
// 企业微信里置灰公众号名称
(function() {
  if (window.is_like_profile_gray) {
    var activityDetail = document.getElementById('activity-detail');
    if (activityDetail) {
      activityDetail.classList.add('page_bottom_primary');
    }
  }
})();
</script><script type="text/javascript" nonce="1738606354" reportloaderror>var __INLINE_SCRIPT__=function(){"use strict";var n=function(n){var i=document.getElementById("js_ip_wording_wrp"),o=document.getElementById("js_ip_wording");if(n&&(window.ip_wording={countryName:n.country_name,countryId:n.country_id,provinceName:n.province_name}),window.ip_wording&&i&&o){var r=function(n){var i="";return 156===parseInt(n.countryId,10)?i=n.provinceName:n.countryId&&(i=n.countryName),i}(window.ip_wording);""!==r&&(o.innerHTML=r,i.style.display="inline-block")}};return window.__second_open__||(n(),window.__setIpWording=n),n}();</script><script type="text/javascript" nonce="1738606354" reportloaderror>!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Darkmode",[],t):"object"==typeof exports?exports.Darkmode=t():e.Darkmode=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";var n=r(3),a=r(6),o=[].slice,i=["keyword","gray","hex"],l={};Object.keys(a).forEach((function(e){l[o.call(a[e].labels).sort().join("")]=e}));var s={};function u(e,t){if(!(this instanceof u))return new u(e,t);if(t&&t in i&&(t=null),t&&!(t in a))throw new Error("Unknown model: "+t);var r,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof u)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var h=n.get(e);if(null===h)throw new Error("Unable to parse color from string: "+e);this.model=h.model,c=a[this.model].channels,this.color=h.value.slice(0,c),this.valpha="number"==typeof h.value[c]?h.value[c]:1}else if(e.length){this.model=t||"rgb",c=a[this.model].channels;var f=o.call(e,0,c);this.color=d(f,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var g=Object.keys(e);"alpha"in e&&(g.splice(g.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var b=g.sort().join("");if(!(b in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[b];var p=a[this.model].labels,y=[];for(r=0;r<p.length;r++)y.push(e[p[r]]);this.color=d(y)}if(s[this.model])for(c=a[this.model].channels,r=0;r<c;r++){var m=s[this.model][r];m&&(this.color[r]=m(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function c(e,t,r){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=r})),e=e[0],function(n){var a;return arguments.length?(r&&(n=r(n)),(a=this[e]()).color[t]=n,a):(a=this[e]().color[t],r&&(a=r(a)),a)}}function h(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e){return Array.isArray(e)?e:[e]}function d(e,t){for(var r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in n.to?this:this.rgb(),r=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return n.to[t.model](r)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),r=1===t.valpha?t.color:t.color.concat(this.valpha);return n.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=a[this.model].channels,r=a[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new u(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:c("rgb",0,h(255)),green:c("rgb",1,h(255)),blue:c("rgb",2,h(255)),hue:c(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:c("hsl",1,h(100)),lightness:c("hsl",2,h(100)),saturationv:c("hsv",1,h(100)),value:c("hsv",2,h(100)),chroma:c("hcg",1,h(100)),gray:c("hcg",2,h(100)),white:c("hwb",1,h(100)),wblack:c("hwb",2,h(100)),cyan:c("cmyk",0,h(100)),magenta:c("cmyk",1,h(100)),yellow:c("cmyk",2,h(100)),black:c("cmyk",3,h(100)),x:c("xyz",0,h(100)),y:c("xyz",1,h(100)),z:c("xyz",2,h(100)),l:c("lab",0,h(100)),a:c("lab",1),b:c("lab",2),keyword:function(e){return arguments.length?new u(e):a[this.model].keyword(this.color)},hex:function(e){return arguments.length?new u(e):n.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return u.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r=(r+e)%360)<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),n=this.rgb(),a=void 0===t?.5:t,o=2*a-1,i=r.alpha()-n.alpha(),l=((o*i==-1?o:(o+i)/(1+o*i))+1)/2,s=1-l;return u.rgb(l*r.red()+s*n.red(),l*r.green()+s*n.green(),l*r.blue()+s*n.blue(),r.alpha()*a+n.alpha()*(1-a))}},Object.keys(a).forEach((function(e){if(-1===i.indexOf(e)){var t=a[e].channels;u.prototype[e]=function(){if(this.model===e)return new u(this);if(arguments.length)return new u(arguments,e);var r="number"==typeof arguments[t]?t:this.valpha;return new u(f(a[this.model][e].raw(this.color)).concat(r),e)},u[e]=function(r){return"number"==typeof r&&(r=d(o.call(arguments),t)),new u(r,e)}}})),e.exports=u},function(e,t,r){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,r){var n=r(7),a={};for(var o in n)n.hasOwnProperty(o)&&(a[n[o]]=o);var i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in i)if(i.hasOwnProperty(l)){if(!("channels"in i[l]))throw new Error("missing channels property: "+l);if(!("labels"in i[l]))throw new Error("missing channel labels property: "+l);if(i[l].labels.length!==i[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=i[l].channels,u=i[l].labels;delete i[l].channels,delete i[l].labels,Object.defineProperty(i[l],"channels",{value:s}),Object.defineProperty(i[l],"labels",{value:u})}i.rgb.hsl=function(e){var t,r,n=e[0]/255,a=e[1]/255,o=e[2]/255,i=Math.min(n,a,o),l=Math.max(n,a,o),s=l-i;return l===i?t=0:n===l?t=(a-o)/s:a===l?t=2+(o-n)/s:o===l&&(t=4+(n-a)/s),(t=Math.min(60*t,360))<0&&(t+=360),r=(i+l)/2,[t,100*(l===i?0:r<=.5?s/(l+i):s/(2-l-i)),100*r]},i.rgb.hsv=function(e){var t,r,n,a,o,i=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(i,l,s),c=u-Math.min(i,l,s),h=function(e){return(u-e)/6/c+.5};return 0===c?a=o=0:(o=c/u,t=h(i),r=h(l),n=h(s),i===u?a=n-r:l===u?a=1/3+t-n:s===u&&(a=2/3+r-t),a<0?a+=1:a>1&&(a-=1)),[360*a,100*o,100*u]},i.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[i.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(r,n))),100*(n=1-1/255*Math.max(t,Math.max(r,n)))]},i.rgb.cmyk=function(e){var t,r=e[0]/255,n=e[1]/255,a=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-a)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-a-t)/(1-t)||0),100*t]},i.rgb.keyword=function(e){var t=a[e];if(t)return t;var r,o,i,l=1/0;for(var s in n)if(n.hasOwnProperty(s)){var u=n[s],c=(o=e,i=u,Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)+Math.pow(o[2]-i[2],2));c<l&&(l=c,r=s)}return r},i.keyword.rgb=function(e){return n[e]},i.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),r=t[0],n=t[1],a=t[2];return n/=100,a/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},i.hsl.rgb=function(e){var t,r,n,a,o,i=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[o=255*s,o,o];t=2*s-(r=s<.5?s*(1+l):s+l-s*l),a=[0,0,0];for(var u=0;u<3;u++)(n=i+1/3*-(u-1))<0&&n++,n>1&&n--,o=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,a[u]=255*o;return a},i.hsl.hsv=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,a=r,o=Math.max(n,.01);return r*=(n*=2)<=1?n:2-n,a*=o<=1?o:2-o,[t,100*(0===n?2*a/(o+a):2*r/(n+r)),100*((n+r)/2)]},i.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,a=Math.floor(t)%6,o=t-Math.floor(t),i=255*n*(1-r),l=255*n*(1-r*o),s=255*n*(1-r*(1-o));switch(n*=255,a){case 0:return[n,s,i];case 1:return[l,n,i];case 2:return[i,n,s];case 3:return[i,l,n];case 4:return[s,i,n];case 5:return[n,i,l]}},i.hsv.hsl=function(e){var t,r,n,a=e[0],o=e[1]/100,i=e[2]/100,l=Math.max(i,.01);return n=(2-o)*i,r=o*l,[a,100*(r=(r/=(t=(2-o)*l)<=1?t:2-t)||0),100*(n/=2)]},i.hwb.rgb=function(e){var t,r,n,a,o,i,l,s=e[0]/360,u=e[1]/100,c=e[2]/100,h=u+c;switch(h>1&&(u/=h,c/=h),n=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(n=1-n),a=u+n*((r=1-c)-u),t){default:case 6:case 0:o=r,i=a,l=u;break;case 1:o=a,i=r,l=u;break;case 2:o=u,i=r,l=a;break;case 3:o=u,i=a,l=r;break;case 4:o=a,i=u,l=r;break;case 5:o=r,i=u,l=a}return[255*o,255*i,255*l]},i.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,a=e[3]/100;return[255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,r*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a))]},i.xyz.rgb=function(e){var t,r,n,a=e[0]/100,o=e[1]/100,i=e[2]/100;return r=-.9689*a+1.8758*o+.0415*i,n=.0557*a+-.204*o+1.057*i,t=(t=3.2406*a+-1.5372*o+-.4986*i)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},i.xyz.lab=function(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},i.lab.xyz=function(e){var t,r,n,a=e[0];t=e[1]/500+(r=(a+16)/116),n=r-e[2]/200;var o=Math.pow(r,3),i=Math.pow(t,3),l=Math.pow(n,3);return r=o>.008856?o:(r-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,[t*=95.047,r*=100,n*=108.883]},i.lab.lch=function(e){var t,r=e[0],n=e[1],a=e[2];return(t=360*Math.atan2(a,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+a*a),t]},i.lch.lab=function(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]},i.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],a=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===a&&(o+=60),o},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var r=.5*(1+~~(e>50));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},i.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var r;return e-=16,[Math.floor(e/36)/5*255,Math.floor((r=e%36)/6)/5*255,r%6/5*255]},i.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},i.rgb.hcg=function(e){var t,r=e[0]/255,n=e[1]/255,a=e[2]/255,o=Math.max(Math.max(r,n),a),i=Math.min(Math.min(r,n),a),l=o-i;return t=l<=0?0:o===r?(n-a)/l%6:o===n?2+(a-r)/l:4+(r-n)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?i/(1-l):0)]},i.hsl.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=1,a=0;return(n=r<.5?2*t*r:2*t*(1-r))<1&&(a=(r-.5*n)/(1-n)),[e[0],100*n,100*a]},i.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=t*r,a=0;return n<1&&(a=(r-n)/(1-n)),[e[0],100*n,100*a]},i.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100;if(0===r)return[255*n,255*n,255*n];var a,o=[0,0,0],i=t%1*6,l=i%1,s=1-l;switch(Math.floor(i)){case 0:o[0]=1,o[1]=l,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=l;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=l,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return a=(1-r)*n,[255*(r*o[0]+a),255*(r*o[1]+a),255*(r*o[2]+a)]},i.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),n=0;return r>0&&(n=t/r),[e[0],100*n,100*r]},i.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return r>0&&r<.5?n=t/(2*r):r>=.5&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},i.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},i.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,n=r-t,a=0;return n<1&&(a=(r-n)/(1-n)),[e[0],100*n,100*a]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,r){var n=r(1),a=r(4),o=Object.hasOwnProperty,i={};for(var l in n)o.call(n,l)&&(i[n[l]]=l);var s=e.exports={to:{},get:{}};function u(e,t,r){return Math.min(Math.max(t,e),r)}function c(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}s.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=s.get.hsl(e),r="hsl";break;case"hwb":t=s.get.hwb(e),r="hwb";break;default:t=s.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},s.get.rgb=function(e){if(!e)return null;var t,r,a,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(a=t[2],t=t[1],r=0;r<3;r++){var l=2*r;i[r]=parseInt(t.slice(l,l+2),16)}a&&(i[3]=parseInt(a,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(a=(t=t[1])[3],r=0;r<3;r++)i[r]=parseInt(t[r]+t[r],16);a&&(i[3]=parseInt(a+a,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(r=0;r<3;r++)i[r]=parseInt(t[r+1],0);t[4]&&(t[5]?i[3]=.01*parseFloat(t[4]):i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:o.call(n,t[1])?((i=n[t[1]])[3]=1,i):null:null;for(r=0;r<3;r++)i[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(t[5]?i[3]=.01*parseFloat(t[4]):i[3]=parseFloat(t[4]))}for(r=0;r<3;r++)i[r]=u(i[r],0,255);return i[3]=u(i[3],0,1),i},s.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(r)?1:r,0,1)]}return null},s.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(r)?1:r,0,1)]}return null},s.to.hex=function(){var e=a(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},s.to.rgb=function(){var e=a(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},s.to.rgb.percent=function(){var e=a(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"},s.to.hsl=function(){var e=a(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},s.to.hwb=function(){var e=a(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},s.to.keyword=function(e){return i[e.slice(0,3)]}},function(e,t,r){"use strict";var n=r(5),a=Array.prototype.concat,o=Array.prototype.slice,i=e.exports=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var l=e[r];n(l)?t=a.call(t,o.call(l)):t.push(l)}return t};i.wrap=function(e){return function(){return e(i(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,r){var n=r(2),a=r(8),o={};Object.keys(n).forEach((function(e){o[e]={},Object.defineProperty(o[e],"channels",{value:n[e].channels}),Object.defineProperty(o[e],"labels",{value:n[e].labels});var t=a(e);Object.keys(t).forEach((function(r){var n=t[r];o[e][r]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var r=e(t);if("object"==typeof r)for(var n=r.length,a=0;a<n;a++)r[a]=Math.round(r[a]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(n),o[e][r].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))})),e.exports=o},function(e,t,r){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,r){var n=r(2);function a(e){var t=function(){for(var e={},t=Object.keys(n),r=t.length,a=0;a<r;a++)e[t[a]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var a=r.pop(),o=Object.keys(n[a]),i=o.length,l=0;l<i;l++){var s=o[l],u=t[s];-1===u.distance&&(u.distance=t[a].distance+1,u.parent=a,r.unshift(s))}return t}function o(e,t){return function(r){return t(e(r))}}function i(e,t){for(var r=[t[e].parent,e],a=n[t[e].parent][e],i=t[e].parent;t[i].parent;)r.unshift(t[i].parent),a=o(n[t[i].parent][i],a),i=t[i].parent;return a.conversion=r,a}e.exports=function(e){for(var t=a(e),r={},n=Object.keys(t),o=n.length,l=0;l<o;l++){var s=n[l];null!==t[s].parent&&(r[s]=i(s,t))}return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"run",(function(){return ye})),r.d(t,"init",(function(){return me})),r.d(t,"convertBg",(function(){return ve})),r.d(t,"extend",(function(){return ke}));var n="(prefers-color-scheme: dark)",a="data_color_scheme_dark",o="".concat(1*new Date).concat(Math.round(10*Math.random())),i="data-darkmode-color-".concat(o),l="data-darkmode-bgcolor-".concat(o),s="data-darkmode-original-color-".concat(o),u="data-darkmode-original-bgcolor-".concat(o),c="data-darkmode-bgimage-".concat(o),h=window.getInnerHeight&&window.getInnerHeight()||window.innerHeight||document.documentElement.clientHeight,f=["TABLE","TR","TD","TH"],d=/ !important$/,g={hasInit:!1,begin:null,showFirstPage:null,error:null,mode:"",whitelist:{tagName:["MPCPS","IFRAME"]},needJudgeFirstPage:!0,delayBgJudge:!1,container:null,cssSelectorsPrefix:"",defaultLightTextColor:"#191919",defaultLightBgColor:"#fff",defaultDarkTextColor:"#a3a3a3",defaultDarkBgColor:"#191919",set:function(e,t,r){var n=t[r];switch(e){case"boolean":"boolean"==typeof n&&(this[r]=n);break;case"string":"string"==typeof n&&""!==n&&(this[r]=n);break;case"function":"function"==typeof n&&(this[r]=n);break;case"dom":n instanceof HTMLElement&&(this[r]=n)}}};function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var v=[],k=[],w=function(){function e(){p(this,e)}return m(e,[{key:"loopTimes",get:function(){return se.loopTimes}},{key:"isDarkmode",get:function(){return de.isDarkmode}},{key:"addCss",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(r?v:k).push(he.genCss(e,t.map((function(e){var t=e.key,r=e.value;return he.genCssKV(t,r)})).join("")))}}]),e}(),x=function(){function e(){p(this,e),b(this,"_plugins",[]),b(this,"length",0),b(this,"loopTimes",0),b(this,"firstPageStyle",""),b(this,"otherPageStyle",""),b(this,"firstPageStyleNoMQ",""),b(this,"otherPageStyleNoMQ","")}return m(e,[{key:"extend",value:function(e){this._plugins.push(new(e(w))),this.length++}},{key:"emit",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this._plugins.forEach((function(t){"function"==typeof t[e]&&t[e].apply(t,r)}))}},{key:"addCss",value:function(e){e?(this.firstPageStyle+=v.join(""),this.firstPageStyleNoMQ+=k.join("")):(this.otherPageStyle+=v.join(""),this.otherPageStyleNoMQ+=k.join(""))}},{key:"resetCss",value:function(){v=[],k=[]}}]),e}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),C(this,"_queue",[]),C(this,"_idx",0),this._prefix=t}var t,r,n;return t=e,(r=[{key:"push",value:function(e){var t="".concat(this._prefix).concat(this._idx++);e.classList.add(t),this._queue.push({el:e,className:t,updated:!g.delayBgJudge})}},{key:"forEach",value:function(e){var t=[];for(this._queue.forEach((function(r,n){r.updated&&(t.unshift(n),M(e)&&e(r.el))}));t.length;)this._queue.splice(t.shift(),1)}},{key:"update",value:function(e){this._queue.forEach((function(t){t.updated||Array.prototype.some.call(e,(function(e){return!(1!==e.nodeType||!e.classList.contains(t.className)||(t.el=e,t.updated=!0,0))}))}))}}])&&_(t.prototype,r),n&&_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,"_stack",[]),S(this,"_idx",0),this._prefix=t}var t,r,n;return t=e,(r=[{key:"push",value:function(e,t){var r="".concat(this._prefix).concat(this._idx++);e.classList.add(r),this._stack.unshift({el:e,className:r,cssKV:t,updated:!g.delayBgJudge})}},{key:"contains",value:function(e,t){var r=e.getBoundingClientRect(),n=[];for(this._stack.forEach((function(e,t){if(e.updated){e.rect||(e.rect=e.el.getBoundingClientRect());var a=e.rect;r.top>=a.bottom||r.bottom<=a.top||r.left>=a.right||r.right<=a.left||n.unshift(t)}}));n.length;){var a=this._stack.splice(n.shift(),1)[0];"function"==typeof t&&t(a)}}},{key:"update",value:function(e){this._stack.forEach((function(t){t.updated||Array.prototype.some.call(e,(function(e){return!(1!==e.nodeType||!e.classList.contains(t.className)||(t.el=e,t.updated=!0,0))}))}))}}])&&P(t.prototype,r),n&&P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,"_firstPageStyle",""),T(this,"_otherPageStyle",""),T(this,"isFinish",!1)}var t,r,o;return t=e,(r=[{key:"genCssKV",value:function(e,t){return"".concat(e,": ").concat(t," !important;")}},{key:"genCss",value:function(e,t){return"".concat("dark"===g.mode?"html.".concat(a," "):"").concat(g.cssSelectorsPrefix&&"".concat(g.cssSelectorsPrefix," "),".").concat(e,"{").concat(t,"}")}},{key:"addCss",value:function(e,t){this[t?"_firstPageStyle":"_otherPageStyle"]+=e,se.addCss(t)}},{key:"writeStyle",value:function(e){!e&&de.isDarkmode&&(this.isFinish=!0);var t=(de.isDarkmode?[{target:this,key:["_firstPageStyle","_otherPageStyle"],needMediaQuery:!0}]:[]).concat([{target:se,key:["firstPageStyle","otherPageStyle"],needMediaQuery:!0},{target:se,key:["firstPageStyleNoMQ","otherPageStyleNoMQ"],needMediaQuery:!1}]).map((function(t){var r=t.target,a=O(t.key,2),o=a[0],i=a[1],l=t.needMediaQuery,s="";e?s=o:(r[i]=r[o]+r[i],r[o]="",s=i);var u=r[s];return u?(r[s]="","dark"!==g.mode&&l?"@media ".concat(n," {").concat(u,"}"):u):""})).join("");t&&document.head.insertAdjacentHTML("beforeend",'<style type="text/css">'.concat(t,"</style>"))}}])&&E(t.prototype,r),o&&E(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I(e){var t;return(t=[e]).concat.apply(t,L(e.querySelectorAll("*")))}var z={"ue-table-interlace-color-single":"#fcfcfc","ue-table-interlace-color-double":"#f7faff"};var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),D(this,"_nodes",[]),D(this,"_firstPageNodes",[]),D(this,"_delayNodes",[]),D(this,"showFirstPage",!1)}var t,r,n;return t=e,(r=[{key:"length",get:function(){return this._nodes.length}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._nodes=e}},{key:"get",value:function(){var e=[];return this._nodes.length?(e=this._nodes,de.isDarkmode&&(this._nodes=[])):this._delayNodes.length?(e=this._delayNodes,this._delayNodes=[]):g.container&&(e=g.container.querySelectorAll("*")),e}},{key:"delay",value:function(){var e=this;Array.prototype.forEach.call(this._nodes,(function(t){return e._delayNodes.push(t)})),this._nodes=[]}},{key:"hasDelay",value:function(){return this._delayNodes.length>0}},{key:"addFirstPageNode",value:function(e){this._firstPageNodes.push(e)}},{key:"showFirstPageNodes",value:function(){this._firstPageNodes.forEach((function(e){return e.style.visibility="visible"})),this.showFirstPage=!0}},{key:"emptyFirstPageNodes",value:function(){this._firstPageNodes=[]}}])&&F(t.prototype,r),n&&F(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),K=r(0),J=r.n(K),$=r(1),H=r.n($);function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}(e,t)||U(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||U(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}H.a.windowtext=[0,0,0],H.a.transparent=[255,255,255,0];var Y=new RegExp(Object.keys(H.a).map((function(e){return"\\b".concat(e,"\\b")})).join("|"),"ig"),Z=/\brgba?\([^)]+\)/i,ee=/\brgba?\([^)]+\)/gi,te=function(e){return e.replace(d,"")},re=function(e,t){return te(e).replace(Y,(function(e){if(!t&&"transparent"===e)return e;var r=H.a[e.toLowerCase()];return"".concat(r.length>3?"rgba":"rgb","(").concat(r.toString(),")")}))},ne=function(e){if(!e||e.length<1)return"";if(1===e.length)return e[0];for(var t=e.shift(),r=e.shift();r;){var n=J()(r);t=J()(t).mix(n,n.alpha()),r=e.shift()}return t},ae=function(e){var t=re(e);return Z.test(t)?t:""},oe=function(e){return(299*e[0]+587*e[1]+114*e[2])/1e3},ie=function(e,t){var r=e/oe(t),n=Math.min(255,t[0]*r),a=Math.min(255,t[1]*r),o=Math.min(255,t[2]*r);return 0===a||255===n||255===o?a=(1e3*e-299*n-114*o)/587:0===n?n=(1e3*e-587*a-114*o)/299:0!==o&&255!==a||(o=(1e3*e-299*n-587*a)/114),J.a.rgb(n,a,o)},le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),X(this,"_idx",0),X(this,"_defaultDarkTextColorRgb",J()(g.defaultDarkTextColor).rgb().array()),X(this,"_defaultDarkBgColorRgb",J()(g.defaultDarkBgColor).rgb().array()),X(this,"_defaultDarkBgColorHSL",J()(g.defaultDarkBgColor).hsl().array()),X(this,"_defaultDarkTextColorBrightness",oe(this._defaultDarkTextColorRgb)),X(this,"_defaultDarkBgColorBrightness",oe(this._defaultDarkBgColorRgb)),X(this,"_defaultDarkBgColorHslBrightness",this._defaultDarkBgColorHSL[2]),X(this,"_maxLimitOffsetBrightness",this._defaultDarkTextColorBrightness-this._defaultDarkBgColorBrightness),X(this,"isDarkmode",!1)}var t,r,n;return t=e,(r=[{key:"_adjustTextBrightness",value:function(e,t){var r=t.rgb().array(),n=t.alpha(),a=oe(r)*n+this._defaultDarkBgColorBrightness*(1-n),o=e.rgb().array(),i=e.hsl().array(),l=e.alpha(),s=oe(o),u=Math.abs(a-s);if(s>=250)return e;if(u>this._maxLimitOffsetBrightness&&a<=this._defaultDarkBgColorBrightness+2)return ie(this._maxLimitOffsetBrightness+a,o).alpha(l);if(u>=65)return e;if(a>=100){if(i[2]>50){i[2]=90-i[2];var c=J.a.hsl.apply(J.a,Q(i)).alpha(l);return this._adjustTextBrightness(c,t)}return ie(Math.min(this._maxLimitOffsetBrightness,a-65),o).alpha(l)}if(i[2]<=40){i[2]=90-i[2];var h=J.a.hsl.apply(J.a,Q(i)).alpha(l);return this._adjustTextBrightness(h,t)}return ie(Math.min(this._maxLimitOffsetBrightness,a+65),o).alpha(l)}},{key:"_adjustBackgroundBrightness",value:function(e){var t=e.rgb().array(),r=e.hsl().array(),n=e.alpha(),a=oe(t),o=e;return 0===r[1]&&r[2]>40||a>250?o=J.a.hsl(0,0,Math.min(100,100+this._defaultDarkBgColorHslBrightness-r[2])):a>190?o=ie(190,t).alpha(n):r[2]<22&&(r[2]=22,o=J.a.hsl.apply(J.a,Q(r))),o.alpha(n).rgb()}},{key:"_adjustBrightness",value:function(e,t,r){var n,a=e.alpha(),o="";if(r.isBgColor){if(t.getAttribute(c)&&a>=.05&&t.removeAttribute(c),n=this._adjustBackgroundBrightness(e),!r.hasInlineColor){var s=t.getAttribute(i)||g.defaultLightTextColor,u=n||e,h=this._adjustBrightness(J()(s),t,{isTextColor:!0,parentElementBgColorStr:u});h.newColor?o+=he.genCssKV("color",h.newColor):o+=he.genCssKV("color",s)}}else if(r.isTextColor||r.isBorderColor){var f=r.parentElementBgColorStr||r.isTextColor&&t.getAttribute(l)||g.defaultDarkBgColor,d=J()(f);t.getAttribute(c)||(n=this._adjustTextBrightness(e,d),se.emit("afterConvertTextColor",t,{fontColor:n,bgColor:d}))}else r.isTextShadow&&(t.getAttribute(c)||(n=this._adjustBackgroundBrightness(e)));return{newColor:n&&e.toString()!==n.toString()&&n.alpha(a).rgb(),extStyle:o}}},{key:"_try",value:function(e){try{return e()}catch(e){console.log("An error occurred when running the dark mode conversion algorithm\n",e),"function"==typeof g.error&&g.error(e)}}},{key:"convert",value:function(e){var t=this;se.resetCss(),se.emit("beforeConvertNode",e);var r,n,a="";if(this.isDarkmode){var o=e.nodeName;if(g.whitelist.tagName.indexOf(o)>-1)return"";var h,b,p=e.style,y="",m=!1,v=!1,k=!1,w=(p.cssText&&p.cssText.split(";")||[]).map((function(e){var t=e.indexOf(":");return[e.slice(0,t).toLowerCase(),e.slice(t+1)].map((function(e){return(e||"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}))})).filter((function(e){var t=R(e,2),r=t[0],n=t[1];return"color"===r?m=!0:/background/i.test(r)&&(v=!0,"background-position"===r?h=n:"background-size"===r&&(b=n)),(/background/i.test(r)||/^(-webkit-)?border-image/.test(r))&&/url\([^)]*\)/i.test(n)&&(k=!0),["-webkit-border-image","border-image","color","background-color","background-image","background","border","border-top","border-right","border-bottom","border-left","border-color","border-top-color","border-right-color","border-bottom-color","border-left-color","-webkit-text-fill-color","-webkit-text-stroke","-webkit-text-stroke-color","text-shadow"].indexOf(r)>-1})).sort((function(e,t){var r=R(e,1)[0],n=R(t,1)[0];return"color"===r||"background-image"===r&&"background-color"===n||0===n.indexOf("-webkit-text")?1:-1}));f.indexOf(o)>-1&&!v&&this._try((function(){var t=function(e){var t=null;return Array.prototype.some.call(e.classList,(function(e){return!!z[e]&&(t=z[e],!0)})),t}(e);t||(t=e.getAttribute("bgcolor")),t&&(w.unshift(["background-color",J()(t).toString()]),v=!0)})),"FONT"!==o||m||this._try((function(){var t=e.getAttribute("color");t&&(w.push(["color",J()(t).toString()]),m=!0)}));var x="",M="",_=0;if(w.some((function(e,r){var n=R(e,2),a=n[0],o=n[1];return t._try((function(){if(0!==a.indexOf("-webkit-text"))return _=r,!0;switch(a){case"-webkit-text-fill-color":x=ae(o);break;case"-webkit-text-stroke":var e=o.split(" ");2===e.length&&(M=ae(e[1]));break;case"-webkit-text-stroke-color":M=ae(o)}return!1}))})),x&&(m?w[w.length-1]=["-webkit-text-fill-color",x]:(w.push(["-webkit-text-fill-color",x]),m=!0)),_&&(w.splice(0,_),M&&w.unshift(["-webkit-text-stroke-color",M])),w.forEach((function(r){var n=R(r,2),a=n[0],o=n[1];return t._try((function(){var r,n=o,f=!1,w=/^background/.test(a),x="text-shadow"===a,M=["-webkit-text-stroke-color","color","-webkit-text-fill-color"].indexOf(a),_=/^border/.test(a),C=/gradient/.test(o),j=[],P="";if(o=re(o,C),Z.test(o)){if(C){for(var S=ee.exec(o);S;)j.push(S[0]),S=ee.exec(o);r=ne(j)}var A=0;o=o.replace(ee,(function(n){C&&(n=r,f=!0);var a=t._adjustBrightness(J()(n),e,{isBgColor:w,isTextShadow:x,isTextColor:M>-1,isBorderColor:_,hasInlineColor:m}),o=!k&&a.newColor;if(P+=a.extStyle,w||M>0){var h=w?l:i,d=w?u:s,b=o?o.toString():n;0===A&&I(e).forEach((function(e){var t=e.getAttribute(d)||g.defaultLightBgColor;e.setAttribute(h,b),e.setAttribute(d,t.split("|").concat(n).join("|")),w&&J()(b).alpha()>=.05&&e.getAttribute(c)&&e.removeAttribute(c)}))}return o&&(f=!0),A+=1,o||n})).replace(/\s?!\s?important/gi,"")}if(P&&(y+=P),!(e instanceof SVGElement)){var O=/^background/.test(a),B=/^(-webkit-)?border-image/.test(a);if((O||B)&&/url\([^)]*\)/i.test(o)){f=!0;var E=ne((e.getAttribute(u)||g.defaultLightBgColor).split("|"));if(o=o.replace(/^(.*?)url\(([^)]*)\)(.*)$/i,(function(t){var r=t,n="",o="",i="";return"1"!==e.getAttribute(c)&&I(e).forEach((function(e){return e.setAttribute(c,"1")})),O?(r="linear-gradient(".concat("rgba(0,0,0,0.2)",", ").concat("rgba(0,0,0,0.2)","),").concat(t),i=he.genCssKV(a,"".concat(r,",linear-gradient(").concat(E,", ").concat(E,")")),h&&(n="top left,".concat(h),y+=he.genCssKV("background-position","".concat(n)),i+=he.genCssKV("background-position","".concat(n,",top left"))),b&&(o="100%,".concat(b),y+=he.genCssKV("background-size","".concat(o)),i+=he.genCssKV("background-size","".concat(o,",100%"))),ce.push(e,i)):!v&&ce.push(e,he.genCssKV("background-image","linear-gradient(".concat("rgba(0,0,0,0.2)",", ").concat("rgba(0,0,0,0.2)","),linear-gradient(").concat(E,", ").concat(E,")"))),r})),!m){var T=ne((e.getAttribute(s)||g.defaultLightTextColor).split("|"));y+=he.genCssKV("color",T),I(e).forEach((function(e){return e.setAttribute(i,T)}))}}}f&&(d.test(n)&&(p[a]=te(n)),C?ce.push(e,he.genCssKV(a,o)):y+=he.genCssKV(a,o))}))})),y){e.setAttribute("data-style",p.cssText);var C="".concat("js_darkmode__").concat(this._idx++);e.classList.add(C),a+=y?he.genCss(C,y):""}r=e,n="",Array.prototype.forEach.call(r.childNodes,(function(e){3===e.nodeType&&(n+=e.nodeValue.replace(/\s/g,""))})),n.length>0&&(g.delayBgJudge?ue.push(e):ce.contains(e,(function(e){a+=he.genCss(e.className,e.cssKV)})))}return se.emit("afterConvertNode",e),a}}])&&W(t.prototype,r),n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),se=new x,ue=new j("".concat("js_darkmode__","text__")),ce=new A("".concat("js_darkmode__","bg__")),he=new N,fe=new V,de=new le,ge=new RegExp("".concat("js_darkmode__","[^ ]+"),"g"),be=null,pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"dom"};if(t.force&&(he.isFinish=!1),!he.isFinish)try{de.isDarkmode=g.mode?"dark"===g.mode:e.matches,"dom"===t.type?(de.isDarkmode&&"function"==typeof g.begin&&g.begin(fe.hasDelay()),Array.prototype.forEach.call(fe.get(),(function(e){if(de.isDarkmode&&e.className&&"string"==typeof e.className&&(e.className=e.className.replace(ge,"")),de.isDarkmode||se.length)if(g.needJudgeFirstPage){var t=e.getBoundingClientRect(),r=t.top,n=t.bottom;r<=0&&n<=0?he.addCss(de.convert(e),!1):r>0&&r<h||n>0&&n<h?(fe.addFirstPageNode(e),he.addCss(de.convert(e),!0)):(g.needJudgeFirstPage=!1,he.writeStyle(!0),fe.showFirstPageNodes(),"function"==typeof g.showFirstPage&&g.showFirstPage(),he.addCss(de.convert(e),!1))}else he.addCss(de.convert(e),!1)})),se.loopTimes++):"bg"===t.type&&de.isDarkmode&&ue.forEach((function(e){return ce.contains(e,(function(e){he.addCss(he.genCss(e.className,e.cssKV),!1)}))})),(g.needJudgeFirstPage||!g.needJudgeFirstPage&&!fe.showFirstPage)&&"function"==typeof g.showFirstPage&&g.showFirstPage(),he.writeStyle(),fe.emptyFirstPageNodes(),de.isDarkmode||(g.needJudgeFirstPage=!1,g.delayBgJudge=!1,null===g.container&&"dom"===t.type&&fe.length&&fe.delay())}catch(e){console.log("An error occurred when running the dark mode conversion algorithm\n",e),"function"==typeof g.error&&g.error(e)}};function ye(e,t){me(t),fe.set(e),pe(be,{force:!0,type:"dom"})}function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!g.hasInit){g.hasInit=!0;var t=g.whitelist.tagName;e.whitelist&&e.whitelist.tagName instanceof Array&&e.whitelist.tagName.forEach((function(e){e=e.toUpperCase(),-1===t.indexOf(e)&&t.push(e)})),["dark","light"].indexOf(e.mode)>-1&&(g.set("string",e,"mode"),document.getElementsByTagName("html")[0].classList.add(a)),g.set("function",e,"begin"),g.set("function",e,"showFirstPage"),g.set("function",e,"error"),g.set("boolean",e,"needJudgeFirstPage"),g.set("boolean",e,"delayBgJudge"),g.set("dom",e,"container"),g.set("string",e,"cssSelectorsPrefix"),g.set("string",e,"defaultLightTextColor"),g.set("string",e,"defaultLightBgColor"),g.set("string",e,"defaultDarkTextColor"),g.set("string",e,"defaultDarkBgColor"),!g.mode&&null===be&&window.matchMedia&&(be=window.matchMedia(n)).addListener(pe)}}function ve(e){fe.set(e),null!==g.container&&(ce.update(e),ue.update(e)),pe(be,{force:!0,type:"bg"})}function ke(e){e.forEach((function(e){return se.extend(e)}))}}])}));</script><script type="text/javascript" nonce="1738606354" reportloaderror>var __INLINE_SCRIPT__=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=i(t);if(e){var u=i(this).constructor;n=Reflect.construct(r,arguments,u)}else n=r.apply(this,arguments);return o(this,n)}}var a=function(r){var o=0;r&&r.front_end_additional_fields&&r.front_end_additional_fields.is_auto_type_setting&&(o=r.front_end_additional_fields.is_auto_type_setting);return function(r){var i=!1,a=document.querySelectorAll("#js_content")[0],c={appmsgid:window.appmsgid,pointerEvents:!1,heightAnimate:!1},f=function(t,e){return 1===t.length&&t[0].tagName&&t[0].tagName.toLowerCase()===e};return function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}(y,r);var s,l,p,d=u(y);function y(){return t(this,y),d.apply(this,arguments)}return s=y,(l=[{key:"afterConvertNode",value:function(t){if(!this.loopTimes){if(!i){var e=navigator.userAgent;/(iPhone|iPad|iPod|iOS|mac\sos)/i.test(e)&&a.classList.add("fix_apple_default_style"),i=!0}if("animate"===t.tagName&&"height"===t.getAttribute("attributeName")){var n=t.getAttribute("repeatCount");("indefinite"===n||n>"10")&&"click"!==t.getAttribute("begin")&&"click"!==t.getAttribute("end")&&(t.setAttribute("repeatCount","undefined"),t.setAttribute("attributeName","undefined"),(new Image).src="https://mp.weixin.qq.com/mp/jsmonitor?idkey=306525_1_1")}if(1===o)try{var r=t.parentNode.id;if(("js_content"===r||"js_secopen_content"===r)&&"p"===t.tagName.toLowerCase()){var u=t.childNodes;""===t.textContent&&(f(u,"br")||1===u.length&&f(u[0].childNodes,"br"))&&(t.previousElementSibling.style.marginBottom="0em",t.style.marginBottom="0em")}}catch(t){if("undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs){var s=JSON.stringify(c);WX_BJ_REPORT.BadJs.report("domFilter",s,{mid:"mmbizwap:domMonitor",view:"wap_appmsg"})}}}}}])&&e(s.prototype,l),p&&e(s,p),Object.defineProperty(s,"prototype",{writable:!1}),y}(r)}};return window.__second_open__||(window.DomFilter=a()),a}();</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
(function () {
  if (!window.__second_open__ && window.Darkmode) { // 非秒开，秒开的逻辑写在skeleton.js里
    var cost = 0; // 记录Darkmode首屏渲染耗时
    window.Darkmode.extend([window.DomFilter]); // 插件注册
    window.Darkmode.run(document.querySelectorAll('#js_content *'), {
      mode: '', // ''|'dark'|'light', 空表示跟随系统
      defaultDarkBgColor: '',
      error: function () {
        (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_0_1'; // 上报conver出错 H5
      },
      begin: function (isSwitch) {
        (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_2_1'; // 上报Darkmode H5 PV
        isSwitch && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_4_1'); // 上报Darkmode H5 PV（仅含从LM切换到DM的情况）

        cost = new Date() * 1; // 记录开始渲染的时间
      },
      showFirstPage: function () {
        cost = new Date() * 1 - cost; // 记录首屏渲染耗时
        var isTop = (document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop) === 0;
        // 上报Darkmode耗时大盘数据
        if (cost <= 10) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_6_1'; // 上报Darkmode H5 首屏渲染时间在10ms以内（含10ms）PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_13_1'); // 上报Darkmode H5 首屏渲染时间在10ms以内（含10ms）PV - 无滚动
        } else if (cost > 10 && cost <= 20) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_7_1'; // 上报Darkmode H5 首屏渲染时间在(10ms, 20ms]之间PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_14_1'); // 上报Darkmode H5 首屏渲染时间在(10ms, 20ms]之间PV - 无滚动
        } else if (cost > 20 && cost <= 30) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_8_1'; // 上报Darkmode H5 首屏渲染时间在(20ms, 30ms]之间PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_15_1'); // 上报Darkmode H5 首屏渲染时间在(20ms, 30ms]之间PV - 无滚动
        } else if (cost > 30 && cost <= 40) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_9_1'; // 上报Darkmode H5 首屏渲染时间在(30ms, 40ms]之间PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_16_1'); // 上报Darkmode H5 首屏渲染时间在(30ms, 40ms]之间PV - 无滚动
        } else if (cost > 40 && cost <= 50) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_10_1'; // 上报Darkmode H5 首屏渲染时间在(40ms, 50ms]之间PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_17_1'); // 上报Darkmode H5 首屏渲染时间在(40ms, 50ms]之间PV - 无滚动
        } else if (cost > 50 && cost <= 60) {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_11_1'; // 上报Darkmode H5 首屏渲染时间在(50ms, 60ms]之间PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_18_1'); // 上报Darkmode H5 首屏渲染时间在(50ms, 60ms]之间PV - 无滚动
        } else {
          (new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_12_1'; // 上报Darkmode H5 首屏渲染时间在60ms以上（不含60ms）PV
          isTop && ((new Image()).src = 'https://mp.weixin.qq.com/mp/jsmonitor?idkey=125617_19_1'); // 上报Darkmode H5 首屏渲染时间在60ms以上（不含60ms）PV - 无滚动
        }
      }
    });
    document.getElementById('js_content').style.visibility = 'visible';
  }
})();
</script>

<script type="text/javascript" nonce="1738606354" reportloaderror>
(function(_g){
    _g.appmsg_like_type = "2" * 1 ? "2" * 1 : 1;
    // _g.appmsg_like_type = 2;
    _g.clientversion = "";
    _g.passparam = ""; // 看一看带参数
    if(!_g.msg_link) {
      _g.msg_link = "http://mp.weixin.qq.com/s?__biz=MjM5Mzg0NDkyMA==&amp;mid=2652258570&amp;idx=3&amp;sn=983433c51ef56b5df1cfbc3d4834c3cf&amp;chksm=bd723add8a05b3cb995df9e77b39a61084eceec7f782eb273c6437427987111e3a004341db1e#rd";
    }
    _g.appmsg_type = "9"; // 后台图文消息类型
    _g.devicetype = ""; // devicetype
})(window);
// 已翻译
</script>

<script type="text/javascript" nonce="1738606354" reportloaderror>
// 企业微信里置灰公众号名称
(function() {
  var ua = window.navigator.userAgent;
  if (/MicroMessenger\/([\d\.]+)/i.test(ua) && /wxwork/i.test(ua)) {
    var profileName = document.getElementById('js_name');
    var authorName = document.getElementById('js_author_name');
    var accountNames = document.getElementsByClassName('account_nickname_inner');
    if (profileName) {
      profileName.classList.add('tips_global_primary');
    }
    if (authorName) {
      authorName.classList.add('tips_global_primary');
    }
    if (accountNames && accountNames.length) {
      accountNames[0].classList.add('tips_global_primary');
    }
  }
})();
</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
// 安卓插入米大师 h5 sdk
(function() {
  var ua = navigator.userAgent;
  if (ua.indexOf("MicroMessenger") != -1 && ua.indexOf("Android") != -1){
    var script = document.createElement('script');
    var head = document.getElementsByTagName('head')[0];
    script.type = 'text/javascript';
    script.src = "https://midas.gtimg.cn/h5sdk/js/api/h5sdk.js";
    head.appendChild(script);
  }
})();
</script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
var real_show_page_time = +new Date();
if (!!window.addEventListener){
  window.addEventListener("load", function(){
    window.onload_endtime = +new Date();
  });
}
</script>

<script nomodule nonce="1738606354" reportloaderror>new Image().src='https://mp.weixin.qq.com/mp/jsmonitor?idkey=66881_111_1&t='+Math.random();</script>

    

<script nomodule nonce="1738606354" reportloaderror>!function(){var e=document,t=e.createElement("script");if(!("noModule"in t)&&"onbeforeload"in t){var n=!1;e.addEventListener("beforeload",(function(e){if(e.target===t)n=!0;else if(!e.target.hasAttribute("nomodule")||!n)return;e.preventDefault()}),!0),t.type="module",t.src=".",e.head.appendChild(t),t.remove()}}();</script>
<script nomodule id="vite-legacy-polyfill" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/polyfills-legacy.7315625c.js" nonce="1738606354" reportloaderror></script>
<script nomodule id="vite-legacy-entry" src="https://images.weserv.nl/?url=//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/../mmbizappmsg/assets/appmsg-legacy.4603c143.js" nonce="1738606354" reportloaderror>System.import(document.getElementById('vite-legacy-entry').getAttribute('data-src'))</script>

    <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/mod/weui_a11y5e2ea0.css" reportloaderror>
<script type="text/javascript" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/lib/wa-helper.min5e2ea0.js" nonce="1738606354" reportloaderror></script>
<script type="text/javascript" nonce="1738606354" reportloaderror>
  // WAH.default.init()
</script>



<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_colon">：</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_comma">，</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_period">。</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_space">&nbsp;</span>


<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_type_video">视频</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_type_weapp">小程序</span>


<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_zan_btn_txt">赞</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_zan_btn_tips">，轻点两下取消赞</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_like_btn_txt">在看</span>
<span aria-hidden="true" class="weui-a11y_ref" style="display:none" id="js_a11y_like_btn_tips">，轻点两下取消在看</span>

  </body>
</html>


